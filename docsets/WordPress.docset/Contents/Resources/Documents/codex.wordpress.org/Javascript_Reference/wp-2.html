<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">


<!-- Mirrored from codex.wordpress.org/Javascript_Reference/wp.media by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 31 Aug 2021 17:23:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'../../www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P24PF4B');</script>
<!--
<meta property="fb:page_id" content="6427302910" />
-->
<link rel="dns-prefetch" href="http://s.w.org/" />
<link rel="dns-prefetch" href="../../fonts.googleapis.com/index.html" />
<link rel="dns-prefetch" href="http://fonts.gstatic.com/" />
<link rel="dns-prefetch" href="http://www.googletagmanager.com/" />
<meta name="google-site-verification" content="7VWES_-rcHBcmaQis9mSYamPfNwE03f4vyTj4pfuAw0" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Javascript Reference/wp.media</title>
<link rel="canonical" href="wp-2.html" />

<link rel="stylesheet" href="../../s.w.org/style/codex-wp4.css?3" />
<meta name="referrer" content="always">

			<link href="../../s.w.org/wp-includes/css/dashicons.min.css?20181204" rel="stylesheet" type="text/css" />
		<link href='../../fonts.googleapis.com/css.css?family=Open+Sans:300italic,400italic,600italic,400,300,600&amp;subset=latin,cyrillic-ext,greek-ext,greek,vietnamese,latin-ext,cyrillic' rel='stylesheet' type='text/css'>

		<link rel="stylesheet" href="../../s.w.org/style/wp4.css?95" />

<link rel="shortcut icon" href="../../s.w.org/favicon.ico?2" type="image/x-icon" />
<script type="text/javascript" src="../../s.w.org/wp-includes/js/jquery/jquery.js?v=1.11.1"></script>
<script>document.cookie='devicePixelRatio='+((window.devicePixelRatio === undefined) ? 1 : window.devicePixelRatio)+'; path=/';</script>
<!--[if IE]>
    <script type="text/javascript" src="/skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" />
<![endif]-->

<script type="text/javascript">wgBreakFrames=false;wgContentLanguage='en';</script>


</head>


<body id="wordpress-org" class="wporg-responsive wporg-codex">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P24PF4B" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div id="wporg-header">
	<div class="wrapper">
	<h1><a href="http://wordpress.org/">WordPress.org</a></h1>				<div id="head-search">
		<form action="http://wordpress.org/search/do-search.php" method="get">
			<label for="global-search" class="screen-reader-text">Search WordPress.org for:</label>
			<input id="global-search" class="text" name="search" type="text" value="" maxlength="150" placeholder="Search WordPress.org" />
			<button type="submit" class="button"><span class="screen-reader-text">Submit</span></button>
		</form>
		</div>
				<div style="clear:both"></div>
		<button id="mobile-menu-button" aria-expanded="false"><span class="screen-reader-text">Toggle Menu</span></button>
		
<nav aria-label="Main Menu">
<ul id="wporg-header-menu">
<li class="menu-item"><a href='http://wordpress.org/showcase/' data-title='See some of the sites built on WordPress.'>Showcase</a></li>
<li class="menu-item"><a href='http://learn.wordpress.org/' data-title='Resources to help you learn more about WordPress and teach it to others.'>Learn</a></li>
<li class="menu-item"><a href='http://wordpress.org/themes/' data-title='Find just the right look for your website.'>Themes</a></li>
<li class="menu-item"><a href='http://wordpress.org/plugins/' data-title='Plugins can extend WordPress to do almost anything you can imagine.'>Plugins</a></li>
<li class="menu-item"><a href='http://wordpress.org/mobile/' data-title='Take your website on the go!'>Mobile</a></li>
<li class="menu-item"><a href='http://wordpress.org/support/' data-title='Forums, documentation, help.' aria-current="true" class="current">Support</a><ul class="nav-submenu"><li><a href='http://wordpress.org/support/' title='Documentation, tutorials, best practices.'>Documentation</a></li><li><a href='http://wordpress.org/support/forums/' title='Support and discussion forums.'>Forums</a></li></ul><div class="uparrow"></div></li>
<li class="menu-item"><a href='http://make.wordpress.org/' data-title='Contribute your knowledge.'>Get Involved</a><ul class="nav-submenu"><li><a href='http://wordpress.org/five-for-the-future/' title='How five percent is powering the next generation of the web'>Five for the Future</a></li></ul><div class="uparrow"></div></li>
<li class="menu-item"><a href='http://wordpress.org/about/' data-title='About the WordPress Organization, and where we&#039;re going.'>About</a></li>
<li class="menu-item"><a href='http://wordpress.org/news/' data-title='Come here for the latest scoop.'>Blog</a></li>
<li class="menu-item"><a href='http://wordpress.org/hosting/' data-title='Find a home for your blog.'>Hosting</a></li>
<li id="download" class="button download-button menu-item"><a href='http://wordpress.org/download/' data-title='Get it. Got it? Good.'>Get WordPress</a></li>
</ul>
</nav>
		<div style="clear:both"></div>
	</div>
</div>



<div id="headline">
	<div class="wrapper">
		<h2><a href="../index.html">Codex</a></h2>
		
		<div class="portlet" id="p-personal">
		  <p class="login">Codex tools:
		     <a href="https://codex.wordpress.org/index.php?title=Special:UserLogin&amp;returnto=Javascript+Reference%2Fwp.media">Log in</a> 		  </p>
		</div>
	</div>
</div>

<div id="pagebody">
	<div class="wrapper">	
		<div class="col-10" id="bodyContent">
			<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"><div style="clear:both; background-color:#e5f5fa; border-left:4px solid #00a0d2; padding:10px 12px 8px; margin:0.5em auto 1.5em auto;"><span class="dashicons dashicons-info" style="color:#00a0d2"></span> Interested in functions, hooks, classes, or methods? Check out the new <a rel="nofollow" class="external text" href="../../developer.wordpress.org/reference/index.html">WordPress Code Reference</a>!</div>
</div></div>			<h2 class="pagetitle">Javascript Reference/wp.media</h2>
									<!-- start content -->
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p class="LanguageLinks" style="border:1px solid #CCCCCC; line-height:1.5; text-align:left; color:#333333; font-size:90%; padding:10px;"><span style="white-space:nowrap;"><a href="../Multilingual_Codex.html" title="Multilingual Codex" class="mw-redirect">Languages</a>:</span> 
<strong class="selflink">English</strong> • 
<a href="https://codex.wordpress.org/index.php?title=ru:%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5_Javascript/wp.media&amp;action=edit&amp;redlink=1" class="new" title="ru:Описание Javascript/wp.media (page does not exist)">Русский</a> • 

 <small>(<a href="../Multilingual_Codex.html#Language_Cross_Reference" title="Multilingual Codex" class="mw-redirect">Add your language</a>)</small>
</p>
<div style="background-color:#FAEBD7; border:1px solid #CCCCCC; color:#000000; padding:7px; margin:0.5em auto 0.5em auto; vertical-align:middle; overflow:hidden;">This page is <a href="../Category_Stubs.html" title="Category:Stubs">marked</a> as incomplete. You can <a href="https://codex.wordpress.org/Codex:Contributing" title="Codex:Contributing">help</a> Codex by <b><a rel="nofollow" class="external text" href="https://codex.wordpress.org/index.php?title=Javascript_Reference/wp.media&amp;action=edit">expanding it</a></b>.</div>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Example"><span class="tocnumber">2</span> <span class="toctext">Example</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Enqueue_Required_Media_Script"><span class="tocnumber">3</span> <span class="toctext">Enqueue Required Media Script</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Further_Notes_on_Media_Script_Enqueue"><span class="tocnumber">3.1</span> <span class="toctext">Further Notes on Media Script Enqueue</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Location"><span class="tocnumber">4</span> <span class="toctext">Location</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#External_Resources"><span class="tocnumber">5</span> <span class="toctext">External Resources</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related"><span class="tocnumber">6</span> <span class="toctext">Related</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Description">Description</span></h2>
<p><code>wp.media</code> is used to handle and control the admin media modal. For instance, custom image selector/uploader controls and meta boxes.  It is located in the <a href="wp.html" title="Javascript Reference/wp">wp</a> scope/namespace.
</p>
<h2><span class="mw-headline" id="Example">Example</span></h2>
<p>One key use of this class is to create a custom image upload/select link. Let's assume you are creating a custom admin <a href="../../developer.wordpress.org/reference/functions/add_meta_box/index.html" title="Function Reference/add meta box">meta box</a> with an image upload link, similar to the <a href="../Post_Thumbnails.html#Setting_a_Post_Thumbnail" title="Post Thumbnails">Set Featured Image</a> link for WordPress posts.
</p>
<h2><span class="mw-headline" id="Enqueue_Required_Media_Script">Enqueue Required Media Script</span></h2>
<p>To be able to use the JavaScript-API, you first have to init all the needed JavaScript-Libraries and Styles using the wp_enqueue_media() function:
</p>
<code data-lang="php"><pre>
wp_enqueue_media();
</pre></code>
<p>The wp_enqueue_media(); must be made during the action hook admin_enqueue_scripts or later. In the following example an anonymous function is used as the callback to admin_enqueue_scripts. 
</p><p>Note that 1 argument $hook_suffix is passed to the callback for admin_enqueue_scripts and this can be used to conditionally load the scripts based on which admin page is being viewed. Developers may also consider checking other conditions before loading the scripts so that the scripts are only loaded where needed. 
</p>
<code data-lang="php"><pre>
add_action( 'admin_enqueue_scripts', function( $hook_suffix ) {

  wp_enqueue_media();

}
</pre></code>
<p>This example achieves the same goal with a named function callback. 
</p>
<code data-lang="php"><pre>

add_action( 'admin_enqueue_scripts', 'add_media_script' );

function add_media_script( $hook_suffix ) {

  wp_enqueue_media();

}
</pre></code>
<p>The code below achieves the same goal as above and is designed for use in a PHP class:
</p>
<code data-lang="php"><pre>
class [PREFIX]_MediaHandler {

  function __construct() {
    
    // Pass a PHP callable method from the same class as the callback.
    add_action( 'admin_enqueue_scripts', array( $this, 'add_media_script' ) );

  }

  function add_media_script( $hook_suffix ) {

    wp_enqueue_media();

  }

}
</pre></code>
<h3><span class="mw-headline" id="Further_Notes_on_Media_Script_Enqueue">Further Notes on Media Script Enqueue</span></h3>
<p>The wp_enqueue_media() function does a lot more than just enqueue required media files. It also does loading of data required for the media window to work. Therefore it is not (likely) possible to make the media scripts a dependency of an existing script the way we often would with other optional scripts like jQuery UI scripts. If the required data doesn't load, the WP Media scripts will fail. 
</p><p>Your meta box <b>PHP</b> might look like this...
</p>
<code data-lang="php"><pre>
&lt;?php
global $post;

// Get WordPress' media upload URL
$upload_link = esc_url( get_upload_iframe_src( 'image', $post-&gt;ID ) );

// See if there's a media id already saved as post meta
$your_img_id = get_post_meta( $post-&gt;ID, '_your_img_id', true );

// Get the image src
$your_img_src = wp_get_attachment_image_src( $your_img_id, 'full' );

// For convenience, see if the array is valid
$you_have_img = is_array( $your_img_src );
?&gt;

&lt;!-- Your image container, which can be manipulated with js --&gt;
&lt;div class="custom-img-container"&gt;
    &lt;?php if ( $you_have_img )&#160;:&#160;?&gt;
        &lt;img src="&lt;?php echo $your_img_src[0]&#160;?&gt;" alt="" style="max-width:100%;" /&gt;
    &lt;?php endif;&#160;?&gt;
&lt;/div&gt;

&lt;!-- Your add &amp; remove image links --&gt;
&lt;p class="hide-if-no-js"&gt;
    &lt;a class="upload-custom-img &lt;?php if ( $you_have_img  ) { echo 'hidden'; }&#160;?&gt;" 
       href="&lt;?php echo $upload_link&#160;?&gt;"&gt;
        &lt;?php _e('Set custom image')&#160;?&gt;
    &lt;/a&gt;
    &lt;a class="delete-custom-img &lt;?php if (&#160;! $you_have_img  ) { echo 'hidden'; }&#160;?&gt;" 
      href="#"&gt;
        &lt;?php _e('Remove this image')&#160;?&gt;
    &lt;/a&gt;
&lt;/p&gt;

&lt;!-- A hidden input to set and post the chosen image id --&gt;
&lt;input class="custom-img-id" name="custom-img-id" type="hidden" value="&lt;?php echo esc_attr( $your_img_id );&#160;?&gt;" /&gt;
</pre></code>
<p>To properly control the above HTML, you would use the following <b>Javascript</b>...
</p>
<code data-lang="javascript"><pre>
jQuery(function($){

  // Set all variables to be used in scope
  var frame,
      metaBox = $('#meta-box-id.postbox'), // Your meta box id here
      addImgLink = metaBox.find('.upload-custom-img'),
      delImgLink = metaBox.find( '.delete-custom-img'),
      imgContainer = metaBox.find( '.custom-img-container'),
      imgIdInput = metaBox.find( '.custom-img-id' );
  
  // ADD IMAGE LINK
  addImgLink.on( 'click', function( event ){
    
    event.preventDefault();
    
    // If the media frame already exists, reopen it.
    if ( frame ) {
      frame.open();
      return;
    }
    
    // Create a new media frame
    frame = wp.media({
      title: 'Select or Upload Media Of Your Chosen Persuasion',
      button: {
        text: 'Use this media'
      },
      multiple: false  // Set to true to allow multiple files to be selected
    });

    
    // When an image is selected in the media frame...
    frame.on( 'select', function() {
      
      // Get media attachment details from the frame state
      var attachment = frame.state().get('selection').first().toJSON();

      // Send the attachment URL to our custom image input field.
      imgContainer.append( '&lt;img src="'+attachment.url+'" alt="" style="max-width:100%;"/&gt;' );

      // Send the attachment id to our hidden input
      imgIdInput.val( attachment.id );

      // Hide the add image link
      addImgLink.addClass( 'hidden' );

      // Unhide the remove image link
      delImgLink.removeClass( 'hidden' );
    });

    // Finally, open the modal on click
    frame.open();
  });
  
  
  // DELETE IMAGE LINK
  delImgLink.on( 'click', function( event ){

    event.preventDefault();

    // Clear out the preview image
    imgContainer.html( '' );

    // Un-hide the add image link
    addImgLink.removeClass( 'hidden' );

    // Hide the delete image link
    delImgLink.addClass( 'hidden' );

    // Delete the image id from the hidden input
    imgIdInput.val( '' );

  });

});
</pre></code>
<p>For more information on adding custom meta boxes to WordPress, see <a href="../../developer.wordpress.org/reference/functions/add_meta_box/index.html" title="Function Reference/add meta box">add_meta_box()</a> or the <a rel="nofollow" class="external text" href="https://github.com/Veraxus/nv-example-meta-box">Example Meta Box Plugin on Github</a>
</p>
<h2><span class="mw-headline" id="Location">Location</span></h2>
<p>The source is defined in <code><a rel="nofollow" class="external text" href="https://core.trac.wordpress.org/browser/tags/5.7.2/src/js/_enqueues/wp/media/models.js#L0">js/_enqueues/wp/media/models.js</a></code> and output in `wp-includes/js/media-models.js` during build.
</p>
<h2><span class="mw-headline" id="External_Resources">External Resources</span></h2>
<ul><li> <a rel="nofollow" class="external text" href="https://github.com/ericandrewlewis/wp-media-javascript-guide">WP Media JavaScript Guide</a> - a plugin to show how to use components in wp.media</li>
<li> <a rel="nofollow" class="external text" href="https://github.com/Veraxus/nv-example-meta-box">Example Meta Box Plugin</a> - A simple plugin that shows how to create a custom admin meta box.</li></ul>
<h2><span class="mw-headline" id="Related">Related</span></h2>
<ul><li> <a href="../Javascript_Reference.html" title="Javascript Reference">Javascript Reference</a> - WordPress Javascript API reference</li>
<li> <a href="../Administration_Menus.html" title="Administration Menus">Administration Menus</a> - Information on creating and customizing administration menus &amp; pages</li></ul>

<!-- 
NewPP limit report
Cached time: 20210629171739
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.016 seconds
Real time usage: 0.020 seconds
Preprocessor visited node count: 141/1000000
Preprocessor generated node count: 467/1000000
Post‐expand include size: 1549/2097152 bytes
Template argument size: 471/2097152 bytes
Highest expansion depth: 5/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    9.302      1 - -total
 37.49%    3.487      1 - Template:Languages
 33.28%    3.096      1 - Template:Trac
 23.41%    2.178      1 - Template:Stub
 14.46%    1.345      1 - Template:CurrentVersion
 13.93%    1.296      1 - Template:Message
 13.88%    1.291      1 - Template:en
 10.44%    0.971      1 - Template:ru
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://codex.wordpress.org/index.php?title=Javascript_Reference/wp.media&amp;oldid=170918">https://codex.wordpress.org/index.php?title=Javascript_Reference/wp.media&amp;oldid=170918</a>"</div>
				<div id="catlinks"><div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://codex.wordpress.org/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="../Category_Stubs.html" title="Category:Stubs">Stubs</a></li></ul></div></div></div>			<!-- end content -->
		</div>
		<div class="col-2">
			
						
			<ul class="submenu">
				<li id="n-mainpage"><a href="../Main_Page.html">Home Page</a></li>	
				<li><a href="../WordPress_Lessons.html">WordPress Lessons</a></li>
				<li><a href="../Getting_Started_with_WordPress.html">Getting Started</a></li>
				<li><a href="../Working_with_WordPress.html">Working with WordPress</a></li>
				<li><a href="../Blog_Design_and_Layout.html">Design and Layout</a></li>
				<li><a href="../Advanced_Topics.html">Advanced Topics</a></li>
				<li><a href="../Troubleshooting.html">Troubleshooting</a></li>
				<li><a href="../Developer_Documentation.html">Developer Docs</a></li>
				<li><a href="../About_WordPress.html">About WordPress</a></li>
			</ul>

			<h3>Codex Resources</h3>
			<ul class="submenu">
				<li id="n-portal"><a href="https://codex.wordpress.org/Codex:Community_Portal">Community portal</a></li>	      
				<li id="n-currentevents"><a href="../Current_events.html">Current events</a></li>	      
				<li id="n-recentchanges"><a href="https://codex.wordpress.org/Special:RecentChanges">Recent changes</a></li>	      
				<li id="n-randompage"><a href="https://codex.wordpress.org/Special:Random">Random page</a></li>	      
				<li id="n-help"><a href="https://codex.wordpress.org/Help:Contents">Help</a></li>	
			</ul>
			
		</div>
	</div>
</div>


<div id="wporg-footer">
	<div class="wrapper">
		<ul>
			<li><a href="http://wordpress.org/about/" title="An introduction to the WordPress project">About</a></li>
			<li><a href="http://wordpress.org/news/" title="News and Updates">Blog</a></li>
			<li><a href="http://wordpress.org/hosting/" title="Recommended web hosting providers">Hosting</a></li>
			<li><a href="https://wordpressfoundation.org/donate/" title="Donate to the WordPress Foundation">Donate</a></li>
		</ul>

		<ul>
			<li><a href="http://wordpress.org/support/" title="Forums, documentation, and other resources">Support</a></li>
			<li><a href="../../developer.wordpress.org/index.html" title="Resources for WordPress developers">Developers</a></li>
			<li><a href="http://make.wordpress.org/" title="Give back to WordPress through code, support, translation and more">Get Involved</a></li>
			<li><a href="http://learn.wordpress.org/" title="Workshops and training materials">Learn</a></li>
		</ul>

		<ul>
			<li><a href="http://wordpress.org/showcase/" title="Some of the best WordPress sites on the Web">Showcase</a></li>
			<li><a href="http://wordpress.org/plugins/" title="Add extra functionality to WordPress">Plugins</a></li>
			<li><a href="http://wordpress.org/themes/" title="Make your WordPress pretty">Themes</a></li>
		</ul>

		<ul>
			<li><a href="http://central.wordcamp.org/" title="Find a WordPress event near you">WordCamp</a></li>
			<li><a href="http://wordpress.tv/" title="Videos, tutorials, and WordCamp sessions">WordPress.TV</a></li>
			<li><a href="http://buddypress.org/" title="A set of plugins to transform your WordPress into a social network">BuddyPress</a></li>
			<li><a href="http://bbpress.org/" title="Fast, slick forums built on WordPress">bbPress</a></li>
		</ul>

		<ul>
			<li><a href="http://wordpress.com/?ref=wporg-footer" title="Hassle-free WordPress hosting">WordPress.com</a></li>
			<li><a href="http://ma.tt/" title="Co-founder of WordPress, an example of what WordPress can do">Matt</a></li>
			<li><a href="http://wordpress.org/about/privacy/" title="WordPress.org Privacy Policy">Privacy</a></li>
			<li><a href="https://publiccode.eu/" target="_blank">Public Code</a></li>
		</ul>

		<ul class="social-media-links">
			<li><span class="dashicons dashicons-twitter"></span><a href="https://twitter.com/WordPress" title="Follow @WordPress on Twitter">@WordPress</a></li>
			<li><span class="dashicons dashicons-facebook"></span><a href="https://www.facebook.com/WordPress/" title="Like WordPress on Facebook">WordPress</a></li>
		</ul>
	</div>

		<p class="cip cip-image">Code is Poetry.</p>
</div>

<script src="../../s.w.org/style/js/navigation.min.js?20190128"></script>

</body>
<!-- Cached 20210629171739 -->

<!-- Mirrored from codex.wordpress.org/Javascript_Reference/wp.media by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 31 Aug 2021 17:23:05 GMT -->
</html>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">

<!-- Mirrored from developer.wordpress.org/rest-api/extending-the-rest-api/adding-custom-endpoints/ by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 31 Aug 2021 16:55:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<!--
<meta property="fb:page_id" content="6427302910" />
-->
<meta name="google-site-verification" content="7VWES_-rcHBcmaQis9mSYamPfNwE03f4vyTj4pfuAw0" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Adding Custom Endpoints</title>
<meta name="referrer" content="always">

		<link href='../../../../fonts.googleapis.com/css.css?family=Open+Sans:300italic,400italic,600italic,400,300,600&amp;subset=latin,cyrillic-ext,greek-ext,greek,vietnamese,latin-ext,cyrillic' rel='stylesheet' type='text/css'>

		<link rel="stylesheet" href="../../../../s.w.org/style/wp4.css?95" />

<link rel="shortcut icon" href="../../../../s.w.org/favicon.ico?2" type="image/x-icon" />
<link rel="pingback" href="../../../xmlrpc.php" /><meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='../../../../fonts.googleapis.com/index.html' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel='dns-prefetch' href='http://www.googletagmanager.com/' />
<link rel='dns-prefetch' href='http://fonts.gstatic.com/' />
<link rel="alternate" type="application/rss+xml" title="WordPress Developer Resources &raquo; Feed" href="../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="WordPress Developer Resources &raquo; Comments Feed" href="../../../comments/feed/index.html" />
<meta property="og:title" content="Adding Custom Endpoints | REST API Handbook | WordPress Developer Resources" />
<meta property="og:site_name" content="WordPress Developer Resources" />
<meta property="og:type" content="website" />
<meta property="og:url" content="../../../index.html" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@WordPress" />
<meta name="description" content="The WordPress REST API is more than just a set of default routes. It is also a tool for creating custom routes and endpoints. The WordPress&hellip;" />
<meta property="og:description" content="The WordPress REST API is more than just a set of default routes. It is also a tool for creating custom routes and endpoints. The WordPress&hellip;" />
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'../../../../www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P24PF4B');</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/developer.wordpress.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.9-alpha-51701"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='dashicons-css'  href='../../../wp-includes/css/dashicons.min.css?ver=5.9-alpha-51701' type='text/css' media='all' />
<link rel='stylesheet' id='admin-bar-css'  href='../../../wp-includes/css/admin-bar.min.css?ver=5.9-alpha-51701' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='../../../wp-includes/css/dist/block-library/style.min.css?ver=5.9-alpha-51701' type='text/css' media='all' />
<link rel='stylesheet' id='wporg-handbook-css-css'  href='../../../wp-content/plugins/handbook/stylesheets/callout-boxes.css?ver=20200121' type='text/css' media='all' />
<link rel='stylesheet' id='open-sans-css'  href='../../../../fonts.googleapis.com/css-2.css?family=Open+Sans%3A300italic%2C400italic%2C600italic%2C300%2C400%2C600&amp;subset=latin%2Clatin-ext&amp;display=fallback&amp;ver=5.9-alpha-51701' type='text/css' media='all' />
<link rel='stylesheet' id='wporg-developer-style-css'  href='../../../wp-content/themes/pub/wporg-developer/style.css?ver=3' type='text/css' media='all' />
<link rel='stylesheet' id='wp-dev-sass-compiled-css'  href='../../../wp-content/themes/pub/wporg-developer/stylesheets/main.css?ver=20200713' type='text/css' media='all' />
<link rel='stylesheet' id='awesomplete-css-css'  href='../../../wp-content/themes/pub/wporg-developer/stylesheets/awesomplete.css?ver=20160114' type='text/css' media='all' />
<link rel='stylesheet' id='autocomplete-css-css'  href='../../../wp-content/themes/pub/wporg-developer/stylesheets/autocomplete.css?ver=20171220' type='text/css' media='all' />
<link rel='stylesheet' id='syntaxhighlighter-core-css'  href='../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b' type='text/css' media='all' />
<link rel='stylesheet' id='syntaxhighlighter-theme-default-css'  href='../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b' type='text/css' media='all' />
<script type='text/javascript' src='../../../wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='../../../wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='../../../wp-content/plugins/handbook/scripts/handbook.js?ver=20150930' id='wporg-handbook-js'></script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/chapters.js?ver=20190603' id='wporg-developer-chapters-js'></script>
<script type='text/javascript' src='../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9b' id='syntaxhighlighter-core-js'></script>
<script type='text/javascript' src='../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js?ver=3.0.9b' id='syntaxhighlighter-brush-php-js'></script>
<link rel="https://api.w.org/" href="https://developer.wordpress.org/wp-json/" /><link rel="alternate" type="application/json" href="https://developer.wordpress.org/wp-json/wp/v2/rest-api-handbook/25388" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc-2.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.9-alpha-51701" />
<link rel='shortlink' href='https://developer.wordpress.org/?p=25388' />
<link rel="alternate" type="application/json+oembed" href="https://developer.wordpress.org/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdeveloper.wordpress.org%2Frest-api%2Fextending-the-rest-api%2Fadding-custom-endpoints%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://developer.wordpress.org/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdeveloper.wordpress.org%2Frest-api%2Fextending-the-rest-api%2Fadding-custom-endpoints%2F&amp;format=xml" />
<link rel="canonical" href="index.html">
<!-- Stream WordPress user activity plugin v3.6.2 -->
	<style>
		@media screen and (max-width: 782px) {
			#wpadminbar li#wp-admin-bar-log-in,
			#wpadminbar li#wp-admin-bar-register {
				display: block;
			}

			#wpadminbar li#wp-admin-bar-log-in a,
			#wpadminbar li#wp-admin-bar-register a {
				padding: 0 8px;
			}
		}
	</style>
		<style>
			a.github-edit {
				margin-left: .5em;
				font-size: .5em;
				vertical-align: top;
				display: inline-block;
				border: 1px solid #eeeeee;
				border-radius: 2px;
				background: #eeeeee;
				padding: .5em .6em .4em;
				color: black;
				margin-top: 0.1em;
			}
			a.github-edit > * {
				opacity: 0.6;
			}
			a.github-edit:hover > * {
				opacity: 1;
				color: black;
			}
			a.github-edit img {
				height: .8em;
			}
		</style>
		
	<script type="text/javascript">
		jQuery( '<style>.hide-if-js { display: none; }</style>' ).appendTo( 'head' );
		jQuery( function($) {
			$( 'body' ).addClass('js');
		} );
	</script>
<style type="text/css" media="print">#wpadminbar { display:none; }</style>
	<style type="text/css" media="screen">
	</style>
	<script>document.cookie='devicePixelRatio='+((window.devicePixelRatio === undefined) ? 1 : window.devicePixelRatio)+'; path=/';</script>

</head>


<body id="wordpress-org" class="rest-api-handbook-template-default single single-rest-api-handbook postid-25388 admin-bar no-customize-support single-handbook">
		<div id="wpadminbar" class="nojq nojs">
						<div class="quicklinks" id="wp-toolbar" role="navigation" aria-label="Toolbar">
				<ul id='wp-admin-bar-root-default' class="ab-top-menu"><li id='wp-admin-bar-wp-logo' class="menupop"><a class='ab-item' aria-haspopup="true" href='https://wordpress.org/about/'><span class="ab-icon" aria-hidden="true"></span><span class="screen-reader-text">About WordPress</span></a><div class="ab-sub-wrapper"><ul id='wp-admin-bar-wp-logo-default' class="ab-submenu"><li id='wp-admin-bar-about'><a class='ab-item' href='https://wordpress.org/about/'>About WordPress</a></li></ul><ul id='wp-admin-bar-wp-logo-external' class="ab-sub-secondary ab-submenu"><li id='wp-admin-bar-wporg'><a class='ab-item' href='https://wordpress.org/'>WordPress.org</a></li><li id='wp-admin-bar-documentation'><a class='ab-item' href='https://wordpress.org/support/'>Documentation</a></li><li id='wp-admin-bar-support-forums'><a class='ab-item' href='https://wordpress.org/support/forums/'>Support</a></li><li id='wp-admin-bar-feedback'><a class='ab-item' href='https://wordpress.org/support/forum/requests-and-feedback'>Feedback</a></li></ul></div></li></ul><ul id='wp-admin-bar-top-secondary' class="ab-top-secondary ab-top-menu"><li id='wp-admin-bar-search' class="admin-bar-search"><div class="ab-item ab-empty-item" tabindex="-1"><form action="https://developer.wordpress.org/" method="get" id="adminbarsearch"><input class="adminbar-input" name="s" id="adminbar-search" type="text" value="" maxlength="150" /><label for="adminbar-search" class="screen-reader-text">Search</label><input type="submit" class="adminbar-button" value="Search" /></form></div></li><li id='wp-admin-bar-log-in'><a class='ab-item' href='https://login.wordpress.org/?locale=en_US'>Log In</a></li><li id='wp-admin-bar-register'><a class='ab-item' href='https://login.wordpress.org/register?locale=en_US'>Register</a></li></ul>			</div>
					</div>

		<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P24PF4B" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<div id="wporg-header">
	<div class="wrapper">
	<h1><a href="http://wordpress.org/">WordPress.org</a></h1>				<div id="head-search">
		<form action="http://wordpress.org/search/do-search.php" method="get">
			<label for="global-search" class="screen-reader-text">Search WordPress.org for:</label>
			<input id="global-search" class="text" name="search" type="text" value="" maxlength="150" placeholder="Search WordPress.org" />
			<button type="submit" class="button"><span class="screen-reader-text">Submit</span></button>
		</form>
		</div>
				<div style="clear:both"></div>
		<button id="mobile-menu-button" aria-expanded="false"><span class="screen-reader-text">Toggle Menu</span></button>
		
<nav aria-label="Main Menu">
<ul id="wporg-header-menu">
<li class="menu-item"><a href='http://wordpress.org/showcase/' data-title='See some of the sites built on WordPress.'>Showcase</a></li>
<li class="menu-item"><a href='http://learn.wordpress.org/' data-title='Resources to help you learn more about WordPress and teach it to others.'>Learn</a></li>
<li class="menu-item"><a href='http://wordpress.org/themes/' data-title='Find just the right look for your website.'>Themes</a></li>
<li class="menu-item"><a href='http://wordpress.org/plugins/' data-title='Plugins can extend WordPress to do almost anything you can imagine.'>Plugins</a></li>
<li class="menu-item"><a href='http://wordpress.org/mobile/' data-title='Take your website on the go!'>Mobile</a></li>
<li class="menu-item"><a href='http://wordpress.org/support/' data-title='Forums, documentation, help.'>Support</a><ul class="nav-submenu"><li><a href='http://wordpress.org/support/' title='Documentation, tutorials, best practices.'>Documentation</a></li><li><a href='http://wordpress.org/support/forums/' title='Support and discussion forums.'>Forums</a></li></ul><div class="uparrow"></div></li>
<li class="menu-item"><a href='http://make.wordpress.org/' data-title='Contribute your knowledge.'>Get Involved</a><ul class="nav-submenu"><li><a href='http://wordpress.org/five-for-the-future/' title='How five percent is powering the next generation of the web'>Five for the Future</a></li></ul><div class="uparrow"></div></li>
<li class="menu-item"><a href='http://wordpress.org/about/' data-title='About the WordPress Organization, and where we&#039;re going.'>About</a></li>
<li class="menu-item"><a href='http://wordpress.org/news/' data-title='Come here for the latest scoop.'>Blog</a></li>
<li class="menu-item"><a href='http://wordpress.org/hosting/' data-title='Find a home for your blog.'>Hosting</a></li>
<li id="download" class="button download-button menu-item"><a href='http://wordpress.org/download/' data-title='Get it. Got it? Good.'>Get WordPress</a></li>
</ul>
</nav>
		<div style="clear:both"></div>
	</div>
</div>



<header id="masthead" class="site-header" role="banner">
			<a href="#" id="secondary-toggle" onclick="return false;"><strong>Menu</strong></a>
		<div class="site-branding">
		<h1 class="site-title">
			<a href="../../../index.html" rel="home">REST API Handbook</a>
		</h1>

		
		<nav id="site-navigation" class="main-navigation" role="navigation">
			<button class="menu-toggle dashicons dashicons-arrow-down-alt2" aria-controls="primary-menu" aria-expanded="false" aria-label="Primary Menu"></button>
					</nav>
	</div>
</header><!-- #masthead -->

<div id="page" class="hfeed site devhub-wrap">
	<a href="#main" class="screen-reader-text">Skip to content</a>

			<div id="content" class="site-content">


	<div id="secondary" class="widget-area" role="complementary">
		<a href="#" id="secondary-toggle"></a>
		<div id="secondary-content">
						<aside id="search-5" class="widget widget_search"><div class="search-section section clear hide-if-js">


	
	<form role="search" method="get" class="searchform searchform-handbook" action="https://developer.wordpress.org/rest-api/">
		<label for="search-field" class="screen-reader-text">Search for:</label>
		<input type="text" id="search-field" class="search-field" placeholder="Search &hellip;" value="" name="s">
		<button class="button button-primary button-search"><i class="dashicons dashicons-search"></i><span class="screen-reader-text">Search plugins</span></button>
	
	</form>

</div><!-- /search-guide -->
</aside><aside id="nav_menu-4" class="widget widget_nav_menu"><h2 class="widget-title">Chapters</h2><div class="menu-rest-api-table-of-contents-container"><ul id="menu-rest-api-table-of-contents" class="menu"><li id="menu-item-22855" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-22855"><a href="../../index.html">REST API Handbook</a></li>
<li id="menu-item-126828" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-126828"><a href="../../key-concepts/index.html">Key Concepts</a></li>
<li id="menu-item-25345" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-25345"><a href="../../frequently-asked-questions/index.html">Frequently Asked Questions</a></li>
<li id="menu-item-25309" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-has-children menu-item-25309"><a href="../../using-the-rest-api/index.html">Using the REST API</a>
<ul class="sub-menu">
	<li id="menu-item-23174" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23174"><a href="../../using-the-rest-api/global-parameters/index.html">Global Parameters</a></li>
	<li id="menu-item-23084" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23084"><a href="../../using-the-rest-api/pagination/index.html">Pagination</a></li>
	<li id="menu-item-23182" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23182"><a href="../../using-the-rest-api/linking-and-embedding/index.html">Linking and Embedding</a></li>
	<li id="menu-item-23087" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23087"><a href="../../using-the-rest-api/discovery/index.html">Discovery</a></li>
	<li id="menu-item-22864" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-22864"><a href="../../using-the-rest-api/authentication/index.html">Authentication</a></li>
	<li id="menu-item-24929" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-24929"><a href="../../using-the-rest-api/backbone-javascript-client/index.html">Backbone.js Client</a></li>
	<li id="menu-item-25310" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-25310"><a href="../../using-the-rest-api/client-libraries/index.html">Client Libraries</a></li>
</ul>
</li>
<li id="menu-item-25319" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook current-rest-api-handbook-ancestor current-menu-ancestor current-menu-parent current-rest-api-handbook-parent menu-item-has-children menu-item-25319"><a href="../index.html">Extending the REST API</a>
<ul class="sub-menu">
	<li id="menu-item-25323" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-25323"><a href="../modifying-responses/index.html">Modifying Responses</a></li>
	<li id="menu-item-25397" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook current-menu-item menu-item-25397"><a href="index.html" aria-current="page">Adding Custom Endpoints</a></li>
	<li id="menu-item-23096" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23096"><a href="../adding-rest-api-support-for-custom-content-types/index.html">Custom Content Types</a></li>
	<li id="menu-item-22859" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-22859"><a href="../schema/index.html">Schema</a></li>
	<li id="menu-item-22862" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-22862"><a href="../routes-and-endpoints/index.html">Routes and Endpoints</a></li>
	<li id="menu-item-22861" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-22861"><a href="../controller-classes/index.html">Controller Classes</a></li>
</ul>
</li>
<li id="menu-item-23109" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-has-children menu-item-23109"><a href="../../reference/index.html">Endpoint Reference</a>
<ul class="sub-menu">
	<li id="menu-item-132192" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-132192"><a href="../../reference/application-passwords/index.html">Application Passwords</a></li>
	<li id="menu-item-129929" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-129929"><a href="../../reference/block-types/index.html">Block Types</a></li>
	<li id="menu-item-125550" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-125550"><a href="../../reference/blocks/index.html">Editor Blocks</a></li>
	<li id="menu-item-125551" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-125551"><a href="../../reference/block-revisions/index.html">Block Revisions</a></li>
	<li id="menu-item-125554" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-125554"><a href="../../reference/rendered-blocks/index.html">Block Renderer</a></li>
	<li id="menu-item-23132" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23132"><a href="../../reference/categories/index.html">Categories</a></li>
	<li id="menu-item-23137" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23137"><a href="../../reference/comments/index.html">Comments</a></li>
	<li id="menu-item-23134" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23134"><a href="../../reference/media/index.html">Media</a></li>
	<li id="menu-item-23135" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23135"><a href="../../reference/pages/index.html">Pages</a></li>
	<li id="menu-item-127331" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-127331"><a href="../../reference/page-revisions/index.html">Page Revisions</a></li>
	<li id="menu-item-23136" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23136"><a href="../../reference/posts/index.html">Posts</a></li>
	<li id="menu-item-23139" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23139"><a href="../../reference/post-revisions/index.html">Post Revisions</a></li>
	<li id="menu-item-125553" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-125553"><a href="../../reference/search-results/index.html">Search Results</a></li>
	<li id="menu-item-23131" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23131"><a href="../../reference/settings/index.html">Site Settings</a></li>
	<li id="menu-item-23138" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23138"><a href="../../reference/post-statuses/index.html">Statuses</a></li>
	<li id="menu-item-23142" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23142"><a href="../../reference/tags/index.html">Tags</a></li>
	<li id="menu-item-23147" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23147"><a href="../../reference/taxonomies/index.html">Taxonomies</a></li>
	<li id="menu-item-125552" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-125552"><a href="../../reference/themes/index.html">Themes</a></li>
	<li id="menu-item-23133" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23133"><a href="../../reference/post-types/index.html">Types</a></li>
	<li id="menu-item-23130" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23130"><a href="../../reference/users/index.html">Users</a></li>
	<li id="menu-item-129928" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-129928"><a href="../../reference/block-directory-items/index.html">Block Directory Items</a></li>
	<li id="menu-item-129927" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-129927"><a href="../../reference/plugins/index.html">Plugins</a></li>
</ul>
</li>
<li id="menu-item-23187" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-23187"><a href="../../glossary/index.html">Glossary</a></li>
<li id="menu-item-25439" class="menu-item menu-item-type-post_type menu-item-object-rest-api-handbook menu-item-25439"><a href="../../changelog/index.html">Changelog</a></li>
</ul></div></aside>		</div>
	</div><!-- #secondary -->


		<main id="primary" class="site-main post-25388 rest-api-handbook type-rest-api-handbook status-publish hentry type-handbook" role="main">

		
		<div class="breadcrumb-trail breadcrumbs" itemprop="breadcrumb">
			<span class="trail-browse">Browse:</span> 
			<span class="trail-begin"><a href="../../../index.html" title="WordPress Developer Resources" rel="home">Home</a></span> <span class="sep">&#47;</span> 
			<span class="trail-inner"><a href="../../index.html">REST API Handbook</a></span> <span class="sep">&#47;</span> 
			<span class="trail-inner"><a href="../index.html" title="Extending the REST API">Extending the REST API</a></span> <span class="sep">&#47;</span> <span class="trail-end">Adding Custom Endpoints</span>
		</div>
		
			
<h1>Adding Custom Endpoints <a class="github-edit" href="https://github.com/WP-API/docs/edit/master/extending-the-rest-api/adding-custom-endpoints.md"><img src="../../../wp-content/plugins/wporg-cli/assets/images/github-mark.svg"> <span>Edit</span></a></h1>


<style> .toc-jump { text-align: right; font-size: 12px; } .page .toc-heading { margin-top: -50px; padding-top: 50px !important; }</style><div class="table-of-contents"><h2>Topics</h2><ul class="items"><li><a href="#bare-basics">Bare Basics</a>
<ul>
<li><a href="#namespacing">Namespacing</a></li>
<li><a href="#arguments">Arguments</a></li>
<li><a href="#return-value">Return Value</a></li>
<li><a href="#permissions-callback">Permissions Callback</a></li>
<li><a href="#discovery">Discovery</a>
</ul></li>
<li><a href="#the-controller-pattern">The Controller Pattern</a></li>
<li><a href="#examples">Examples</a></ul>
</div>
<p>The WordPress REST API is more than just a set of default routes. It is also a tool for creating custom routes and endpoints. The WordPress front-end provides a default set of URL mappings, but the tools used to create them (e.g. the Rewrites API, as well as the query classes: <code>WP_Query</code>, <code>WP_User</code>, etc) are also available for creating your own URL mappings, or custom queries.</p>
<p>This document details how to create a totally custom route, with its own endpoints. We&#8217;ll first work through a short example, then expand it out to the full controller pattern as used internally.</p>
<h2 class="toc-heading" id="bare-basics" tabindex="-1">Bare Basics <a href="#bare-basics" class="anchor"><span aria-hidden="true">#</span><span class="screen-reader-text">Bare Basics</span></a></h2>
<p>So you want to add custom endpoints to the API? Fantastic! Let&#8217;s get started with a simple example.<br />
Let&#8217;s start with a simple function that looks like this:</p>
<section class="source-content">
<div class="source-code-container">
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
/**
 * Grab latest post title by an author!
 *
 * @param array $data Options for the function.
 * @return string|null Post title for the latest,  * or null if none.
 */
function my_awesome_func( $data ) {
  $posts = get_posts( array(
    &#039;author&#039; =&gt; $data[&#039;id&#039;],
  ) );

  if ( empty( $posts ) ) {
    return null;
  }

  return $posts[0]-&gt;post_title;
}
</pre>
</div>
<p class="source-code-links"><span><a href="#" class="show-complete-source">Expand full source code</a><a href="#" class="less-complete-source">Collapse full source code</a></span></p>
</section>
<p>To make this available via the API, we need to register a route. This tells the API to respond to a given request with our function. We do this through a function called <code>register_rest_route</code>, which should be called in a callback on <code>rest_api_init</code> to avoid doing extra work when the API isn&#8217;t loaded.</p>
<p>We need to pass in three things to <code>register_rest_route</code>: the namespace, the route we want, and the options. We&#8217;ll come back to the namespace in a bit, but for now, let&#8217;s pick <code>myplugin/v1</code>. We&#8217;re going to have the route match anything with <code>/author/{id}</code>, where <code>{id}</code> is an integer.</p>
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
add_action( &#039;rest_api_init&#039;, function () {
  register_rest_route( &#039;myplugin/v1&#039;, &#039;/author/(?P&lt;id&gt;\d+)&#039;, array(
    &#039;methods&#039; =&gt; &#039;GET&#039;,
    &#039;callback&#039; =&gt; &#039;my_awesome_func&#039;,
  ) );
} );
</pre>
<p>Right now, we&#8217;re only registering the one endpoint for the route. The term &#8220;route&#8221; refers to the URL, whereas &#8220;endpoint&#8221; refers to the function behind it that corresponds to a method <em>and</em> a URL (for more information, see the <a href="../../glossary/index.html">Glossary</a>).</p>
<p>For example, if your site domain is <code>example.com</code> and you&#8217;ve kept the API path of <code>wp-json</code>, then the full URL would be <code>http://example.com/wp-json/myplugin/v1/author/(?P\d+)</code>.</p>
<p>Each route can have any number of endpoints, and for each endpoint, you can define the HTTP methods allowed, a callback function for responding to the request and a permissions callback for creating custom permissions. In addition you can define allowed fields in the request and for each field specify a default value, a sanitization callback, a validation callback, and whether the field is required.</p>
<h3 class="toc-heading" id="namespacing" tabindex="-1">Namespacing <a href="#namespacing" class="anchor"><span aria-hidden="true">#</span><span class="screen-reader-text">Namespacing</span></a></h3>
<p>Namespaces are the first part of the URL for the endpoint. They should be used as a vendor/package prefix to prevent clashes between custom routes. Namespaces allows for two plugins to add a route of the same name, with different functionality.</p>
<p>Namespaces in general should follow the pattern of <code>vendor/v1</code>, where <code>vendor</code> is typically your plugin or theme slug, and <code>v1</code> represents the first version of the API. If you ever need to break compatibility with new endpoints, you can then bump this to <code>v2</code>.</p>
<p>The above scenario, two routes with the same name, from two different plugins, requires all vendors to use a unique namespace. Failing to do so is analogous to a failure to use a vendor function prefix, class prefix and/ or class namespace in a theme or plugin, which is <strong>very very bad</strong>.</p>
<p>An added benefit of using namespaces is that clients can detect support for your custom API. The API index lists out the available namespaces on a site:</p>
<pre class="brush: php; title: ; notranslate" title="">
{
  &quot;name&quot;: &quot;WordPress Site&quot;,
  &quot;description&quot;: &quot;Just another WordPress site&quot;,
  &quot;url&quot;: &quot;http://example.com/&quot;,
  &quot;namespaces&quot;: [
    &quot;wp/v2&quot;,
    &quot;vendor/v1&quot;,
    &quot;myplugin/v1&quot;,
    &quot;myplugin/v2&quot;,
  ]
}
</pre>
<p>If a client wants to check that your API exists on a site, they can check against this list. (For more information, see the <a href="../../using-the-rest-api/discovery/index.html">Discovery guide</a>.)</p>
<p class="toc-jump"><a href="#top">Top &uarr;</a></p><h3 class="toc-heading" id="arguments" tabindex="-1">Arguments <a href="#arguments" class="anchor"><span aria-hidden="true">#</span><span class="screen-reader-text">Arguments</span></a></h3>
<p>By default, routes receive all arguments passed in from the request. These are merged into a single set of parameters, then added to the Request object, which is passed in as the first parameter to your endpoint:</p>
<section class="source-content">
<div class="source-code-container">
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
function my_awesome_func( WP_REST_Request $request ) {
  // You can access parameters via direct array access on the object:
  $param = $request[&#039;some_param&#039;];

  // Or via the helper method:
  $param = $request-&gt;get_param( &#039;some_param&#039; );

  // You can get the combined, merged set of parameters:
  $parameters = $request-&gt;get_params();

  // The individual sets of parameters are also available, if needed:
  $parameters = $request-&gt;get_url_params();
  $parameters = $request-&gt;get_query_params();
  $parameters = $request-&gt;get_body_params();
  $parameters = $request-&gt;get_json_params();
  $parameters = $request-&gt;get_default_params();

  // Uploads aren&#039;t merged in, but can be accessed separately:
  $parameters = $request-&gt;get_file_params();
}
</pre>
</div>
<p class="source-code-links"><span><a href="#" class="show-complete-source">Expand full source code</a><a href="#" class="less-complete-source">Collapse full source code</a></span></p>
</section>
<p>(To find out exactly how parameters are merged, check the source of <code>WP_REST_Request::get_parameter_order()</code>; the basic order is body, query, URL, then defaults.)</p>
<p>Normally, you&#8217;ll get every parameter brought in unaltered. However, you can register your arguments when registering your route, which allows you to run sanitization and validation on these.</p>
<p>If the request has the <code>Content-type: application/json</code> header set and valid JSON in the body, <code>get_json_params()</code> will return the parsed JSON body as an associative array.</p>
<p>Arguments are defined as a map in the key <code>args</code> for each endpoint (next to your <code>callback</code> option). This map uses the name of the argument of the key, with the value being a map of options for that argument. This array can contain a key for <code>default</code>, <code>required</code>, <code>sanitize_callback</code> and <code>validate_callback</code>.</p>
<ul>
<li><code>default</code>: Used as the default value for the argument, if none is supplied.</li>
<li><code>required</code>: If defined as true, and no value is passed for that argument, an error will be returned. No effect if a default value is set, as the argument will always have a value.</li>
<li><code>validate_callback</code>: Used to pass a function that will be passed the value of the argument. That function should return true if the value is valid, and false if not.</li>
<li><code>sanitize_callback</code>: Used to pass a function that is used to sanitize the value of the argument before passing it to the main callback.</li>
</ul>
<p>Using <code>sanitize_callback</code> and <code>validate_callback</code> allows the main callback to act only to process the request, and prepare data to be returned using the <code>WP_REST_Response</code> class. By using these two callbacks, you will be able to safely assume your inputs are valid and safe when processing.</p>
<p>Taking our previous example, we can ensure the parameter passed in is always a number:</p>
<section class="source-content">
<div class="source-code-container">
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
add_action( &#039;rest_api_init&#039;, function () {
  register_rest_route( &#039;myplugin/v1&#039;, &#039;/author/(?P&lt;id&gt;\d+)&#039;, array(
    &#039;methods&#039; =&gt; &#039;GET&#039;,
    &#039;callback&#039; =&gt; &#039;my_awesome_func&#039;,
    &#039;args&#039; =&gt; array(
      &#039;id&#039; =&gt; array(
        &#039;validate_callback&#039; =&gt; function($param, $request, $key) {
          return is_numeric( $param );
        }
      ),
    ),
  ) );
} );
</pre>
</div>
<p class="source-code-links"><span><a href="#" class="show-complete-source">Expand full source code</a><a href="#" class="less-complete-source">Collapse full source code</a></span></p>
</section>
<p>You could also pass in a function name to <code>validate_callback</code>, but passing certain functions like <code>is_numeric</code> directly will not only throw a warning about having extra parameters passed to it, but will also return <code>NULL</code> causing the callback function to be called with invalid data. We hope to <a href="https://core.trac.wordpress.org/ticket/34659">eventually solve this problem in WordPress core</a>.</p>
<p>We could also use something like <code>'sanitize_callback' =&gt; 'absint'</code> instead, but validation will throw an error, allowing clients to understand what they&#8217;re doing wrong. Sanitization is useful when you would rather change the data being input rather than throwing an error (such as invalid HTML).</p>
<p class="toc-jump"><a href="#top">Top &uarr;</a></p><h3 class="toc-heading" id="return-value" tabindex="-1">Return Value <a href="#return-value" class="anchor"><span aria-hidden="true">#</span><span class="screen-reader-text">Return Value</span></a></h3>
<p>After your callback is called, the return value is then converted to JSON, and returned to the client. This allows you to return basically any form of data. In our example above, we&#8217;re returning either a string or null, which are automatically handled by the API and converted to JSON.</p>
<p>Like any other WordPress function, you can also return a <code>WP_Error</code> instance. This error information will be passed along to the client, along with a 500 Internal Service Error status code. You can further customise your error by setting the <code>status</code> option in the <code>WP_Error</code> instance data to a code, such as <code>400</code> for bad input data.<br />
Taking our example from before, we can now return an error instance:</p>
<section class="source-content">
<div class="source-code-container">
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
/**
 * Grab latest post title by an author!
 *
 * @param array $data Options for the function.
 * @return string|null Post title for the latest,
 * or null if none.
 */
function my_awesome_func( $data ) {
  $posts = get_posts( array(
    &#039;author&#039; =&gt; $data[&#039;id&#039;],
  ) );

  if ( empty( $posts ) ) {
    return new WP_Error( &#039;no_author&#039;, &#039;Invalid author&#039;, array( &#039;status&#039; =&gt; 404 ) );
  }

  return $posts[0]-&gt;post_title;
}
</pre>
</div>
<p class="source-code-links"><span><a href="#" class="show-complete-source">Expand full source code</a><a href="#" class="less-complete-source">Collapse full source code</a></span></p>
</section>
<p>When an author doesn&#8217;t have any posts belonging to them, this will return a 404 Not Found error to the client:</p>
<pre class="brush: php; title: ; notranslate" title="">
HTTP/1.1 404 Not Found

[{
   &quot;code&quot;: &quot;no_author&quot;,
   &quot;message&quot;: &quot;Invalid author&quot;,
   &quot;data&quot;: { &quot;status&quot;: 404 }
}]
</pre>
<p>For more advanced usage, you can return a <code>WP_REST_Response</code> object. This object &#8220;wraps&#8221; normal body data, but allows you to return a custom status code, or custom headers. You can also <a href="../../using-the-rest-api/linking-and-embedding/index.html">add links to your response</a>. The quickest way to use this is via the constructor:</p>
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
$data = array( &#039;some&#039;, &#039;response&#039;, &#039;data&#039; );

// Create the response object
$response = new WP_REST_Response( $data );

// Add a custom status code
$response-&gt;set_status( 201 );

// Add a custom header
$response-&gt;header( &#039;Location&#039;, &#039;http://example.com/&#039; );
</pre>
<p>When wrapping existing callbacks, you should always use <code>rest_ensure_response()</code> on the return value. This will take raw data returned from an endpoint and automatically turn it into a <code>WP_REST_Response</code> for you. (Note that <code>WP_Error</code> is not converted to a <code>WP_REST_Response</code> to allow proper error handling.)</p>
<p>Importantly, a REST API route&#8217;s callback should <em>always</em> return data; it shouldn&#8217;t attempt to send the response body itself. This ensures that the additional processing that the REST API server does, like handling linking/embedding, sending headers, etc… takes place. In other words, don&#8217;t call <code>die( wp_json_encode( $data ) );</code> or <code>wp_send_json( $data )</code>. As of <a href="https://core.trac.wordpress.org/changeset/48361">WordPress 5.5</a>, a <code>_doing_it_wrong</code> notice is issued if the <code>wp_send_json()</code> family of functions is used during a REST API request.</p>
<blockquote><p>
  Return a <a href="../../../reference/classes/wp_rest_response/index.html">WP_REST_Response</a> or <a href="../../../reference/classes/wp_error/index.html">WP_Error</a> object from your callback when using the REST API.
</p></blockquote>
<p class="toc-jump"><a href="#top">Top &uarr;</a></p><h3 class="toc-heading" id="permissions-callback" tabindex="-1">Permissions Callback <a href="#permissions-callback" class="anchor"><span aria-hidden="true">#</span><span class="screen-reader-text">Permissions Callback</span></a></h3>
<p>You must also register a permissions callback for the endpoint. This is a function that checks if the user can perform the action (reading, updating, etc) before the real callback is called. This allows the API to tell the client what actions they can perform on a given URL without needing to attempt the request first.</p>
<p>This callback can be registered as <code>permission_callback</code>, again in the endpoint options next to your <code>callback</code> option. This callback should return a boolean or a <code>WP_Error</code> instance. If this function returns true, the response will be processed. If it returns false, a default error message will be returned and the request will not proceed with processing. If it returns a <code>WP_Error</code>, that error will be returned to the client.</p>
<p>The permissions callback is run after remote authentication, which sets the current user. This means you can use <code>current_user_can</code> to check if the user that has been authenticated has the appropriate capability for the action, or any other check based on current user ID. Where possible, you should always use <code>current_user_can</code>; instead of checking if the user is logged in (authentication), check whether they can perform the action (authorization).</p>
<p>Once you register a <code>permission_callback</code>, you will need to authenticate your requests (for example by including a nonce parameter) or you will receive a <code>rest_forbidden</code> error. See <a href="../../using-the-rest-api/authentication/index.html">Authentication</a> for more details.</p>
<p>Continuing with our previous example, we can make it so that only editors or above can view this author data. We can check a number of different capabilities here, but the best is <code>edit_others_posts</code>, which is really the core of what an editor is. To do this, we just need a callback here:</p>
<section class="source-content">
<div class="source-code-container">
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
add_action( &#039;rest_api_init&#039;, function () {
  register_rest_route( &#039;myplugin/v1&#039;, &#039;/author/(?P&lt;id&gt;\d+)&#039;, array(
    &#039;methods&#039; =&gt; &#039;GET&#039;,
    &#039;callback&#039; =&gt; &#039;my_awesome_func&#039;,
    &#039;args&#039; =&gt; array(
      &#039;id&#039; =&gt; array(
        &#039;validate_callback&#039; =&gt; &#039;is_numeric&#039;
      ),
    ),
    &#039;permission_callback&#039; =&gt; function () {
      return current_user_can( &#039;edit_others_posts&#039; );
    }
  ) );
} );
</pre>
</div>
<p class="source-code-links"><span><a href="#" class="show-complete-source">Expand full source code</a><a href="#" class="less-complete-source">Collapse full source code</a></span></p>
</section>
<p>Note that the permission callback also receives the Request object as the first parameter, so you can do checks based on request arguments if you need to.</p>
<p>As of <a href="https://core.trac.wordpress.org/changeset/48526">WordPress 5.5</a>, if a <code>permission_callback</code> is not provided, the REST API will issue a <code>_doing_it_wrong</code> notice.</p>
<blockquote><p>
  The REST API route definition for myplugin/v1/author is missing the required permission_callback argument. For REST API routes that are intended to be public, use __return_true as the permission callback.
</p></blockquote>
<p>If your REST API endpoint is public, you can use <code>__return_true</code> as the permission callback.</p>
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
add_action( &#039;rest_api_init&#039;, function () {
  register_rest_route( &#039;myplugin/v1&#039;, &#039;/author/(?P&lt;id&gt;\d+)&#039;, array(
    &#039;methods&#039; =&gt; &#039;GET&#039;,
    &#039;callback&#039; =&gt; &#039;my_awesome_func&#039;,
    &#039;permission_callback&#039; =&gt; &#039;__return_true&#039;,
  ) );
} );
</pre>
<p class="toc-jump"><a href="#top">Top &uarr;</a></p><h3 class="toc-heading" id="discovery" tabindex="-1">Discovery <a href="#discovery" class="anchor"><span aria-hidden="true">#</span><span class="screen-reader-text">Discovery</span></a></h3>
<p>If you&#8217;d like to enable <a href="../../using-the-rest-api/discovery/index.html#resource-discovery">Resource Discovery</a> for your custom endpoint, you can do so using the <code>rest_queried_resource_route</code> filter. For example, consider a <a href="../../../reference/hooks/query_vars/index.html">custom query var</a> <code>my-route</code> that contains the id of your custom resource. The following code snippet would add a discovery link whenever the <code>my-route</code> query var is used.</p>
<pre class="brush: php; title: ; notranslate" title="">
function my_plugin_rest_queried_resource_route( $route ) {
    $id = get_query_var( &#039;my-route&#039; );
    if ( ! $route &amp;&amp; $id ) {
        $route = &#039;/my-ns/v1/items/&#039; . $id;
    }

    return $route;
}
add_filter( &#039;rest_queried_resource_route&#039;, &#039;my_plugin_rest_queried_resource_route&#039; );
</pre>
<p>Note: If your endpoint is describing a custom post type or custom taxonomy you will most likely want to be using the <code>rest_route_for_post</code> or <code>rest_route_for_term</code> filters instead.</p>
<p class="toc-jump"><a href="#top">Top &uarr;</a></p><h2 class="toc-heading" id="the-controller-pattern" tabindex="-1">The Controller Pattern <a href="#the-controller-pattern" class="anchor"><span aria-hidden="true">#</span><span class="screen-reader-text">The Controller Pattern</span></a></h2>
<p>The controller pattern is a best practice for working with complex endpoints with the API.</p>
<p>It is recommended that you read <a href="../controller-classes/index.html#extending-internal-classes">&#8220;Extending Internal Classes&#8221;</a> before reading this section. Doing so will familiarize you with the patterns used by the default routes, which is the best practice. While it is not required that the class you use to process your request extends the <code>WP_REST_Controller</code> class or a class that extends it, doing so allows you to inherit work done in those classes. In addition, you can rest assured that you&#8217;re following best practices based on the controller methods you&#8217;re using.</p>
<p>At their core, controllers are nothing more than a set of commonly named methods to match up with REST conventions, along with some handy helpers. Controllers register their routes in a <code>register_routes</code> method, respond to requests with <code>get_items</code>, <code>get_item</code>, <code>create_item</code>, <code>update_item</code> and <code>delete_item</code>, and have similarly named permission check methods. Following this pattern will ensure you don&#8217;t miss any steps or functionality in your endpoints.</p>
<p>To use controllers, you first need to subclass the base controller. This gives you a base set of methods, ready for you to add your own behaviour into.</p>
<p>Once we&#8217;ve subclassed the controller, we need to instantiate the class to get it working. This should be done inside of a callback hooked into <code>rest_api_init</code>, which ensures we only instantiate the class when we need to. The normal controller pattern is to call <code>$controller-&gt;register_routes()</code> inside this callback, where the class can then register its endpoints.</p>
<p class="toc-jump"><a href="#top">Top &uarr;</a></p><h2 class="toc-heading" id="examples" tabindex="-1">Examples <a href="#examples" class="anchor"><span aria-hidden="true">#</span><span class="screen-reader-text">Examples</span></a></h2>
<p>The following is a &#8220;starter&#8221; custom route:</p>
<section class="source-content">
<div class="source-code-container">
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php

class Slug_Custom_Route extends WP_REST_Controller {

  /**
   * Register the routes for the objects of the controller.
   */
  public function register_routes() {
    $version = &#039;1&#039;;
    $namespace = &#039;vendor/v&#039; . $version;
    $base = &#039;route&#039;;
    register_rest_route( $namespace, &#039;/&#039; . $base, array(
      array(
        &#039;methods&#039;             =&gt; WP_REST_Server::READABLE,
        &#039;callback&#039;            =&gt; array( $this, &#039;get_items&#039; ),
        &#039;permission_callback&#039; =&gt; array( $this, &#039;get_items_permissions_check&#039; ),
        &#039;args&#039;                =&gt; array(

        ),
      ),
      array(
        &#039;methods&#039;             =&gt; WP_REST_Server::CREATABLE,
        &#039;callback&#039;            =&gt; array( $this, &#039;create_item&#039; ),
        &#039;permission_callback&#039; =&gt; array( $this, &#039;create_item_permissions_check&#039; ),
        &#039;args&#039;                =&gt; $this-&gt;get_endpoint_args_for_item_schema( true ),
      ),
    ) );
    register_rest_route( $namespace, &#039;/&#039; . $base . &#039;/(?P&lt;id&gt;[\d]+)&#039;, array(
      array(
        &#039;methods&#039;             =&gt; WP_REST_Server::READABLE,
        &#039;callback&#039;            =&gt; array( $this, &#039;get_item&#039; ),
        &#039;permission_callback&#039; =&gt; array( $this, &#039;get_item_permissions_check&#039; ),
        &#039;args&#039;                =&gt; array(
          &#039;context&#039; =&gt; array(
            &#039;default&#039; =&gt; &#039;view&#039;,
          ),
        ),
      ),
      array(
        &#039;methods&#039;             =&gt; WP_REST_Server::EDITABLE,
        &#039;callback&#039;            =&gt; array( $this, &#039;update_item&#039; ),
        &#039;permission_callback&#039; =&gt; array( $this, &#039;update_item_permissions_check&#039; ),
        &#039;args&#039;                =&gt; $this-&gt;get_endpoint_args_for_item_schema( false ),
      ),
      array(
        &#039;methods&#039;             =&gt; WP_REST_Server::DELETABLE,
        &#039;callback&#039;            =&gt; array( $this, &#039;delete_item&#039; ),
        &#039;permission_callback&#039; =&gt; array( $this, &#039;delete_item_permissions_check&#039; ),
        &#039;args&#039;                =&gt; array(
          &#039;force&#039; =&gt; array(
            &#039;default&#039; =&gt; false,
          ),
        ),
      ),
    ) );
    register_rest_route( $namespace, &#039;/&#039; . $base . &#039;/schema&#039;, array(
      &#039;methods&#039;  =&gt; WP_REST_Server::READABLE,
      &#039;callback&#039; =&gt; array( $this, &#039;get_public_item_schema&#039; ),
    ) );
  }

  /**
   * Get a collection of items
   *
   * @param WP_REST_Request $request Full data about the request.
   * @return WP_Error|WP_REST_Response
   */
  public function get_items( $request ) {
    $items = array(); //do a query, call another class, etc
    $data = array();
    foreach( $items as $item ) {
      $itemdata = $this-&gt;prepare_item_for_response( $item, $request );
      $data[] = $this-&gt;prepare_response_for_collection( $itemdata );
    }

    return new WP_REST_Response( $data, 200 );
  }

  /**
   * Get one item from the collection
   *
   * @param WP_REST_Request $request Full data about the request.
   * @return WP_Error|WP_REST_Response
   */
  public function get_item( $request ) {
    //get parameters from request
    $params = $request-&gt;get_params();
    $item = array();//do a query, call another class, etc
    $data = $this-&gt;prepare_item_for_response( $item, $request );

    //return a response or error based on some conditional
    if ( 1 == 1 ) {
      return new WP_REST_Response( $data, 200 );
    } else {
      return new WP_Error( &#039;code&#039;, __( &#039;message&#039;, &#039;text-domain&#039; ) );
    }
  }

  /**
   * Create one item from the collection
   *
   * @param WP_REST_Request $request Full data about the request.
   * @return WP_Error|WP_REST_Response
   */
  public function create_item( $request ) {
    $item = $this-&gt;prepare_item_for_database( $request );

    if ( function_exists( &#039;slug_some_function_to_create_item&#039; ) ) {
      $data = slug_some_function_to_create_item( $item );
      if ( is_array( $data ) ) {
        return new WP_REST_Response( $data, 200 );
      }
    }

    return new WP_Error( &#039;cant-create&#039;, __( &#039;message&#039;, &#039;text-domain&#039; ), array( &#039;status&#039; =&gt; 500 ) );
  }

  /**
   * Update one item from the collection
   *
   * @param WP_REST_Request $request Full data about the request.
   * @return WP_Error|WP_REST_Response
   */
  public function update_item( $request ) {
    $item = $this-&gt;prepare_item_for_database( $request );

    if ( function_exists( &#039;slug_some_function_to_update_item&#039; ) ) {
      $data = slug_some_function_to_update_item( $item );
      if ( is_array( $data ) ) {
        return new WP_REST_Response( $data, 200 );
      }
    }

    return new WP_Error( &#039;cant-update&#039;, __( &#039;message&#039;, &#039;text-domain&#039; ), array( &#039;status&#039; =&gt; 500 ) );
  }

  /**
   * Delete one item from the collection
   *
   * @param WP_REST_Request $request Full data about the request.
   * @return WP_Error|WP_REST_Response
   */
  public function delete_item( $request ) {
    $item = $this-&gt;prepare_item_for_database( $request );

    if ( function_exists( &#039;slug_some_function_to_delete_item&#039; ) ) {
      $deleted = slug_some_function_to_delete_item( $item );
      if ( $deleted ) {
        return new WP_REST_Response( true, 200 );
      }
    }

    return new WP_Error( &#039;cant-delete&#039;, __( &#039;message&#039;, &#039;text-domain&#039; ), array( &#039;status&#039; =&gt; 500 ) );
  }

  /**
   * Check if a given request has access to get items
   *
   * @param WP_REST_Request $request Full data about the request.
   * @return WP_Error|bool
   */
  public function get_items_permissions_check( $request ) {
    //return true; &lt;--use to make readable by all
    return current_user_can( &#039;edit_something&#039; );
  }

  /**
   * Check if a given request has access to get a specific item
   *
   * @param WP_REST_Request $request Full data about the request.
   * @return WP_Error|bool
   */
  public function get_item_permissions_check( $request ) {
    return $this-&gt;get_items_permissions_check( $request );
  }

  /**
   * Check if a given request has access to create items
   *
   * @param WP_REST_Request $request Full data about the request.
   * @return WP_Error|bool
   */
  public function create_item_permissions_check( $request ) {
    return current_user_can( &#039;edit_something&#039; );
  }

  /**
   * Check if a given request has access to update a specific item
   *
   * @param WP_REST_Request $request Full data about the request.
   * @return WP_Error|bool
   */
  public function update_item_permissions_check( $request ) {
    return $this-&gt;create_item_permissions_check( $request );
  }

  /**
   * Check if a given request has access to delete a specific item
   *
   * @param WP_REST_Request $request Full data about the request.
   * @return WP_Error|bool
   */
  public function delete_item_permissions_check( $request ) {
    return $this-&gt;create_item_permissions_check( $request );
  }

  /**
   * Prepare the item for create or update operation
   *
   * @param WP_REST_Request $request Request object
   * @return WP_Error|object $prepared_item
   */
  protected function prepare_item_for_database( $request ) {
    return array();
  }

  /**
   * Prepare the item for the REST response
   *
   * @param mixed $item WordPress representation of the item.
   * @param WP_REST_Request $request Request object.
   * @return mixed
   */
  public function prepare_item_for_response( $item, $request ) {
    return array();
  }

  /**
   * Get the query params for collections
   *
   * @return array
   */
  public function get_collection_params() {
    return array(
      &#039;page&#039;     =&gt; array(
        &#039;description&#039;       =&gt; &#039;Current page of the collection.&#039;,
        &#039;type&#039;              =&gt; &#039;integer&#039;,
        &#039;default&#039;           =&gt; 1,
        &#039;sanitize_callback&#039; =&gt; &#039;absint&#039;,
      ),
      &#039;per_page&#039; =&gt; array(
        &#039;description&#039;       =&gt; &#039;Maximum number of items to be returned in result set.&#039;,
        &#039;type&#039;              =&gt; &#039;integer&#039;,
        &#039;default&#039;           =&gt; 10,
        &#039;sanitize_callback&#039; =&gt; &#039;absint&#039;,
      ),
      &#039;search&#039;   =&gt; array(
        &#039;description&#039;       =&gt; &#039;Limit results to those matching a string.&#039;,
        &#039;type&#039;              =&gt; &#039;string&#039;,
        &#039;sanitize_callback&#039; =&gt; &#039;sanitize_text_field&#039;,
      ),
    );
  }
}
</pre>
</div>
<p class="source-code-links"><span><a href="#" class="show-complete-source">Expand full source code</a><a href="#" class="less-complete-source">Collapse full source code</a></span></p>
</section>


<div class="bottom-of-entry">&nbsp;</div>

			
		<nav class="handbook-navigation" role="navigation">
			<h1 class="screen-reader-text">Handbook navigation</h1>
			<div class="nav-links">

			<a href="../modifying-responses/index.html" rel="previous"><span class="meta-nav">&larr;</span> Modifying Responses</a><a href="../adding-rest-api-support-for-custom-content-types/index.html" rel="next">Custom Content Types <span class="meta-nav">&rarr;</span></a>
			</div>
			<!-- .nav-links -->
		</nav><!-- .navigation -->
	
		
		</main><!-- #main -->

	</div><!-- #content -->

</div><!-- #page -->


<div id="wporg-footer">
	<div class="wrapper">
		<ul>
			<li><a href="http://wordpress.org/about/" title="An introduction to the WordPress project">About</a></li>
			<li><a href="http://wordpress.org/news/" title="News and Updates">Blog</a></li>
			<li><a href="http://wordpress.org/hosting/" title="Recommended web hosting providers">Hosting</a></li>
			<li><a href="https://wordpressfoundation.org/donate/" title="Donate to the WordPress Foundation">Donate</a></li>
		</ul>

		<ul>
			<li><a href="http://wordpress.org/support/" title="Forums, documentation, and other resources">Support</a></li>
			<li><a href="../../../index.html" title="Resources for WordPress developers">Developers</a></li>
			<li><a href="http://make.wordpress.org/" title="Give back to WordPress through code, support, translation and more">Get Involved</a></li>
			<li><a href="http://learn.wordpress.org/" title="Workshops and training materials">Learn</a></li>
		</ul>

		<ul>
			<li><a href="http://wordpress.org/showcase/" title="Some of the best WordPress sites on the Web">Showcase</a></li>
			<li><a href="http://wordpress.org/plugins/" title="Add extra functionality to WordPress">Plugins</a></li>
			<li><a href="http://wordpress.org/themes/" title="Make your WordPress pretty">Themes</a></li>
		</ul>

		<ul>
			<li><a href="http://central.wordcamp.org/" title="Find a WordPress event near you">WordCamp</a></li>
			<li><a href="http://wordpress.tv/" title="Videos, tutorials, and WordCamp sessions">WordPress.TV</a></li>
			<li><a href="http://buddypress.org/" title="A set of plugins to transform your WordPress into a social network">BuddyPress</a></li>
			<li><a href="http://bbpress.org/" title="Fast, slick forums built on WordPress">bbPress</a></li>
		</ul>

		<ul>
			<li><a href="http://wordpress.com/?ref=wporg-footer" title="Hassle-free WordPress hosting">WordPress.com</a></li>
			<li><a href="http://ma.tt/" title="Co-founder of WordPress, an example of what WordPress can do">Matt</a></li>
			<li><a href="http://wordpress.org/about/privacy/" title="WordPress.org Privacy Policy">Privacy</a></li>
			<li><a href="https://publiccode.eu/" target="_blank">Public Code</a></li>
		</ul>

		<ul class="social-media-links">
			<li><span class="dashicons dashicons-twitter"></span><a href="https://twitter.com/WordPress" title="Follow @WordPress on Twitter">@WordPress</a></li>
			<li><span class="dashicons dashicons-facebook"></span><a href="https://www.facebook.com/WordPress/" title="Like WordPress on Facebook">WordPress</a></li>
		</ul>
	</div>

		<p class="cip cip-image">Code is Poetry.</p>
</div>

<script src="../../../../s.w.org/style/js/navigation.min.js?20190128"></script>

<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script type='text/javascript' src='../../../wp-includes/js/hoverintent-js.min.js?ver=2.2.1' id='hoverintent-js-js'></script>
<script type='text/javascript' src='../../../wp-includes/js/admin-bar.min.js?ver=5.9-alpha-51701' id='admin-bar-js'></script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/navigation.js?ver=20181209' id='wporg-developer-navigation-js'></script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/skip-link-focus-fix.js?ver=20130115' id='wporg-developer-skip-link-focus-fix-js'></script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/search.js?ver=20150430' id='wporg-developer-search-js'></script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/menu.js?ver=20180201' id='wporg-developer-menu-js'></script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/awesomplete.min.js?ver=20160322' id='awesomplete-js'></script>
<script type='text/javascript' id='autocomplete-js-extra'>
/* <![CDATA[ */
var autocomplete = {"ajaxurl":"https:\/\/developer.wordpress.org\/wp-admin\/admin-ajax.php","nonce":"8a60f70c4b"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/autocomplete.js?ver=20160524' id='autocomplete-js'></script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/function-reference.js?ver=20180724' id='wporg-developer-function-reference-js'></script>
<script type='text/javascript' id='quicktags-js-extra'>
/* <![CDATA[ */
var quicktagsL10n = {"closeAllOpenTags":"Close all open tags","closeTags":"close tags","enterURL":"Enter the URL","enterImageURL":"Enter the URL of the image","enterImageDescription":"Enter a description of the image","textdirection":"text direction","toggleTextdirection":"Toggle Editor Text Direction","dfw":"Distraction-free writing mode","strong":"Bold","strongClose":"Close bold tag","em":"Italic","emClose":"Close italic tag","link":"Insert link","blockquote":"Blockquote","blockquoteClose":"Close blockquote tag","del":"Deleted text (strikethrough)","delClose":"Close deleted text tag","ins":"Inserted text","insClose":"Close inserted text tag","image":"Insert image","ul":"Bulleted list","ulClose":"Close bulleted list tag","ol":"Numbered list","olClose":"Close numbered list tag","li":"List item","liClose":"Close list item tag","code":"Code","codeClose":"Close code tag","more":"Insert Read More tag"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../wp-includes/js/quicktags.min.js?ver=5.9-alpha-51701' id='quicktags-js'></script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/user-notes.js?ver=20200110' id='wporg-developer-user-notes-js'></script>
<script type='text/javascript' id='wporg-developer-user-notes-feedback-js-extra'>
/* <![CDATA[ */
var wporg_note_feedback = {"show":"Show Feedback","hide":"Hide Feedback"};
/* ]]> */
</script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/user-notes-feedback.js?ver=20181023' id='wporg-developer-user-notes-feedback-js'></script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/tabs.js?ver=20160824' id='wporg-developer-tabs-js'></script>
<script type='text/javascript' id='wporg-developer-preview-js-extra'>
/* <![CDATA[ */
var wporg_note_preview = {"ajaxurl":"https:\/\/developer.wordpress.org\/wp-admin\/admin-ajax.php","nonce":"504933b60e","preview":"preview note","preview_empty":"Nothing to preview","is_admin":""};
/* ]]> */
</script>
<script type='text/javascript' src='../../../wp-content/themes/pub/wporg-developer/js/user-notes-preview.js?ver=20200111' id='wporg-developer-preview-js'></script>
<script type='text/javascript' src='../../../wp-includes/js/wp-embed.min.js?ver=5.9-alpha-51701' id='wp-embed-js'></script>
</body>

<!-- Mirrored from developer.wordpress.org/rest-api/extending-the-rest-api/adding-custom-endpoints/ by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 31 Aug 2021 16:55:18 GMT -->
</html>

<!DOCTYPE html>

<html lang="es" prefix="og: http://ogp.me/ns#">

<!-- Mirrored from expressjs.com/es/guide/migrating-4.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 10 Jul 2019 00:23:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<title>Migraci√≥n a Express 4</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="og:image" content="../../images/express-facebook-share.png">
<link rel="icon" type="image/png" href="../../images/favicon.png" />
<link rel="stylesheet" href="../../css/style.css">
<link rel="stylesheet" href="../../css/dropit.css">
<link rel="stylesheet" href="../../css/prism.css">
<link rel="stylesheet" href="../../css/font-awesome.min.css">
<link rel="stylesheet" href="../../../fonts.googleapis.com/css2a1d.css?family=Open+Sans:300,400,600,700&amp;amp;subset=latin,latin-ext">
<link rel="stylesheet" href="../../css/es.css">
<link rel="stylesheet" href="../../css/nodeinteractive.css">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script data-cfasync="false" src="../../../ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script data-cfasync="false" src="../../js/ismobile.js"></script>
<script data-cfasync="false" src="../../js/app.js"></script>
<script data-cfasync="false" src="../../js/retina.js"></script>
<script data-cfasync="false" src="../../js/dropit.js"></script>
<script data-cfasync="false" src="../../js/prism.js"></script>
<link rel="stylesheet" href="../../../cdn.jsdelivr.net/npm/docsearch.js%402/dist/cdn/docsearch.min.css" />
</head>
<body class="non-en-doc">
<section class="page content">
<header>
<div id="mobile-menu">
<div id="nav-button" class="fa fa-bars fa-2x button"></div>
</div>
<section id="logo"><a href="../../index.html" class="express">Express</a>
</section>
<div id="navbar">
<input id="q" placeholder="üîé search">
<ul id="navmenu">
<li><a href="../index.html" id="home-menu">Inicio</a></li>
<li>
<ul id="getting-started-menu" class="menu">
<li><a href="../starter/installing.html">C√≥mo empezar</a>
<ul>
<li>
<a href="../starter/installing.html">
Instalaci√≥n
</a>
</li>
<li>
<a href="../starter/hello-world.html">
Hello world
</a>
</li>
<li>
<a href="../starter/generator.html">
Generador de Express
</a>
</li>
<li>
<a href="../starter/basic-routing.html">
Direccionamiento b√°sico
</a>
</li>
<li>
<a href="../starter/static-files.html">
Archivos est√°ticos
</a>
</li>
<li>
<a href="../starter/faq.html">
Preguntas m√°s frecuentes
</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="guide-menu" class="menu">
<li><a href="routing.html" class="active">Gu√≠a</a>
<ul>
<li><a href="routing.html">Direccionamiento</a>
</li>
<li><a href="writing-middleware.html">Escritura de middleware</a>
</li>
<li><a href="using-middleware.html">Utilizaci√≥n del middleware</a>
</li>
<li><a href="using-template-engines.html">Utilizaci√≥n de motores de plantilla</a>
</li>
<li><a href="error-handling.html">Manejo de errores</a>
</li>
<li><a href="debugging.html">Depuraci√≥n</a>
</li>
<li><a href="behind-proxies.html">Express detr√°s de proxies</a>
</li>
<li><a href="migrating-4.html">Migraci√≥n a Express 4</a>
</li>
<li><a href="migrating-5.html">Migraci√≥n a Express 5</a>
</li>
<li><a href="database-integration.html">Integraci√≥n de la base de datos</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="application-menu" class="menu">
<li><a href="../4x/api.html">Referencia de API</a>
<ul>
<li><a href="../4x/api.html">4.x</a>
</li>
<li><a href="../3x/api.html">3.x (en desuso)</a>
</li>
<li><a href="../../2x/index.html">2.x (en desuso)</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="advanced-topics-menu" class="menu">
<li><a href="../advanced/developing-template-engines.html">Temas avanzados</a>
<ul>
<li><a href="../advanced/developing-template-engines.html">Motores de plantilla</a>
</li>
<li><a href="../advanced/pm.html">Utilizaci√≥n de gestores de procesos</a>
</li>
<li><a href="../advanced/security-updates.html">Actualizaciones de seguridad</a>
</li>
<li><a href="../advanced/best-practice-security.html">Mejores pr√°cticas de seguridad</a>
</li>
<li><a href="../advanced/best-practice-performance.html">Mejores pr√°cticas de rendimiento</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="resources-menu" class="menu">
<li><a href="../resources/glossary.html">Recursos</a>
<ul>
<li><a href="../resources/glossary.html">Glosario</a>
</li>
<li><a href="../resources/middleware.html">Middleware</a>
</li>
<li><a href="../resources/community.html">Comunidad</a>
</li>
<li><a href="../resources/books-blogs.html">Manuales y blogs</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</header>
<div id="overlay"></div>
<div id="i18n-notice-box" class="doc-box doc-warn">
<p><p>Esta traducci√≥n proporcionada por <a href="http://strongloop.com/">StrongLoop / IBM</a>.</p>
Este documento puede estar desfasado respecto a la documentaci√≥n en ingl√©s. Para ver las √∫ltimas actualizaciones, consulte la <a href="../../index.html">documentaci√≥n en ingl√©s</a>.
</p>
<div id="close-i18n-notice-box" title="Close">‚úñ</div>
</div>
<div id="page-doc" markdown="1">
<h1 id="migraci√≥n-a-express-4">Migraci√≥n a Express 4</h1>
<h2 id="overview">Visi√≥n general</h2>
<p>Express 4 es un cambio que rompe el c√≥digo existente de Express 3, etc. Esto implica que una aplicaci√≥n Express 3 existente no funcionar√° si actualiza la versi√≥n de Express en sus dependencias.</p>
<p>En este art√≠culo se describen:</p>
<ul class="doclist">
<li><a href="#changes">Los cambios en Express 4.</a></li>
<li><a href="#example-migration">Un ejemplo</a> de migraci√≥n de una aplicaci√≥n Express 3 a Express 4.</li>
<li><a href="#app-gen">La actualizaci√≥n al generador de aplicaciones Express 4. </a></li>
</ul>
<h2 id="changes">Los cambios en Express 4</h2>
<p>Se han realizado varios cambios importantes en Express 4:</p>
<ul class="doclist">
<li><a href="#core-changes">Cambios en el sistema principal y de middleware de Express.</a> Las dependencias de Connect y el middleware incorporado se han eliminado, por lo que debe a√±adir el middleware manualmente.
</li>
<li><a href="#routing">Cambios en el sistema de direccionamiento.</a></li>
<li><a href="#other-changes">Otros cambios.</a></li>
</ul>
<p>Vea tambi√©n:</p>
<ul>
<li><a href="https://github.com/strongloop/express/wiki/New-features-in-4.x">Nuevas caracter√≠sticas en 4.x.</a></li>
<li><a href="https://github.com/strongloop/express/wiki/Migrating-from-3.x-to-4.x">Migraci√≥n de 3.x a 4.x.</a></li>
</ul>
<h3 id="core-changes">
Cambios en el sistema principal y de middleware de Express
</h3>
<p>Express 4 ya no depende de Connect y elimina todo el middleware incorporado de su n√∫cleo, excepto la funci√≥n <code>express.static</code>. Esto significa que ahora Express es una infraestructura web de middleware y direccionamiento independiente, y que los releases y las versiones de Express no se ven afectados por las actualizaciones de middleware.</p>
<p>Sin el middleware incorporado, debe a√±adir expl√≠citamente todo el
middleware necesario para ejecutar la aplicaci√≥n. S√≥lo tiene que seguir estos pasos:</p>
<ol>
<li>Instalar el m√≥dulo: <code>npm install --save &lt;module-name&gt;</code></li>
<li>En su aplicaci√≥n, requerir el m√≥dulo: <code>require('module-name')</code></li>
<li>Utilizar el m√≥dulo seg√∫n su documentaci√≥n: <code>app.use( ... )</code></li>
</ol>
<p>En la tabla siguiente se lista el middleware de Express 3 y su contrapartida en Express 4.</p>
<table class="doctable" border="1">
<tr><th>Express 3</th><th>Express 4</th></tr>
<tr><td><code>express.bodyParser</code></td>
<td><a href="https://github.com/expressjs/body-parser">body-parser</a> +
<a href="https://github.com/expressjs/multer">multer</a></td></tr>
<tr><td><code>express.compress</code></td>
<td><a href="https://github.com/expressjs/compression">compression</a></td></tr>
<tr><td><code>express.cookieSession</code></td>
<td><a href="https://github.com/expressjs/cookie-session">cookie-session</a></td></tr>
<tr><td><code>express.cookieParser</code></td>
<td><a href="https://github.com/expressjs/cookie-parser">cookie-parser</a></td></tr>
<tr><td><code>express.logger</code></td>
<td><a href="https://github.com/expressjs/morgan">morgan</a></td></tr>
<tr><td><code>express.session</code></td>
<td><a href="https://github.com/expressjs/session">express-session</a></td></tr>
<tr><td><code>express.favicon</code></td>
<td><a href="https://github.com/expressjs/serve-favicon">serve-favicon</a></td></tr>
<tr><td><code>express.responseTime</code></td>
<td><a href="https://github.com/expressjs/response-time">response-time</a></td></tr>
<tr><td><code>express.errorHandler</code></td>
<td><a href="https://github.com/expressjs/errorhandler">errorhandler</a></td></tr>
<tr><td><code>express.methodOverride</code></td>
<td><a href="https://github.com/expressjs/method-override">method-override</a></td></tr>
<tr><td><code>express.timeout</code></td>
<td><a href="https://github.com/expressjs/timeout">connect-timeout</a></td></tr>
<tr><td><code>express.vhost</code></td>
<td><a href="https://github.com/expressjs/vhost">vhost</a></td></tr>
<tr><td><code>express.csrf</code></td>
<td><a href="https://github.com/expressjs/csurf">csurf</a></td></tr>
<tr><td><code>express.directory</code></td>
<td><a href="https://github.com/expressjs/serve-index">serve-index</a></td></tr>
<tr><td><code>express.static</code></td>
<td><a href="https://github.com/expressjs/serve-static">serve-static</a></td></tr>
</table>
<p>Esta es la <a href="https://github.com/senchalabs/connect#middleware">lista completa</a> de middleware de Express 4.</p>
<p>En la mayor√≠a de los casos, s√≥lo tiene que sustituir el middleware de la versi√≥n 3 antigua por su contrapartida de Express 4. Para obtener detalles, consulte la documentaci√≥n del m√≥dulo en GitHub.</p>
<h4 id="app-use"><code>app.use</code> acepta par√°metros</h4>
<p>En la versi√≥n 4, puede utilizar un par√°metro de variable para definir la v√≠a de acceso donde se cargan las funciones de middleware y, a continuaci√≥n, leer el valor del par√°metro en el manejador de rutas.
Por ejemplo:</p>
<pre><code class="language-javascript" translate="no">
app.use('/book/:id', function(req, res, next) {
  console.log('ID:', req.params.id);
  next();
});
</code>
</pre>
<h3 id="routing">
El sistema de direccionamiento
</h3>
<p>Ahora las aplicaciones cargan impl√≠citamente el middleware de direccionamiento, por lo que ya no tiene que preocuparse del orden con el que se carga el middleware respecto al middleware de <code>router</code>.</p>
<p>La forma en que define las rutas no var√≠a, pero el sistema de direccionamiento tiene dos nuevas caracter√≠sticas que permiten organizar las rutas:</p>
<ul class="doclist">
<li>Un nuevo m√©todo, <code>app.route()</code>, para crear manejadores de rutas encadenables para una v√≠a de acceso de ruta.</li>
<li>Una nueva clase, <code>express.Router</code>, para crear manejadores de rutas montables modulares.</li>
</ul>
<h4 id="app-route">M√©todo <code>app.route()</code></h4>
<p>El nuevo m√©todo <code>app.route()</code> permite crear manejadores de rutas encadenables para una v√≠a de acceso de ruta. Como la v√≠a de acceso se especifica en una √∫nica ubicaci√≥n, la creaci√≥n de rutas modulares es muy √∫til, al igual que la reducci√≥n de redundancia y errores tipogr√°ficos. Para obtener m√°s informaci√≥n sobre las rutas, consulte la <a href="../4x/api.html#router"><code>documentaci√≥n</code> de Router()</a>.</p>
<p>A continuaci√≥n, se muestra un ejemplo de manejadores de rutas encadenados que se definen utilizando la funci√≥n <code>app.route()</code>.</p>
<pre><code class="language-javascript" translate="no">
app.route('/book')
  .get(function(req, res) {
    res.send('Get a random book');
  })
  .post(function(req, res) {
    res.send('Add a book');
  })
  .put(function(req, res) {
    res.send('Update the book');
  });
</code>
</pre>
<h4 id="express-router">Clase <code>express.Router</code></h4>
<p>La otra caracter√≠stica que permite organizar las rutas es una nueva clase, <code>express.Router</code>, que puede utilizar para crear manejadores de rutas montables modulares. Una instancia <code>Router</code> es un sistema de middleware y direccionamiento completo; por este motivo, a menudo se conoce como una ‚Äúminiaplicaci√≥n‚Äù.</p>
<p>El siguiente ejemplo crea un direccionador como un m√≥dulo, carga el middleware en √©l, define algunas rutas y lo monta en una v√≠a de acceso en la aplicaci√≥n principal.</p>
<p>Por ejemplo, cree un archivo de direccionador denominado <code>birds.js</code> en el directorio de la aplicaci√≥n, con el siguiente contenido:</p>
<pre><code class="language-javascript" translate="no">
var express = require('express');
var router = express.Router();

// middleware specific to this router
router.use(function timeLog(req, res, next) {
  console.log('Time: ', Date.now());
  next();
});
// define the home page route
router.get('/', function(req, res) {
  res.send('Birds home page');
});
// define the about route
router.get('/about', function(req, res) {
  res.send('About birds');
});

module.exports = router;
</code>
</pre>
<p>A continuaci√≥n, cargue el m√≥dulo de direccionador en la aplicaci√≥n:</p>
<pre><code class="language-javascript" translate="no">
var birds = require('./birds');
...
app.use('/birds', birds);
</code>
</pre>
<p>La aplicaci√≥n ahora podr√° manejar solicitudes a las v√≠as de acceso <code>/birds</code> y <code>/birds/about</code>, e invocar√° el middleware <code>timeLog</code> que es espec√≠fico de la ruta.</p>
<h3 id="other-changes">
Otros cambios
</h3>
<p>En la tabla siguiente se muestran otros cambios peque√±os pero importantes en Express 4:</p>
<table class="doctable" border="1">
<tr>
<th>Objeto</th>
<th>Descripci√≥n</th>
</tr>
<tr>
<td>Node.js</td>
<td>Express 4 requiere Node.js 0.10.x o posterior y deja de dar soporte a
Node.js 0.8.x.</td>
</tr>
<tr>
<td>
<p><code>http.createServer()</code></p>
</td>
<td>
<p>El m√≥dulo <code>http</code> ya no es necesario, a menos que necesite trabajar directamente con √©l (socket.io/SPDY/HTTPS). La aplicaci√≥n puede iniciarse utilizando la funci√≥n <code>app.listen()</code>.</p>
</td>
</tr>
<tr>
<td>
<p><code>app.configure()</code></p>
</td>
<td>
<p>La funci√≥n <code>app.configure()</code> se ha eliminado. Utilice la funci√≥n <code>process.env.NODE_ENV</code> o
<code>app.get('env')</code> para detectar el entorno y configure la aplicaci√≥n seg√∫n corresponda.</p>
</td>
</tr>
<tr>
<td>
<p><code>json spaces</code></p>
</td>
<td>
<p>La propiedad de aplicaci√≥n <code>json spaces</code> est√° inhabilitada de forma predeterminada en Express 4.</p>
</td>
</tr>
<tr>
<td>
<p><code>req.accepted()</code></p>
</td>
<td>
<p>Utilice <code>req.accepts()</code>, <code>req.acceptsEncodings()</code>,
<code>req.acceptsCharsets()</code> y <code>req.acceptsLanguages()</code>.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.location()</code></p>
</td>
<td>
<p>Ya no resuelve los URL relativos.</p>
</td>
</tr>
<tr>
<td>
<p><code>req.params</code></p>
</td>
<td>
<p>Era una matriz, ahora es un objeto.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.locals</code></p>
</td>
<td>
<p>Era una funci√≥n, ahora es un objeto.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.headerSent</code></p>
</td>
<td>
<p>Se ha cambiado por <code>res.headersSent</code>.</p>
</td>
</tr>
<tr>
<td>
<p><code>app.route</code></p>
</td>
<td>
<p>Ahora est√° disponible como <code>app.mountpath</code>.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.on('header')</code></p>
</td>
<td>
<p>Se ha eliminado.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.charset</code></p>
</td>
<td>
<p>Se ha eliminado.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.setHeader('Set-Cookie', val)</code></p>
</td>
<td>
<p>La funcionalidad est√° ahora limitada a establecer el valor de cookie b√°sico. Utilice <code>res.cookie()</code> para obtener la funcionalidad adicional.</p>
</td>
</tr>
</table>
<h2 id="example-migration">Migraci√≥n de aplicaci√≥n de ejemplo</h2>
<p>A continuaci√≥n, se muestra un ejemplo de migraci√≥n de una aplicaci√≥n Express 3 a Express 4.
Los archivos de inter√©s son <code>app.js</code> y <code>package.json</code>.</p>
<h3>
Aplicaci√≥n versi√≥n 3
</h3>
<h4><code>app.js</code></h4>
<p>Considere una aplicaci√≥n Express v.3 con el siguiente archivo <code>app.js</code>:</p>
<pre><code class="language-javascript" translate="no">
var express = require('express');
var routes = require('./routes');
var user = require('./routes/user');
var http = require('http');
var path = require('path');

var app = express();

// all environments
app.set('port', process.env.PORT || 3000);
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'pug');
app.use(express.favicon());
app.use(express.logger('dev'));
app.use(express.methodOverride());
app.use(express.session({ secret: 'your secret here' }));
app.use(express.bodyParser());
app.use(app.router);
app.use(express.static(path.join(__dirname, 'public')));

// development only
if ('development' == app.get('env')) {
  app.use(express.errorHandler());
}

app.get('/', routes.index);
app.get('/users', user.list);

http.createServer(app).listen(app.get('port'), function(){
  console.log('Express server listening on port ' + app.get('port'));
});
</code>
</pre>
<h4><code>package.json</code></h4>
<p>El archivo <code>package.json</code> de la versi√≥n 3 correspondiente ser√° similar al siguiente:</p>
<pre><code class="language-javascript" translate="no">
{
  "name": "application-name",
  "version": "0.0.1",
  "private": true,
  "scripts": {
    "start": "node app.js"
  },
  "dependencies": {
    "express": "3.12.0",
    "pug": "*"
  }
}
</code>
</pre>
<h3>
Proceso
</h3>
<p>Para empezar el proceso de migraci√≥n, instale el middleware necesario para la aplicaci√≥n Express 4 y actualice Express y Pug a su versi√≥n respectiva m√°s reciente con el siguiente mandato:</p>
<pre><code class="language-sh" translate="no">
$ npm install serve-favicon morgan method-override express-session body-parser multer errorhandler express@latest pug@latest --save
</code>
</pre>
<p>Realice los cambios siguientes en <code>app.js</code>:</p>
<ol>
<li>
<p>Las funciones de middleware de Express incorporadas <code>express.favicon</code>,
<code>express.logger</code>, <code>express.methodOverride</code>,
<code>express.session</code>, <code>express.bodyParser</code> y
<code>express.errorHandler</code> ya no est√°n disponibles en el objeto <code>express</code>. Debe instalar sus alternativas manualmente y cargarlas en la aplicaci√≥n.</p>
</li>
<li>
<p>Ya no es necesario cargar la funci√≥n <code>app.router</code>.
No es un objeto de aplicaci√≥n Express 4 v√°lido, por lo que debe eliminar el c√≥digo <code>app.use(app.router);</code>.</p>
</li>
<li>
<p>Aseg√∫rese de que las funciones de middleware se cargan en el orden correcto: cargue <code>errorHandler</code> despu√©s de cargar las rutas de aplicaci√≥n.</p>
</li>
</ol>
<h3>Aplicaci√≥n versi√≥n 4</h3>
<h4><code>package.json</code></h4>
<p>La ejecuci√≥n del mandato <code>npm</code> anterior actualizar√° <code>package.json</code> de la siguiente manera:</p>
<pre><code class="language-javascript" translate="no">
{
  "name": "application-name",
  "version": "0.0.1",
  "private": true,
  "scripts": {
    "start": "node app.js"
  },
  "dependencies": {
    "body-parser": "^1.5.2",
    "errorhandler": "^1.1.1",
    "express": "^4.8.0",
    "express-session": "^1.7.2",
    "pug": "2.0.0-beta6",
    "method-override": "^2.1.2",
    "morgan": "^1.2.2",
    "multer": "^0.1.3",
    "serve-favicon": "^2.0.1"
  }
}
</code>
</pre>
<h4><code>app.js</code></h4>
<p>A continuaci√≥n, elimine el c√≥digo no v√°lido, cargue el middleware necesario y realice otros cambios seg√∫n sea necesario. El archivo <code>app.js</code> ser√° parecido al siguiente:</p>
<pre><code class="language-javascript" translate="no">
var http = require('http');
var express = require('express');
var routes = require('./routes');
var user = require('./routes/user');
var path = require('path');

var favicon = require('serve-favicon');
var logger = require('morgan');
var methodOverride = require('method-override');
var session = require('express-session');
var bodyParser = require('body-parser');
var multer = require('multer');
var errorHandler = require('errorhandler');

var app = express();

// all environments
app.set('port', process.env.PORT || 3000);
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'pug');
app.use(favicon(__dirname + '/public/favicon.ico'));
app.use(logger('dev'));
app.use(methodOverride());
app.use(session({ resave: true,
                  saveUninitialized: true,
                  secret: 'uwotm8' }));
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));
app.use(multer());
app.use(express.static(path.join(__dirname, 'public')));

app.get('/', routes.index);
app.get('/users', user.list);

// error handling middleware should be loaded after the loading the routes
if ('development' == app.get('env')) {
  app.use(errorHandler());
}

var server = http.createServer(app);
server.listen(app.get('port'), function(){
  console.log('Express server listening on port ' + app.get('port'));
});
</code>
</pre>
<div class="doc-box doc-info">
<p>A menos que necesite trabajar directamente con el m√≥dulo <code>http</code> (socket.io/SPDY/HTTPS), no es necesario cargarlo y la aplicaci√≥n puede iniciarse simplemente de la siguiente manera:</p>
<pre><code class="language-js" translate="no">app.listen(app.get('port'), function(){
  console.log('Express server listening on port ' + app.get('port'));
});</code>
</pre>
</div>
<h3>Ejecutar la aplicaci√≥n</h3>
<p>El proceso de migraci√≥n est√° completo y la aplicaci√≥n es ahora una aplicaci√≥n
Express 4. Para confirmarlo, inicie la aplicaci√≥n utilizando el siguiente mandato:</p>
<pre><code class="language-sh" translate="no">
$ node .
</code>
</pre>
<p>Cargue <a href="http://localhost:3000/">http://localhost:3000</a> y vea la p√°gina de inicio que representa Express 4.</p>
<h2 id="app-gen">La actualizaci√≥n al generador de aplicaciones Express 4</h2>
<p>La herramienta de l√≠nea de mandatos para generar una aplicaci√≥n Express contin√∫a siendo <code>express</code>, pero para actualizar a la nueva versi√≥n, debe desinstalar el generador de aplicaciones Express 3 e instalar el nuevo <code>express-generator</code>.</p>
<h3>Instalaci√≥n </h3>
<p>Si ya ha instalado el generador de aplicaciones Express 3 en el sistema, debe desinstalarlo:</p>
<pre><code class="language-sh" translate="no">
$ npm uninstall -g express
</code>
</pre>
<p>Dependiendo de c√≥mo se configuren los privilegios de archivos y directorios, deber√° ejecutar este mandato con <code>sudo</code>.</p>
<p>A continuaci√≥n, instale el nuevo generador:</p>
<pre><code class="language-sh" translate="no">
$ npm install -g express-generator
</code>
</pre>
<p>Dependiendo de c√≥mo se configuren los privilegios de archivos y directorios, deber√° ejecutar este mandato con <code>sudo</code>.</p>
<p>Ahora el mandato <code>express</code> en el sistema se actualiza al generador de Express 4.</p>
<h3>Cambios en el generador de aplicaciones </h3>
<p>Las opciones de mandato y el uso contin√∫an pr√°cticamente iguales, con las siguientes excepciones:</p>
<ul class="doclist">
<li>Se ha eliminado la opci√≥n <code>--sessions</code>.</li>
<li>Se ha eliminado la opci√≥n <code>--jshtml</code>.</li>
<li>Se ha a√±adido la opci√≥n <code>--hogan</code> para dar soporte a <a href="http://twitter.github.io/hogan.js/">Hogan.js</a>.</li>
</ul>
<h3>Ejemplo</h3>
<p>Ejecute el siguiente mandato para crear una aplicaci√≥n Express 4:</p>
<pre><code class="language-sh" translate="no">
$ express app4
</code>
</pre>
<p>Si consulta el contenido del archivo <code>app4/app.js</code>, observar√° que todas las funciones de middleware (excepto <code>express.static</code>) que son necesarias para la aplicaci√≥n se cargan como m√≥dulos independientes y que el middleware de <code>router</code> ya no se carga de forma expl√≠cita en la aplicaci√≥n.</p>
<p>Tambi√©n observar√° que el archivo <code>app.js</code> es ahora un m√≥dulo Node.js, a diferencia de la aplicaci√≥n aut√≥noma que generaba el antiguo generador.</p>
<p>Despu√©s de instalar las dependencias, inicie la aplicaci√≥n utilizando el siguiente mandato:</p>
<pre><code class="language-sh" translate="no">
$ npm start
</code>
</pre>
<p>Si consulta el script de inicio npm en el archivo <code>package.json</code>, observar√° que el mandato que inicia la aplicaci√≥n es <code>node ./bin/www</code>, que antes era <code>node app.js</code> en Express 3.</p>
<p>Como el archivo <code>app.js</code> que generaba el generador de Express 4 ahora es un m√≥dulo Node.js, ya no puede iniciarse independientemente como una aplicaci√≥n (a menos que modifique el c√≥digo). El m√≥dulo debe cargarse en un archivo Node.js e iniciarse utilizando el archivo Node.js. El archivo Node.js es <code>./bin/www</code> en este caso.</p>
<p>Ni el directorio <code>bin</code> ni el archivo <code>www</code>
sin extensi√≥n son obligatorios para crear una aplicaci√≥n Express o iniciar la aplicaci√≥n. Son s√≥lo sugerencias realizadas por el generador, por lo que puede modificarlos seg√∫n sus necesidades.</p>
<p>Para eliminar el directorio <code>www</code> y dejarlo todo como en ‚ÄúExpress 3‚Äù,
suprima la l√≠nea <code>module.exports = app;</code> al final del archivo <code>app.js</code> y pegue el siguiente c√≥digo en su lugar:</p>
<pre><code class="language-javascript" translate="no">
app.set('port', process.env.PORT || 3000);

var server = app.listen(app.get('port'), function() {
  debug('Express server listening on port ' + server.address().port);
});
</code>
</pre>
<p>Aseg√∫rese de cargar el m√≥dulo <code>debug</code> encima del archivo <code>app.js</code> utilizando el c√≥digo siguiente:</p>
<pre><code class="language-javascript" translate="no">
var debug = require('debug')('app4');
</code>
</pre>
<p>A continuaci√≥n, cambie <code>"start": "node ./bin/www"</code> en el archivo <code>package.json</code> por <code>"start": "node app.js"</code>.</p>
<p>Ahora ha devuelto la funcionalidad de <code>./bin/www</code> a <code>app.js</code>. Este cambio no se recomienda, pero el ejercicio permite entender c√≥mo funciona el archivo <code>./bin/www</code> y por qu√© el archivo <code>app.js</code> ya no se inicia solo.</p>
</div>
</section>

<noscript>
    <iframe src="http://www.googletagmanager.com/ns.html?id=GTM-5XL76H" height="0" width="0" style="display: none; visibility: hidden;"></iframe>
</noscript>
<script type="110ea6095256d02f2e667f0f-text/javascript">
(function(w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({
        'gtm.start': new Date().getTime(),
        event: 'gtm.js'
    });
    var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != 'dataLayer' ? '&l=' + l : '';
    j.async = true;
    j.src =
        '../../../www.googletagmanager.com/gtm5445.js?id=' + i + dl;
    f.parentNode.insertBefore(j, f);
})(window, document, 'script', 'dataLayer', 'GTM-5XL76H');
</script>
<a id="top" href="#"><img src="../../images/arrow.png"></a>
<footer>
<div id="footer-content">
<div id="github">
<iframe src="http://ghbtns.com/github-btn.html?user=expressjs&amp;repo=express&amp;type=watch&amp;count=true" allowtransparency="true" frameborder="0" scrolling="0" width="110" height="20"></iframe>
</div>
<div id="sponsor"><a href="https://github.com/expressjs/express">Express</a> es un proyecto de la Fundaci√≥n Node.js.</div>
<div id="fork"><a href="https://github.com/expressjs/expressjs.com">Bifurque el sitio web en GitHub</a>.
</div>
<div>Copyright &copy; StrongLoop, Inc. y otros colaboradores de expressjs.com.</div>
</div>
<div id="license">
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/"><img alt="Licencia Creative Commons" style="border-width:0" src="../../../i.creativecommons.org/l/by-sa/3.0/us/80x15.png" /></a> Esta obra est√° bajo una <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/">Licencia Creative Commons Atribuci√≥n-CompartirIgual 3.0 Estados Unidos de Am√©rica</a>.
</div>
</footer>
<script type="110ea6095256d02f2e667f0f-text/javascript" src="../../../cdn.jsdelivr.net/npm/docsearch.js%402/dist/cdn/docsearch.min.js" onload="docsearch({
  apiKey: '7164e33055faa6ecddefd9e08fc59f5d',
  indexName: 'expressjs',
  inputSelector: '#q',
  algoliaOptions: { 'facetFilters': ['lang:es'] }
})" async></script>
<script src="../../../ajax.cloudflare.com/cdn-cgi/scripts/a2bd7673/cloudflare-static/rocket-loader.min.js" data-cf-settings="110ea6095256d02f2e667f0f-|49" defer=""></script></body>

<!-- Mirrored from expressjs.com/es/guide/migrating-4.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 10 Jul 2019 00:23:47 GMT -->
</html>

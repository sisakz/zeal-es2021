<!DOCTYPE html>

<html lang="sk" prefix="og: http://ogp.me/ns#">

<!-- Mirrored from expressjs.com/sk/guide/migrating-4.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 10 Jul 2019 00:23:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<title>Prechod na Express 4</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="og:image" content="../../images/express-facebook-share.png">
<link rel="icon" type="image/png" href="../../images/favicon.png" />
<link rel="stylesheet" href="../../css/style.css">
<link rel="stylesheet" href="../../css/dropit.css">
<link rel="stylesheet" href="../../css/prism.css">
<link rel="stylesheet" href="../../css/font-awesome.min.css">
<link rel="stylesheet" href="../../../fonts.googleapis.com/css2a1d.css?family=Open+Sans:300,400,600,700&amp;amp;subset=latin,latin-ext">
<link rel="stylesheet" href="../../css/sk.css">
<link rel="stylesheet" href="../../css/nodeinteractive.css">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script data-cfasync="false" src="../../../ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script data-cfasync="false" src="../../js/ismobile.js"></script>
<script data-cfasync="false" src="../../js/app.js"></script>
<script data-cfasync="false" src="../../js/retina.js"></script>
<script data-cfasync="false" src="../../js/dropit.js"></script>
<script data-cfasync="false" src="../../js/prism.js"></script>
<link rel="stylesheet" href="../../../cdn.jsdelivr.net/npm/docsearch.js%402/dist/cdn/docsearch.min.css" />
</head>
<body class="non-en-doc">
<section class="page content">
<header>
<div id="mobile-menu">
<div id="nav-button" class="fa fa-bars fa-2x button"></div>
</div>
<section id="logo"><a href="../../index.html" class="express">Express</a>
</section>
<div id="navbar">
<input id="q" placeholder="üîé search">
<ul id="navmenu">
<li><a href="../index.html" id="home-menu">Domov</a></li>
<li>
<ul id="getting-started-menu" class="menu">
<li><a href="../starter/installing.html">Zaƒç√≠name</a>
<ul>
<li>
<a href="../starter/installing.html">
In≈°tal√°cia
</a>
</li>
<li>
<a href="../starter/hello-world.html">
Hello world
</a>
</li>
<li>
<a href="../starter/generator.html">
Express gener√°tor
</a>
</li>
<li>
<a href="../starter/basic-routing.html">
Z√°kladn√Ω routing
</a>
</li>
<li>
<a href="../starter/static-files.html">
Statick√© s√∫bory
</a>
</li>
<li>
<a href="../starter/faq.html">
FAQ
</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="guide-menu" class="menu">
<li><a href="routing.html" class="active">Pr√≠ruƒçka</a>
<ul>
<li><a href="routing.html">Routing</a>
</li>
<li><a href="writing-middleware.html">Tvorba middleware</a>
</li>
<li><a href="using-middleware.html">Pou≈æitie middleware</a>
</li>
<li><a href="using-template-engines.html">Pou≈æitie template enginov</a>
</li>
<li><a href="error-handling.html">Error handling</a>
</li>
<li><a href="debugging.html">Debuggovanie</a>
</li>
<li><a href="behind-proxies.html">Pou≈æitie Express za proxy</a>
</li>
<li><a href="migrating-4.html">Prechod na Express 4</a>
</li>
<li><a href="migrating-5.html">Prechod na Express 5</a>
</li>
<li><a href="database-integration.html">Integr√°cia s datab√°zou</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="application-menu" class="menu">
<li><a href="../4x/api.html">API referenƒçn√° pr√≠ruƒçka</a>
<ul>
<li><a href="../4x/api.html">4.x</a>
</li>
<li><a href="../3x/api.html">3.x (zastaral√©)</a>
</li>
<li><a href="../../2x/index.html">2.x (zastaral√©)</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="advanced-topics-menu" class="menu">
<li><a href="../advanced/developing-template-engines.html">Pokroƒçil√© t√©my</a>
<ul>
<li><a href="../advanced/developing-template-engines.html">Templatovacie enginy</a>
</li>
<li><a href="../advanced/pm.html">Pou≈æitie spr√°vcov procesov</a>
</li>
<li><a href="../advanced/security-updates.html">Security - aktualiz√°cie</a>
</li>
<li><a href="../advanced/best-practice-security.html">Security - osvedƒçen√© postupy</a>
</li>
<li><a href="../advanced/best-practice-performance.html">V√Ωkonnos≈• - osvedƒçen√© postupy</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="resources-menu" class="menu">
<li><a href="../resources/glossary.html">Zdroje</a>
<ul>
<li><a href="../resources/glossary.html">Glos√°r</a>
</li>
<li><a href="../resources/middleware.html">Middleware</a>
</li>
<li><a href="../resources/community.html">Komunita</a>
</li>
<li><a href="../resources/frameworks.html">Frameworky</a>
</li>
<li><a href="../resources/books-blogs.html">Knihy a blogy</a>
</li>
<li><a href="../resources/companies-using-express.html">Firmy pou≈æ√≠vaj√∫ce Express</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</header>
<div id="overlay"></div>
<div id="i18n-notice-box" class="doc-box doc-warn">
<p>Tento dokument m√¥≈æe by≈• v porovnan√≠ s dokument√°ciou v angliƒçtine zastaral√Ω. Aktu√°lne inform√°cie n√°jdete v <a href="../../index.html">dokument√°cii v angliƒçtine</a>.
</p>
<div id="close-i18n-notice-box" title="Close">‚úñ</div>
</div>
<div id="page-doc" markdown="1">

<h1 id="prechod-na-express-4">Prechod na Express 4</h1>
<h2 id="overview">Overview</h2>
<p>Express 4 prin√°≈°a zlomov√© zmeny oproti Express 3. To znamen√°, ≈æe existuj√∫ce Express 3 aplik√°cie nebud√∫ fungova≈• po update verzie Express a jej dependenci√≠.</p>
<p>Tento ƒçl√°nok pokr√Ωva:</p>
<ul class="doclist">
<li><a href="#changes">Zmeny v Express 4.</a></li>
<li><a href="#example-migration">Pr√≠klad</a> migr√°cie Express 3 aplik√°cie na Express 4.</li>
<li><a href="#app-gen">Prechod na Express 4 app gener√°tor.</a></li>
</ul>
<h2 id="changes">Zmeny v Express 4</h2>
<p>Express 4 prin√°≈°a niekoƒ∫ko podstatn√Ωch zmien:</p>
<ul class="doclist">
<li><a href="#core-changes">Zmeny Express jadra a middleware syst√©mu.</a> Boli odstr√°nen√© z√°vislosti na Connect module a vstavan√Ωch middleware-och, tak≈æe ich budete musie≈• prida≈• sami.
</li>
<li><a href="#routing">Zmeny v routing syst√©me.</a></li>
<li><a href="#other-changes">ƒéal≈°ie r√¥zne zmeny.</a></li>
</ul>
<p>Pozrite sa taktie≈æ na:</p>
<ul>
<li><a href="https://github.com/strongloop/express/wiki/New-features-in-4.x">New features in 4.x.</a></li>
<li><a href="https://github.com/strongloop/express/wiki/Migrating-from-3.x-to-4.x">Migrating from 3.x to 4.x.</a></li>
</ul>
<h3 id="core-changes">
Zmeny Express jadra a middleware syst√©mu
</h3>
<p>Express 4 u≈æ nie je z√°visl√Ω na Connect a z jeho jadra boli odstr√°nen√© v≈°etky vstavan√© middleware funkcie, okrem <code>express.static</code> funkcie. To znamen√°, ≈æe Express je teraz nez√°visl√Ωm routing a middleware webov√Ωm frameworkom a taktie≈æ verzionovanie Express a jeho releasy nie s√∫ ovplyvnen√© updatami middlewarov.</p>
<p>Terazm bez vstavan√Ωch middlewarov, mus√≠te explicitne prida≈• v≈°etky middleware funkcie, ktor√© va≈°a aplik√°cia potrebuje k svojmu fungovaniu. Jednoducho pokraƒçujte podƒæa nasleduj√∫cich krokov:</p>
<ol>
<li>Nain≈°talujte po≈æadovan√Ω modul: <code>npm install --save &lt;module-name&gt;</code></li>
<li>Pridajte vo va≈°ej aplik√°cii require na dan√Ω modul: <code>require('module-name')</code></li>
<li>Pou≈æite modul podƒæa jeho dokument√°cie: <code>app.use( ... )</code></li>
</ol>
<p>Nasleduj√∫ca tabuƒæka obsahuje zoznam Express 3 middlewarov a ich varianty v Express 4.</p>
<table class="doctable" border="1">
<tr><th>Express 3</th><th>Express 4</th></tr>
<tr><td><code>express.bodyParser</code></td>
<td><a href="https://github.com/expressjs/body-parser">body-parser</a> +
<a href="https://github.com/expressjs/multer">multer</a></td></tr>
<tr><td><code>express.compress</code></td>
<td><a href="https://github.com/expressjs/compression">compression</a></td></tr>
<tr><td><code>express.cookieSession</code></td>
<td><a href="https://github.com/expressjs/cookie-session">cookie-session</a></td></tr>
<tr><td><code>express.cookieParser</code></td>
<td><a href="https://github.com/expressjs/cookie-parser">cookie-parser</a></td></tr>
<tr><td><code>express.logger</code></td>
<td><a href="https://github.com/expressjs/morgan">morgan</a></td></tr>
<tr><td><code>express.session</code></td>
<td><a href="https://github.com/expressjs/session">express-session</a></td></tr>
<tr><td><code>express.favicon</code></td>
<td><a href="https://github.com/expressjs/serve-favicon">serve-favicon</a></td></tr>
<tr><td><code>express.responseTime</code></td>
<td><a href="https://github.com/expressjs/response-time">response-time</a></td></tr>
<tr><td><code>express.errorHandler</code></td>
<td><a href="https://github.com/expressjs/errorhandler">errorhandler</a></td></tr>
<tr><td><code>express.methodOverride</code></td>
<td><a href="https://github.com/expressjs/method-override">method-override</a></td></tr>
<tr><td><code>express.timeout</code></td>
<td><a href="https://github.com/expressjs/timeout">connect-timeout</a></td></tr>
<tr><td><code>express.vhost</code></td>
<td><a href="https://github.com/expressjs/vhost">vhost</a></td></tr>
<tr><td><code>express.csrf</code></td>
<td><a href="https://github.com/expressjs/csurf">csurf</a></td></tr>
<tr><td><code>express.directory</code></td>
<td><a href="https://github.com/expressjs/serve-index">serve-index</a></td></tr>
<tr><td><code>express.static</code></td>
<td><a href="https://github.com/expressjs/serve-static">serve-static</a></td></tr>
</table>
<p>Tu je <a href="https://github.com/senchalabs/connect#middleware">kompletn√Ω zoznam</a> Express 4 middlewarov.</p>
<p>Vo v√§ƒç≈°ine pr√≠padov m√¥≈æete jednoducho nahradi≈• star√Ω Express 3 middleware jeho Express 4 variantou. Pre viac inform√°ci√≠ si pozrite dokument√°ciu dan√©ho modulu na Github-e.</p>
<h4 id="app-use"><code>app.use</code> pr√≠jma parameter</h4>
<p>Vo verzii 4 m√¥≈æete pou≈æi≈• voliteƒæn√Ω parameter k definovaniu path-u, kedy sa m√° middleware funkcia naƒç√≠ta≈• a n√°sledne preƒç√≠ta≈• hodnotu parametra z route handlera.
Napr.:</p>
<pre><code class="language-javascript" translate="no">
app.use('/book/:id', function(req, res, next) {
  console.log('ID:', req.params.id);
  next();
});
</code>
</pre>
<h3 id="routing">
Routing syst√©m
</h3>
<p>Aplik√°cia odteraz explicitne naƒç√≠ta routing middleware, tak≈æe u≈æ sa viac nemus√≠te stara≈• o to, v akom porad√≠ bude ktor√Ω middleware naƒç√≠tan√Ω s ohƒæadom na <code>router</code> middleware.</p>
<p>Sp√¥sob, ak√Ωm definujete route sa nezmenil, ale samotn√Ω routing syst√©m m√° dve nov√© features k jeho lep≈°ej organiz√°cii:</p>
<ul class="doclist">
<li>Nov√° met√≥da, <code>app.route()</code> sl√∫≈æi na vytvorenie zre≈•aziteƒæn√Ωch route handlerov pre dan√Ω route path (cestu).</li>
<li>Nov√° trieda, <code>express.Router</code>, sl√∫≈æi na vytvorenie modul√°rnych, pripojiteƒæn√Ωch route handlerov.</li>
</ul>
<h4 id="app-route"><code>app.route()</code> met√≥da</h4>
<p>Nov√° met√≥da <code>app.route()</code> v√°m umo≈æ≈àuje vytv√°ra≈• zre≈•aziteƒæn√© route handlery pre dan√Ω route path (cestu). Preto≈æe je path (cesta) ≈°pecifikovan√Ω na jednom mieste, tvorba tak√Ωchto modul√°rnych routes je u≈æitoƒçn√°, ked≈æe zni≈æuje redundanciu a mo≈æn√© preklepy. Pre viac inform√°ci√≠ ohƒæadom route sa pozrite na <a href="../4x/api.html#router"><code>Router()</code> dokument√°ciu</a>.</p>
<p>Tu je pr√≠klad zre≈•azen√Ωch route handlerov definovan√Ωch pomocou <code>app.route()</code> funkcie.</p>
<pre><code class="language-javascript" translate="no">
app.route('/book')
  .get(function(req, res) {
    res.send('Get a random book');
  })
  .post(function(req, res) {
    res.send('Add a book');
  })
  .put(function(req, res) {
    res.send('Update the book');
  });
</code>
</pre>
<h4 id="express-router"><code>express.Router</code> trieda</h4>
<p>ƒéal≈°ou novou feature, ktor√° napom√°ha k lep≈°ej organiz√°cii routes, je nov√° trieda <code>express.Router</code>, ktor√∫ m√¥≈æete pou≈æi≈• k tvorbe modul√°rnych, pripojiteƒæn√Ωch route handlerov. <code>Router</code> in≈°tancia je kompletn√Ω middleware routing syst√©m; z tohto d√¥vodu je ƒçasto oznaƒçovan√° aj ako ‚Äúmini-app‚Äù.</p>
<p>Nasleduj√∫ci pr√≠klad vytv√°ra router ako modul, naƒç√≠tava v ≈àom middleware, definuje niekoƒæko routes a prip√°ja tento router na path v hlavnej aplik√°cii.</p>
<p>Napr., vytvorte v prieƒçinku va≈°ej aplik√°cie router s√∫bor s n√°zvom <code>birds.js</code> s tak√Ωmto obsahom:</p>
<pre><code class="language-javascript" translate="no">
var express = require('express');
var router = express.Router();

// middleware specific to this router
router.use(function timeLog(req, res, next) {
  console.log('Time: ', Date.now());
  next();
});
// define the home page route
router.get('/', function(req, res) {
  res.send('Birds home page');
});
// define the about route
router.get('/about', function(req, res) {
  res.send('About birds');
});

module.exports = router;
</code>
</pre>
<p>Potom tento router naƒç√≠tajte vo va≈°ej aplik√°cii:</p>
<pre><code class="language-javascript" translate="no">
var birds = require('./birds');
...
app.use('/birds', birds);
</code>
</pre>
<p>Aplik√°cia bude odteraz schopn√° obsl√∫≈æi≈• requesty na path-och <code>/birds</code> a
<code>/birds/about</code> a zavol√° <code>timeLog</code> middleware, ktor√Ω je ≈°pecifick√Ω pre tento route.</p>
<h3 id="other-changes">
Ostatn√© zmeny
</h3>
<p>Nasleduj√∫ca tabuƒæka obsahuje zoznam drobn√Ωch, ale d√¥le≈æit√Ωch zmien v Express 4:</p>
<table class="doctable" border="1">
<tr>
<th>Objekt</th>
<th>Popis</th>
</tr>
<tr>
<td>Node.js</td>
<td>Express 4 si vy≈æaduje Node.js 0.10.x a vy≈°≈°√≠ a u≈æ nepodporuje Node.js 0.8.x.</td>
</tr>
<tr>
<td>
<p><code>http.createServer()</code></p>
</td>
<td>
<p><code>http</code> modul u≈æ nie je potrebn√Ω, pokiaƒæ s n√≠m nepotrebujete priamo pracova≈• (socket.io/SPDY/HTTPS). Aplik√°ciu dok√°≈æete na≈°tartova≈• pomocou <code>app.listen()</code> funkcie.</p>
</td>
</tr>
<tr>
<td>
<p><code>app.configure()</code></p>
</td>
<td>
<p>Funkcia <code>app.configure()</code> bola odstr√°nen√°. Pre detekciu environment nastaven√≠ a nastavenia aplik√°cie pou≈æite <code>process.env.NODE_ENV</code> alebo funkciu
<code>app.get('env')</code>.</p>
</td>
</tr>
<tr>
<td>
<p><code>json spaces</code></p>
</td>
<td>
<p>Aplikaƒçn√° property <code>json spaces</code> je defaultne v Express 4 vypnut√°.</p>
</td>
</tr>
<tr>
<td>
<p><code>req.accepted()</code></p>
</td>
<td>
<p>Pou≈æ√≠vajte <code>req.accepts()</code>, <code>req.acceptsEncodings()</code>,
<code>req.acceptsCharsets()</code> a <code>req.acceptsLanguages()</code>.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.location()</code></p>
</td>
<td>
<p>U≈æ viac nevyhodnocuje relat√≠vne URLky.</p>
</td>
</tr>
<tr>
<td>
<p><code>req.params</code></p>
</td>
<td>
<p>Bolo p√¥vodne pole, teraz je objektom.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.locals</code></p>
</td>
<td>
<p>Bola p√¥vodne funkcia, teraz je objekt.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.headerSent</code></p>
</td>
<td>
<p>Zmenen√° na <code>res.headersSent</code>.</p>
</td>
</tr>
<tr>
<td>
<p><code>app.route</code></p>
</td>
<td>
<p>Teraz dostupn√° ako <code>app.mountpath</code>.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.on('header')</code></p>
</td>
<td>
<p>Zmazan√©.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.charset</code></p>
</td>
<td>
<p>Zmazan√©.</p>
</td>
</tr>
<tr>
<td>
<p><code>res.setHeader('Set-Cookie', val)</code></p>
</td>
<td>
<p>Funkcionalita je odteraz obmedzen√° na nastavenie z√°kladnej hodnoty cookie. Pre pridan√∫ funkcionalitu pou≈æ√≠vajte <code>res.cookie()</code>.</p>
</td>
</tr>
</table>
<h2 id="example-migration">Pr√≠klad migr√°cie aplik√°cie</h2>
<p>Tu je pr√≠klad migr√°cie Express 3 aplik√°cie na Express 4.
S√∫bory, ktor√© v√°s m√¥≈æu zauj√≠ma≈• s√∫ <code>app.js</code> a <code>package.json</code>.</p>
<h3>
Applik√°cia vo verzii 3
</h3>
<h4><code>app.js</code></h4>
<p>Majme tak√∫to Express v.3 aplik√°ciu s tak√Ωmto <code>app.js</code> s√∫borom:</p>
<pre><code class="language-javascript" translate="no">
var express = require('express');
var routes = require('./routes');
var user = require('./routes/user');
var http = require('http');
var path = require('path');

var app = express();

// all environments
app.set('port', process.env.PORT || 3000);
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'pug');
app.use(express.favicon());
app.use(express.logger('dev'));
app.use(express.methodOverride());
app.use(express.session({ secret: 'your secret here' }));
app.use(express.bodyParser());
app.use(app.router);
app.use(express.static(path.join(__dirname, 'public')));

// development only
if ('development' == app.get('env')) {
  app.use(express.errorHandler());
}

app.get('/', routes.index);
app.get('/users', user.list);

http.createServer(app).listen(app.get('port'), function(){
  console.log('Express server listening on port ' + app.get('port'));
});
</code>
</pre>
<h4><code>package.json</code></h4>
<p>Sprievodn√Ω <code>package.json</code> pre verziu 3 by vyzeral nejak takto:</p>
<pre><code class="language-javascript" translate="no">
{
  "name": "application-name",
  "version": "0.0.1",
  "private": true,
  "scripts": {
    "start": "node app.js"
  },
  "dependencies": {
    "express": "3.12.0",
    "pug": "*"
  }
}
</code>
</pre>
<h3>
Proces
</h3>
<p>Proces migr√°cie zaƒçnite nain≈°talovan√≠m v≈°etk√Ωch potrebn√Ωch middlewarov pre va≈°u Express 4 aplik√°ciu a updatom Express a Pug na ich prisl√∫chaj√∫ce najnov≈°ie verzie nasleduj√∫cim pr√≠kazom:</p>
<pre><code class="language-sh" translate="no">
$ npm install serve-favicon morgan method-override express-session body-parser multer errorhandler express@latest pug@latest --save
</code>
</pre>
<p>V <code>app.js</code> vykonajte tieto zmeny:</p>
<ol>
<li>
<p>Vstavan√© Express middleware funkcie <code>express.favicon</code>,
<code>express.logger</code>, <code>express.methodOverride</code>,
<code>express.session</code>, <code>express.bodyParser</code> a
<code>express.errorHandler</code> u≈æ nie s√∫ dostupn√© na
<code>express</code> objekte. Mus√≠te nain≈°talova≈• a naƒç√≠ta≈• ich prisl√∫chaj√∫ce alternat√≠vy v aplik√°cii manu√°lne.</p>
</li>
<li>
<p>U≈æ viac nepotrebujete naƒç√≠ta≈• <code>app.router</code> funkciu.
Nieje validn√Ωm Express 4 app objektom, preto zma≈æte nasleduj√∫ci k√≥d
<code>app.use(app.router);</code>.</p>
</li>
<li>
<p>Uistite sa, ≈æe middleware funkcie s√∫ naƒç√≠tan√© v spr√°vnom porad√≠ - naƒç√≠tajte <code>errorHandler</code> a≈æ po naƒç√≠tan√≠ app routes.</p>
</li>
</ol>
<h3>Aplik√°cia vo verzii 4</h3>
<h4><code>package.json</code></h4>
<p>Spusten√≠m k√≥du vy≈°≈°ie, <code>npm</code> pr√≠kaz updatne <code>package.json</code> nasledovne:</p>
<pre><code class="language-javascript" translate="no">
{
  "name": "application-name",
  "version": "0.0.1",
  "private": true,
  "scripts": {
    "start": "node app.js"
  },
  "dependencies": {
    "body-parser": "^1.5.2",
    "errorhandler": "^1.1.1",
    "express": "^4.8.0",
    "express-session": "^1.7.2",
    "pug": "^2.0.0-beta6",
    "method-override": "^2.1.2",
    "morgan": "^1.2.2",
    "multer": "^0.1.3",
    "serve-favicon": "^2.0.1"
  }
}
</code>
</pre>
<h4><code>app.js</code></h4>
<p>Potom zma≈æte nespr√°vny k√≥d, naƒç√≠tajte potrebn√© middlewary a vykonajte ƒèal≈°ie potrebn√© zmeny. S√∫bor <code>app.js</code> bude potom vyzera≈• takto:</p>
<pre><code class="language-javascript" translate="no">
var http = require('http');
var express = require('express');
var routes = require('./routes');
var user = require('./routes/user');
var path = require('path');

var favicon = require('serve-favicon');
var logger = require('morgan');
var methodOverride = require('method-override');
var session = require('express-session');
var bodyParser = require('body-parser');
var multer = require('multer');
var errorHandler = require('errorhandler');

var app = express();

// all environments
app.set('port', process.env.PORT || 3000);
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'pug');
app.use(favicon(__dirname + '/public/favicon.ico'));
app.use(logger('dev'));
app.use(methodOverride());
app.use(session({ resave: true,
                  saveUninitialized: true,
                  secret: 'uwotm8' }));
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));
app.use(multer());
app.use(express.static(path.join(__dirname, 'public')));

app.get('/', routes.index);
app.get('/users', user.list);

// error handling middleware should be loaded after the loading the routes
if ('development' == app.get('env')) {
  app.use(errorHandler());
}

var server = http.createServer(app);
server.listen(app.get('port'), function(){
  console.log('Express server listening on port ' + app.get('port'));
});
</code>
</pre>
<div class="doc-box doc-info">
<p>Pokiaƒæ nepotrebujete priamo pracova≈• s <code>http</code> modulom (socket.io/SPDY/HTTPS), nie je nutn√© ho naƒç√≠ta≈• a aplik√°ciu m√¥≈æete jednoducho na≈°tartova≈• t√Ωmto sp√¥sobom:</p>
<pre><code class="language-js">app.listen(app.get('port'), function(){
  console.log('Express server listening on port ' + app.get('port'));
});</code>
</pre>
</div>
<h3>Spustite aplik√°ciu</h3>
<p>Proces migr√°cie je kompletn√Ω a aplik√°cia je teraz Express 4 aplik√°ciou. Pre overenie spustite aplik√°ciu pomocou nasleduj√∫ceho pr√≠kazu:</p>
<pre><code class="language-sh" translate="no">
$ node .
</code>
</pre>
<p>Naƒç√≠tajte v prehliadaƒçi <a href="http://localhost:3000/">http://localhost:3000</a>
a pozrite si domovsk√∫ str√°nku aplik√°cie vyrendrovan√∫ pomocou Express 4.</p>
<h2 id="app-gen">Prechod na Express 4 app gener√°tor</h2>
<p>Tento command-line tool sl√∫≈æiaci na generovanie Express aplik√°cie je st√°le
<code>express</code>, ale k tomu, aby ste vykonali upgrade na nov√∫ verziu mus√≠te najprv p√¥vodn√Ω Express 3 app gener√°tor odin≈°talova≈• a potom nain≈°talova≈• nov√Ω <code>express-generator</code>.</p>
<h3>In≈°tal√°cia</h3>
<p>Ak u≈æ m√°te Express 3 app gener√°tor na va≈°om syst√©me nain≈°talovan√Ω, mus√≠te ho najsk√¥r odin≈°talova≈•:</p>
<pre><code class="language-sh" translate="no">
$ npm uninstall -g express
</code>
</pre>
<p>V z√°vislosti od toho, ako s√∫ nakonfigurovan√© va≈°e opr√°vnenia k s√∫borom a prieƒçinkom,
m√¥≈æe by≈• potrebn√© spusti≈• tento pr√≠kaz pomocou <code>sudo</code>.</p>
<p>Teraz nain≈°talujte nov√Ω gener√°tor:</p>
<pre><code class="language-sh" translate="no">
$ npm install -g express-generator
</code>
</pre>
<p>V z√°vislosti od toho, ako s√∫ nakonfigurovan√© va≈°e opr√°vnenia k s√∫borom a prieƒçinkom,
m√¥≈æe by≈• potrebn√© spusti≈• tento pr√≠kaz pomocou <code>sudo</code>.</p>
<p>Teraz je pr√≠kaz <code>express</code> aktualizovan√Ω na va≈°om syst√©me na
Express 4 gener√°tor.</p>
<h3>Zmeny app gener√°tora</h3>
<p>Prep√≠naƒçe a pou≈æitia pr√≠kazu zostali preva≈æne rovnak√©, okrem nasleduj√∫cich v√Ωnimiek:</p>
<ul class="doclist">
<li>Odstr√°nen√Ω prep√≠naƒç <code>--sessions</code>.</li>
<li>Odstr√°nen√Ω prep√≠naƒç <code>--jshtml</code>.</li>
<li>Pridan√Ω prep√≠naƒç <code>--hogan</code> pre podporu <a href="http://twitter.github.io/hogan.js/">Hogan.js</a>.</li>
</ul>
<h3>Pr√≠klad</h3>
<p>K vytvoreniu Express 4 aplik√°cie spustite nasleduj√∫ci pr√≠kaz:</p>
<pre><code class="language-sh" translate="no">
$ express app4
</code>
</pre>
<p>Ak sa pozriete na obsah <code>app4/app.js</code> s√∫boru, v≈°imnete si, ≈æe v≈°etky middleware funkcie (okrem <code>express.static</code>), ktor√© s√∫ potrebn√© pre aplik√°ciu, s√∫ naƒç√≠tan√© ako samostatn√©, nez√°visl√© moduly a <code>router</code> middleware u≈æ nie je v aplik√°cii explicitne naƒç√≠tan√Ω.</p>
<p>Taktie≈æ si v≈°imnite, ≈æe s√∫bor <code>app.js</code> je odteraz Node.js modulom, v porovnan√≠ so standalone aplik√°ciou vygenerovanou star√Ωm gener√°torom.</p>
<p>Po nain≈°talovan√≠ z√°vislost√≠ spustite aplik√°ciu pomocou nasleduj√∫ceho pr√≠kazu:</p>
<pre><code class="language-sh" translate="no">
$ npm start
</code>
</pre>
<p>Ak sa pozriete na npm start skript v <code>package.json</code> s√∫bore,
v≈°imnete si, ≈æe aktu√°lny pr√≠kaz pre spustenie aplik√°cie je
<code>node ./bin/www</code>, ktor√Ω bol v Express 3 p√¥vodne <code>node app.js</code>.</p>
<p>Preto≈æe s√∫bor <code>app.js</code>, ktor√Ω bol vygenerovan√Ω Express 4 gener√°torom je odteraz Node.js modul,
u≈æ nem√¥≈æe by≈• viacej spusten√Ω nez√°visle ako aplik√°cia (pokiaƒæ nezmen√≠te k√≥d).
Modul mus√≠ by≈• naƒç√≠tan√Ω a spusten√Ω ako Node.js s√∫bor. Node.js s√∫bor je v tomto pr√≠pade<code>./bin/www</code>.</p>
<p>Prieƒçinok <code>bin</code> ani bezpr√≠ponov√Ω s√∫bor <code>www</code> nie s√∫ povinn√© k vytvoreniu ani spusteniu aplik√°cie.
S√∫ len n√°vrhom vyroben√Ωm gener√°torom, tak≈æe ich m√¥zete zmeni≈• podƒæa va≈°ich potrieb.</p>
<p>Ak sa chcete zbavi≈• <code>www</code> prieƒçinka a ponecha≈• to v starom ‚ÄúExpress 3 form√°te‚Äù,
zma≈æte riadok <code>module.exports = app;</code> na konci <code>app.js</code> s√∫boru a namiesto neho vlo≈æte nasleduj√∫ci k√≥d:</p>
<pre><code class="language-javascript" translate="no">
app.set('port', process.env.PORT || 3000);

var server = app.listen(app.get('port'), function() {
  debug('Express server listening on port ' + server.address().port);
});
</code>
</pre>
<p>Uistite sa, ≈æe ste naƒç√≠tali <code>debug</code> modul, v hornej ƒçasti v√°≈°ho <code>app.js</code> s√∫boru, pou≈æit√≠m nasleduj√∫ceho k√≥du:</p>
<pre><code class="language-javascript" translate="no">
var debug = require('debug')('app4');
</code>
</pre>
<p>ƒéalej zme≈àte v s√∫bore <code>package.json</code> riadok <code>"start": "node ./bin/www"</code> na <code>"start": "node app.js"</code>.</p>
<p>T√Ωmto ste presunuli funkcionalitu <code>./bin/www</code> sp√§≈• do <code>app.js</code>. T√°to zmena sa neodpor√∫ƒça, ale toto cviƒçenie v√°m pom√¥≈æe porozumie≈• ako <code>./bin/www</code> s√∫bor pracuje a preƒço <code>app.js</code> u≈æ viac nie je mo≈æn√© samostatne spusti≈•.</p>
</div>
</section>
<noscript>
    <iframe src="http://www.googletagmanager.com/ns.html?id=GTM-5XL76H" height="0" width="0" style="display: none; visibility: hidden;"></iframe>
</noscript>
<script type="91f4e1d330b5ad52d5ee9e84-text/javascript">
(function(w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({
        'gtm.start': new Date().getTime(),
        event: 'gtm.js'
    });
    var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != 'dataLayer' ? '&l=' + l : '';
    j.async = true;
    j.src =
        '../../../www.googletagmanager.com/gtm5445.js?id=' + i + dl;
    f.parentNode.insertBefore(j, f);
})(window, document, 'script', 'dataLayer', 'GTM-5XL76H');
</script>
<a id="top" href="#"><img src="../../images/arrow.png"></a>
<footer>
<div id="footer-content">
<div id="github">
<iframe src="https://ghbtns.com/github-btn.html?user=expressjs&amp;repo=express&amp;type=star&amp;count=true" frameborder="0" scrolling="0" width="200px" height="20px"></iframe>
</div>
<div id="sponsor">
<a href="https://github.com/expressjs/express/">Express</a> je projekt patriaci pod <a href="http://nodejs.org/foundation"></a>Node.js Foundation</a>.
</div>
<div id="fork">
<a href="https://github.com/expressjs/expressjs.com">Editova≈• str√°nku na GitHub-e</a>.
</div>
<div>Copyright &copy; 2016 StrongLoop, IBM a ostatn√≠ expressjs.com prispievatelia.</div>
</div>
<div id="license">
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/"><img alt="Creative Commons License" style="border-width:0" src="../../../i.creativecommons.org/l/by-sa/3.0/us/80x15.png" /></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/">Creative Commons Attribution-ShareAlike 3.0 United States License</a>.
</div>
</footer>
<script type="91f4e1d330b5ad52d5ee9e84-text/javascript" src="../../../cdn.jsdelivr.net/npm/docsearch.js%402/dist/cdn/docsearch.min.js" onload="docsearch({
  apiKey: '7164e33055faa6ecddefd9e08fc59f5d',
  indexName: 'expressjs',
  inputSelector: '#q',
  algoliaOptions: { 'facetFilters': ['lang:sk'] }
})" async></script>
<script src="../../../ajax.cloudflare.com/cdn-cgi/scripts/a2bd7673/cloudflare-static/rocket-loader.min.js" data-cf-settings="91f4e1d330b5ad52d5ee9e84-|49" defer=""></script></body>

<!-- Mirrored from expressjs.com/sk/guide/migrating-4.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 10 Jul 2019 00:23:54 GMT -->
</html>

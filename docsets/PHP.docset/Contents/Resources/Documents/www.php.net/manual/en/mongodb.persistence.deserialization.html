<html><!-- Mirrored from www.php.net/manual/en/mongodb.persistence.deserialization.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 10:46:27 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Deserialization from BSON</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="mongodb.persistence.deserialization.html">
 <link rel="shorturl" href="mongodb.persistence.deserialization.html">
 <link rel="alternate" href="mongodb.persistence.deserialization.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="mongodb.persistence.html">
 <link rel="prev" href="mongodb.persistence.serialization.html">
 <link rel="next" href="mongodb.security.html">

 <link rel="alternate" href="mongodb.persistence.deserialization.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/mongodb.persistence.deserialization.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/mongodb.persistence.deserialization.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/mongodb.persistence.deserialization.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/mongodb.persistence.deserialization.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/mongodb.persistence.deserialization.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/mongodb.persistence.deserialization.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/mongodb.persistence.deserialization.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/mongodb.persistence.deserialization.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/mongodb.persistence.deserialization.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.vendors.html">Vendor Specific Database Extensions</a></li>      <li><a href="set.mongodb.html">MongoDB</a></li>      <li><a href="mongodb.architecture.html">Driver Architecture and Internals</a></li>      <li><a href="mongodb.persistence.html">Persisting Data</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="mongodb.persistence.deserialization" class="section">
   <h2 class="title">Deserialization from BSON</h2>

   <p class="para">
    The legacy <code class="code">mongo</code> extension deserialized
    both BSON documents and arrays as PHP arrays. While PHP arrays are
    convenient to work with, this behavior was problematic because different
    BSON types could deserialize to the same PHP value (e.g.
    <code class="literal">{"0": "foo"}</code> and <code class="literal">["foo"]</code>) and make it
    impossible to infer the original BSON type. By default, the current driver
    addresses this concern by ensuring that BSON arrays and documents are
    converted to PHP arrays and objects, respectively.
   </p>
   <p class="para">
    For compound types, there are three data types:
   </p>

   <p class="para">
    </p><dl>
     
      <dt>
root</dt>

      <dd>

       <p class="para">
        refers to the top-level BSON document <em class="emphasis">only</em>
       </p>
      </dd>

     
     
      <dt>
document</dt>

      <dd>

       <p class="para">
        refers to embedded BSON documents <em class="emphasis">only</em>
       </p>
      </dd>

     
     
      <dt>
array</dt>

      <dd>

       <p class="para">
        refers to a BSON array
       </p>
      </dd>

     
    </dl>

   <p></p>

   <p class="para">
    Besides the three collective types, it is also possible to configure
    specific fields in your document to map to the data types mentioned below.
    As an example, the following type map allows you to
    map each embedded document within an <code class="literal">"addresses"</code> array to
    an <span class="classname"><strong class="classname">Address</strong></span> class <em class="emphasis">and</em> each
    <code class="literal">"city"</code> field within those embedded address documents to
    a <span class="classname"><strong class="classname">City</strong></span> class:

    </p><div class="example-contents">
<div class="textcode"><pre class="textcode">[
    'fieldPaths' =&gt; [
        'addresses.$' =&gt; 'MyProject\Address',
        'addresses.$.city' =&gt; 'MyProject\City',
    ],
]</pre>
</div>
    </div>

   <p></p>

   <p class="para">
    Each of those three data types, as well as the field specific mappings,
    can be mapped against different PHP types. The possible mapping values
    are:
   </p>

   <p class="para">
    </p><dl>
     
      <dt>
<em class="emphasis">not set</em> or <span class="type">NULL</span> (default)</dt>

      <dd>

       <p class="para">
        </p><ul class="itemizedlist">
         <li class="listitem">
          <p class="para">
           A BSON array will be deserialized as a PHP <span class="type">array</span>.
          </p>
         </li>
         <li class="listitem">
          <p class="para">
           A BSON document (root or embedded) without a
           <span class="property">__pclass</span> property
           <a href="#fnidmongodb.pclass" name="fnmongodb.pclass"><sup>[1]</sup></a>
            
           
           becomes a PHP <span class="classname"><strong class="classname">stdClass</strong></span> object, with each
           BSON document key set as a public <span class="classname"><strong class="classname">stdClass</strong></span>
           property.
          </p>
         </li>
         <li class="listitem">
          <p class="para">
           A BSON document (root or embedded) with a
           <span class="property">__pclass</span> property <a href="#fnidmongodb.pclass"><sup>[1]</sup></a> becomes a PHP object of
           the class name as defined by the <span class="property">__pclass</span>
           property.
          </p>
          <p class="para">
           If the named class implements the
           <span class="interfacename"><a href="class.mongodb-bson-persistable.html" class="interfacename">MongoDB\BSON\Persistable</a></span> interface,
           then the properties of the BSON document, including the
           <span class="property">__pclass</span> property, are sent as an associative
           array to the
           <span class="methodname"><a href="mongodb-bson-unserializable.bsonunserialize.html" class="methodname">MongoDB\BSON\Unserializable::bsonUnserialize()</a></span>
           function to initialise the object's properties.
          </p>
          <p class="para">
           If the named class does not exist or does not implement the
           <span class="interfacename"><a href="class.mongodb-bson-persistable.html" class="interfacename">MongoDB\BSON\Persistable</a></span> interface,
           <span class="classname"><strong class="classname">stdClass</strong></span> will be used and each BSON document
           key (including <span class="property">__pclass</span>) will be set as a
           public <span class="classname"><strong class="classname">stdClass</strong></span> property.
          </p>
          <p class="para">
           The <span class="property">__pclass</span> functionality relies on the
           property being part of a retrieved MongoDB document. If you use a
           <a href="mongodb-driver-query.construct.html#mongodb-driver-query.construct-queryOptions" class="link">projection</a>
           when querying for documents, you need to include the
           <span class="property">__pclass</span> field in the projection for this
           functionality to work.
          </p>
         </li>
        </ul>
       <p></p>
      </dd>

     

     
      <dt>
<code class="literal">"array"</code></dt>

      <dd>

       <p class="para">
        Turns a BSON array or BSON document into a PHP array. There will be no
        special treatment of a <span class="property">__pclass</span> property <a href="#fnidmongodb.pclass"><sup>[1]</sup></a>,
        but it may be set as an element in the returned array if it was
        present in the BSON document.
       </p>
      </dd>

     

     
      <dt>
<code class="literal">"object"</code> or <code class="literal">"stdClass"</code></dt>

      <dd>

       <p class="para">
        Turns a BSON array or BSON document into a
        <span class="classname"><strong class="classname">stdClass</strong></span> object. There will be no special
        treatment of a <span class="property">__pclass</span> property <a href="#fnidmongodb.pclass"><sup>[1]</sup></a>, but it may
        be set as a public property in the returned object if it was present
        in the BSON document.
       </p>
      </dd>

     

     
      <dt>
any other string</dt>

      <dd>

       <p class="para">
        Defines the class name that the BSON array or BSON object should be
        deserialized as. For BSON objects that include
        <span class="property">__pclass</span> properties, that class will take
        priority.
       </p>

       <p class="para">
        If the named class does not exist, is not concrete (i.e. it is
        abstract or an interface), or does not implement
        <span class="interfacename"><a href="class.mongodb-bson-unserializable.html" class="interfacename">MongoDB\BSON\Unserializable</a></span> then an
        <span class="classname"><a href="class.mongodb-driver-exception-invalidargumentexception.html" class="classname">MongoDB\Driver\Exception\InvalidArgumentException</a></span>
        exception is thrown.
       </p>

       <p class="para">
        If the BSON object has a <span class="property">__pclass</span> property and
        that class exists and implements
        <span class="interfacename"><a href="class.mongodb-bson-persistable.html" class="interfacename">MongoDB\BSON\Persistable</a></span> it will
        supersede the class provided in the type map.
       </p>

       <p class="para">
        The properties of the BSON document, <em class="emphasis">including</em>
        the <span class="property">__pclass</span> property if it exists, will be sent
        as an associative array to the
        <span class="methodname"><a href="mongodb-bson-unserializable.bsonunserialize.html" class="methodname">MongoDB\BSON\Unserializable::bsonUnserialize()</a></span>
        function to initialise the object's properties.
       </p>
      </dd>

     
    </dl>

   <p></p>

   <div class="section" id="mongodb.persistence.typemaps">
    <h2 class="title">TypeMaps</h2>

     <p class="para">
      TypeMaps can be set through the
      <span class="methodname"><a href="mongodb-driver-cursor.settypemap.html" class="methodname">MongoDB\Driver\Cursor::setTypeMap()</a></span> method on a
      <span class="classname"><a href="class.mongodb-driver-cursor.html" class="classname">MongoDB\Driver\Cursor</a></span> object, or the
      <code class="literal">$typeMap</code> argument of
      <span class="function"><a href="function.mongodb.bson-tophp.html" class="function">MongoDB\BSON\toPHP()</a></span>. Each of the three
      classes (<em class="emphasis">root</em>, <em class="emphasis">document</em>, and
      <em class="emphasis">array</em>) can be individually set, in addition to the
      field specific types.
     </p>

     <p class="para">
      If the value in the map is <span class="type">NULL</span>, it means the same as the
      <em class="emphasis">default</em> value for that item.
     </p>
    </div>

    <div class="section">
     <h2 class="title">Examples</h2>

     <p class="para">
      These examples use the following classes:
     </p>

     <p class="para">
      </p><dl>
       
        <dt>
MyClass</dt>

        <dd>

         <p class="para">
          which does <em class="emphasis">not</em> implement any interface
         </p>
        </dd>

       
       
        <dt>
YourClass</dt>

        <dd>

         <p class="para">
          which implements
          <span class="interfacename"><a href="class.mongodb-bson-unserializable.html" class="interfacename">MongoDB\BSON\Unserializable</a></span>
         </p>
        </dd>

       
       
        <dt>
OurClass</dt>

        <dd>

         <p class="para">
          which implements
          <span class="interfacename"><a href="class.mongodb-bson-persistable.html" class="interfacename">MongoDB\BSON\Persistable</a></span>
         </p>
        </dd>

       
       
        <dt>
TheirClass</dt>

        <dd>

         <p class="para">
          which extends OurClass
         </p>
        </dd>

       
      </dl>

     <p></p>

     <p class="para">
      The <span class="methodname"><a href="mongodb-bson-unserializable.bsonunserialize.html" class="methodname">MongoDB\BSON\Unserializable::bsonUnserialize()</a></span>
      method of YourClass, OurClass, TheirClass iterate over the array and set
      the properties without modifications. It <em class="emphasis">also</em> sets
      the <code class="literal">$unserialized</code> property to <code class="literal">true</code>:

      </p><div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">bsonUnserialize</span><span style="color: #007700">(&nbsp;array&nbsp;</span><span style="color: #0000BB">$map&nbsp;</span><span style="color: #007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(&nbsp;</span><span style="color: #0000BB">$map&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$k&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">$k&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">unserialized&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>}</span>
</span>
</code></div>
      </div>

     <p></p>

     <p class="para">
      </p><div class="example-contents">
<div class="textcode"><pre class="textcode">/* typemap: [] (all defaults) */
{ "foo": "yes", "bar" : false }
  -&gt; stdClass { $foo =&gt; 'yes', $bar =&gt; false }

{ "foo": "no", "array" : [ 5, 6 ] }
  -&gt; stdClass { $foo =&gt; 'no', $array =&gt; [ 5, 6 ] }

{ "foo": "no", "obj" : { "embedded" : 3.14 } }
  -&gt; stdClass { $foo =&gt; 'no', $obj =&gt; stdClass { $embedded =&gt; 3.14 } }

{ "foo": "yes", "__pclass": "MyClass" }
  -&gt; stdClass { $foo =&gt; 'yes', $__pclass =&gt; 'MyClass' }

{ "foo": "yes", "__pclass": { "$type" : "80", "$binary" : "MyClass" } }
  -&gt; stdClass { $foo =&gt; 'yes', $__pclass =&gt; Binary(0x80, 'MyClass') }

{ "foo": "yes", "__pclass": { "$type" : "80", "$binary" : "YourClass") }
  -&gt; stdClass { $foo =&gt; 'yes', $__pclass =&gt; Binary(0x80, 'YourClass') }

{ "foo": "yes", "__pclass": { "$type" : "80", "$binary" : "OurClass") }
  -&gt; OurClass { $foo =&gt; 'yes', $__pclass =&gt; Binary(0x80, 'OurClass'), $unserialized =&gt; true }

{ "foo": "yes", "__pclass": { "$type" : "44", "$binary" : "YourClass") }
  -&gt; stdClass { $foo =&gt; 'yes', $__pclass =&gt; Binary(0x44, 'YourClass') }</pre>
</div>
      </div>

     <p></p>

     <p class="para">
      </p><div class="example-contents">
<div class="textcode"><pre class="textcode">/* typemap: [ "root" =&gt; "MissingClass" ] */
{ "foo": "yes" }
  -&gt; MongoDB\Driver\Exception\InvalidArgumentException("MissingClass does not exist")

/* typemap: [ "root" =&gt; "MyClass" ] */
{ "foo": "yes", "__pclass" : { "$type": "80", "$binary": "MyClass" } }
  -&gt; MongoDB\Driver\Exception\InvalidArgumentException("MyClass does not implement Unserializable interface")

/* typemap: [ "root" =&gt; "MongoDB\BSON\Unserializable" ] */
{ "foo": "yes" }
  -&gt; MongoDB\Driver\Exception\InvalidArgumentException("Unserializable is not a concrete class")

/* typemap: [ "root" =&gt; "YourClass" ] */
{ "foo": "yes", "__pclass" : { "$type": "80", "$binary": "MongoDB\BSON\Unserializable" } }
  -&gt; YourClass { $foo =&gt; "yes", $__pclass =&gt; Binary(0x80, "MongoDB\BSON\Unserializable"), $unserialized =&gt; true }

/* typemap: [ "root" =&gt; "YourClass" ] */
{ "foo": "yes", "__pclass" : { "$type": "80", "$binary": "MyClass" } }
  -&gt; YourClass { $foo =&gt; "yes", $__pclass =&gt; Binary(0x80, "MyClass"), $unserialized =&gt; true }

/* typemap: [ "root" =&gt; "YourClass" ] */
{ "foo": "yes", "__pclass" : { "$type": "80", "$binary": "OurClass" } }
  -&gt; OurClass { $foo =&gt; "yes", $__pclass =&gt; Binary(0x80, "OurClass"), $unserialized =&gt; true }

/* typemap: [ "root" =&gt; "YourClass" ] */
{ "foo": "yes", "__pclass" : { "$type": "80", "$binary": "TheirClass" } }
  -&gt; TheirClass { $foo =&gt; "yes", $__pclass =&gt; Binary(0x80, "TheirClass"), $unserialized =&gt; true }

/* typemap: [ "root" =&gt; "OurClass" ] */
{ foo: "yes", "__pclass" : { "$type": "80", "$binary": "TheirClass" } }
  -&gt; TheirClass { $foo =&gt; "yes", $__pclass =&gt; Binary(0x80, "TheirClass"), $unserialized =&gt; true }</pre>
</div>
      </div>

     <p></p>

     <p class="para">
      </p><div class="example-contents">
<div class="textcode"><pre class="textcode">/* typemap: [ 'root' =&gt; 'YourClass' ] */
{ foo: "yes", "__pclass" : { "$type": "80", "$binary": "YourClass" } }
  -&gt; YourClass { $foo =&gt; 'yes', $__pclass =&gt; Binary(0x80, 'YourClass'), $unserialized =&gt; true }</pre>
</div>
      </div>

     <p></p>

     <p class="para">
      </p><div class="example-contents">
<div class="textcode"><pre class="textcode">/* typemap: [ 'root' =&gt; 'array', 'document' =&gt; 'array' ] */
{ "foo": "yes", "bar" : false }
  -&gt; [ "foo" =&gt; "yes", "bar" =&gt; false ]

{ "foo": "no", "array" : [ 5, 6 ] }
  -&gt; [ "foo" =&gt; "no", "array" =&gt; [ 5, 6 ] ]

{ "foo": "no", "obj" : { "embedded" : 3.14 } }
  -&gt; [ "foo" =&gt; "no", "obj" =&gt; [ "embedded =&gt; 3.14 ] ]

{ "foo": "yes", "__pclass": "MyClass" }
  -&gt; [ "foo" =&gt; "yes", "__pclass" =&gt; "MyClass" ]

{ "foo": "yes", "__pclass" : { "$type": "80", "$binary": "MyClass" } }
  -&gt; [ "foo" =&gt; "yes", "__pclass" =&gt; Binary(0x80, "MyClass") ]

{ "foo": "yes", "__pclass" : { "$type": "80", "$binary": "OurClass" } }
  -&gt; [ "foo" =&gt; "yes", "__pclass" =&gt; Binary(0x80, "OurClass") ]</pre>
</div>
      </div>

     <p></p>

     <p class="para">
      </p><div class="example-contents">
<div class="textcode"><pre class="textcode">/* typemap: [ 'root' =&gt; 'object', 'document' =&gt; 'object' ] */
{ "foo": "yes", "__pclass": { "$type": "80", "$binary": "MyClass" } }
  -&gt; stdClass { $foo =&gt; "yes", "__pclass" =&gt; Binary(0x80, "MyClass") }</pre>
</div>
      </div>

     <p></p>

   </div>
  </div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="121861">  
  <a class="name">
  <strong class="user"><em>Miguel</em></strong></a><div class="date" title="2017-11-11 04:10"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom121861">
<div class="phpcode"><code><span class="html">
Make sure you include the field "__pclass" to the projection if you want the ODM to automatically call the bsonUnserialize of the class.<br><br>If you don't get that field in the query, the ODM will never know which class to call, so you'll have to specify it with the "typemap" variable.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="125096">  
  <a class="name">
  <strong class="user"><em>hello at stefandjokic dot com</em></strong></a><div class="date" title="2020-06-08 12:33"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom125096">
<div class="phpcode"><code><span class="html">
Minor correction to my previous comment:<br><br>Use 'fieldPaths' for specifying type of nested property.<br><br>Eg.<br><br>'typeMap' =&gt; [<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'array' =&gt; 'array',<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'fieldPaths' =&gt; [<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'notifications.email.to' =&gt; 'array',<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'notifications.data.params' =&gt; 'array',<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ],<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ],</span>
</code></div>
  </div>
 </div>
  <div class="note" id="125071">  
  <a class="name">
  <strong class="user"><em>hello at stefandjokic dot com</em></strong></a><div class="date" title="2020-06-02 09:12"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom125071">
<div class="phpcode"><code><span class="html">
You can also specify the type map for nested document item, e.g.<br><br><span class="default">&lt;?php<br></span><span class="keyword">.<br>.<br>.<br></span><span class="comment">// everything else is by default an object<br></span><span class="string">'typeMap' </span><span class="keyword">=&gt; [<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'customer.phones' </span><span class="keyword">=&gt; </span><span class="string">'array'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ],</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/mongodb.persistence.deserialization.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 10:46:27 GMT -->

</body></html>
<html><!-- Mirrored from www.php.net/manual/en/function.eval.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:33:44 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>eval</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.eval.html">
 <link rel="shorturl" href="https://www.php.net/eval">
 <link rel="alternate" href="https://www.php.net/eval" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.misc.html">
 <link rel="prev" href="function.die.html">
 <link rel="next" href="function.exit.html">

 <link rel="alternate" href="function.eval.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.eval.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.eval.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.eval.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.eval.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.eval.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.eval.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.eval.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.eval.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.eval.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.other.html">Other Basic Extensions</a></li>      <li><a href="book.misc.html">Misc.</a></li>      <li><a href="ref.misc.html">Misc. Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.eval" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">eval</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">eval</span> â€” <span class="dc-title">Evaluate a string as PHP code</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.eval-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>eval</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$code</code></span>): <span class="type"><a href="language.types.declarations.html#language.types.declarations.mixed" class="type mixed">mixed</a></span></div>

  <p class="para rdfs-comment">
   Evaluates the given <code class="parameter">code</code> as PHP.
  </p>
  <div class="caution"><strong class="caution">Caution</strong>
   <p class="para">
    The <span class="function"><strong>eval()</strong></span> language construct is <em class="emphasis">very dangerous</em>
    because it allows execution of arbitrary PHP code. <em class="emphasis">Its use thus is
    discouraged.</em> If you have carefully verified that there is no other option
    than to use this construct, pay special attention <em class="emphasis">not to pass any user
    provided data</em> into it without properly validating it beforehand.
   </p>
  </div>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.eval-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    
     <dt>
<code class="parameter">code</code></dt>

     <dd>

      <p class="para">
       Valid PHP code to be evaluated.
      </p>
      <p class="para">
       The code must not be wrapped in opening and closing
       <a href="language.basic-syntax.phpmode.html" class="link">PHP tags</a>, i.e.
       <code class="literal">'echo "Hi!";'</code> must be passed instead of
       <code class="literal">'&lt;?php echo "Hi!"; ?&gt;'</code>. It is still possible to leave and
       re-enter PHP mode though using the appropriate PHP tags, e.g.
       <code class="literal">'echo "In PHP mode!"; ?&gt;In HTML mode!&lt;?php echo "Back in PHP mode!";'</code>.
      </p>
      <p class="para">
       Apart from that the passed code must be valid PHP. This includes that all statements
       must be properly terminated using a semicolon.
       <code class="literal">'echo "Hi!"'</code> for example will cause a parse error, whereas
       <code class="literal">'echo "Hi!";'</code> will work.
      </p>
      <p class="para">
       A <code class="literal">return</code> statement will immediately terminate the
       evaluation of the code. 
      </p>
      <p class="para">
       The code will be executed in the scope of the code calling <span class="function"><strong>eval()</strong></span>. Thus any
       variables defined or changed in the <span class="function"><strong>eval()</strong></span> call will remain visible after
       it terminates.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.eval-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   <span class="function"><strong>eval()</strong></span> returns <strong><code>null</code></strong> unless 
   <code class="literal">return</code> is called in the evaluated code, in which case
   the value passed to <code class="literal">return</code> is returned. As of PHP 7, if there is a
   parse error in the evaluated code, <span class="function"><strong>eval()</strong></span> throws a ParseError exception.
   Before PHP 7, in this case <span class="function"><strong>eval()</strong></span> returned
   <strong><code>false</code></strong> and execution of the following code continued normally. It is
   not possible to catch a parse error in <span class="function"><strong>eval()</strong></span>
   using <span class="function"><a href="function.set-error-handler.html" class="function">set_error_handler()</a></span>.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.eval-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-3459">
    <p><strong>Example #1 <span class="function"><strong>eval()</strong></span> example - simple text merge</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'cup'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'coffee'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'This&nbsp;is&nbsp;a&nbsp;$string&nbsp;with&nbsp;my&nbsp;$name&nbsp;in&nbsp;it.'</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #0000BB">$str</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>eval(</span><span style="color: #DD0000">"\$str&nbsp;=&nbsp;\"</span><span style="color: #0000BB">$str</span><span style="color: #DD0000">\";"</span><span style="color: #007700">);<br>echo&nbsp;</span><span style="color: #0000BB">$str</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>This is a $string with my $name in it.
This is a cup with my coffee in it.
</pre></div>
    </div>
   </div>
  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.eval-notes">
  <h3 class="title">Notes</h3>

  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">Because this is a
language construct and not a function, it cannot be called using
<a href="functions.variable-functions.html" class="link">variable functions</a>.</span>
</p></blockquote>

  <div class="tip"><strong class="tip">Tip</strong><p class="simpara">As with anything that outputs
its result directly to the browser, the <a href="book.outcontrol.html" class="link">output-control functions</a> can be used to capture
the output of this function, and save it in a
<span class="type">string</span> (for example).</p></div>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    In case of a fatal error in the evaluated code, the whole script exits.
   </p>
  <p></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.eval-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.call-user-func.html" class="function" rel="rdfs-seeAlso">call_user_func()</a> - Call the callback given by the first parameter</span></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="44008">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2004-07-12 09:37"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom44008">
<div class="phpcode"><code><span class="html">
Kepp the following Quote in mind:<br><br>If eval() is the answer, you're almost certainly asking the<br>wrong question. -- Rasmus Lerdorf, BDFL of PHP</span>
</code></div>
  </div>
 </div>
  <div class="note" id="125667">  
  <a class="name">
  <strong class="user"><em>remindfwd</em></strong></a><div class="date" title="2021-01-09 05:30"><strong>8 months ago</strong></div>
  <div class="text" id="Hcom125667">
<div class="phpcode"><code><span class="html">
Note that <br><br><span class="default">&lt;?php<br><br></span><span class="keyword">echo eval( </span><span class="string">'$var = (20 - 5);' </span><span class="keyword">);&nbsp; </span><span class="comment">// don't show anything<br><br></span><span class="keyword">echo </span><span class="string">' someString ' </span><span class="keyword">. eval( </span><span class="string">'echo $var = 15;' </span><span class="keyword">); </span><span class="comment">// outputs 15 someString <br><br>//or<br></span><span class="keyword">echo </span><span class="string">' someString ' </span><span class="keyword">. eval( </span><span class="string">'echo $var = 15;' </span><span class="keyword">) . </span><span class="string">' otherString '</span><span class="keyword">; </span><span class="comment">// 15 someString&nbsp; otherString&nbsp; <br><br>//or<br></span><span class="keyword">echo </span><span class="string">' someString ' </span><span class="keyword">. eval( </span><span class="string">'echo $var = 15;' </span><span class="keyword">) . </span><span class="string">' otherString ' </span><span class="keyword">. </span><span class="string">'...' </span><span class="keyword">.eval( </span><span class="string">'echo " __ " . $var = 10;' </span><span class="keyword">); </span><span class="comment">// 15 __ 10 someString&nbsp; otherString&nbsp; ...<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="121284">  
  <a class="name">
  <strong class="user"><em>Jeremie LEGRAND</em></strong></a><div class="date" title="2017-06-28 03:25"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom121284">
<div class="phpcode"><code><span class="html">
At least in PHP 7.1+, eval() terminates the script if the evaluated code generate a fatal error. For example:<br><span class="default">&lt;?php<br></span><span class="keyword">@eval(</span><span class="string">'$content = (100 - );'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>(Even if it is in the man, I'm note sure it acted like this in 5.6, but whatever)<br>To catch it, I had to do:<br><span class="default">&lt;?php<br></span><span class="keyword">try {<br>&nbsp; &nbsp; eval(</span><span class="string">'$content = (100 - );'</span><span class="keyword">);<br>} catch (</span><span class="default">Throwable $t</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$content </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;<br></span><br>This is the only way I found to catch the error and hide the fact there was one.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="117744">  
  <a class="name">
  <strong class="user"><em>lord dot dracon at gmail dot com</em></strong></a><div class="date" title="2015-07-31 01:46"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom117744">
<div class="phpcode"><code><span class="html">
Inception with eval()<br><br>&lt;pre&gt;<br>Inception Start:<br><span class="default">&lt;?php<br></span><span class="keyword">eval(</span><span class="string">"echo 'Inception lvl 1...\n'; eval('echo \"Inception lvl 2...\n\"; eval(\"echo \'Inception lvl 3...\n\'; eval(\'echo \\\"Limbo!\\\";\');\");');"</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122036">  
  <a class="name">
  <strong class="user"><em>catgirl at charuru dot moe</em></strong></a><div class="date" title="2017-12-17 11:49"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122036">
<div class="phpcode"><code><span class="html">
It should be noted that imported namespaces are not available in eval.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107377">  
  <a class="name">
  <strong class="user"><em>bohwaz</em></strong></a><div class="date" title="2012-02-04 10:51"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom107377">
<div class="phpcode"><code><span class="html">
If you want to allow math input and make sure that the input is proper mathematics and not some hacking code, you can try this:<br><br><span class="default">&lt;?php<br><br>$test </span><span class="keyword">= </span><span class="string">'2+3*pi'</span><span class="keyword">;<br><br></span><span class="comment">// Remove whitespaces<br></span><span class="default">$test </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\s+/'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">);<br><br></span><span class="default">$number </span><span class="keyword">= </span><span class="string">'(?:\d+(?:[,.]\d+)?|pi|Ï€)'</span><span class="keyword">; </span><span class="comment">// What is a number<br></span><span class="default">$functions </span><span class="keyword">= </span><span class="string">'(?:sinh?|cosh?|tanh?|abs|acosh?|asinh?|atanh?|exp|log10|deg2rad|rad2deg|sqrt|ceil|floor|round)'</span><span class="keyword">; </span><span class="comment">// Allowed PHP functions<br></span><span class="default">$operators </span><span class="keyword">= </span><span class="string">'[+\/*\^%-]'</span><span class="keyword">; </span><span class="comment">// Allowed math operators<br></span><span class="default">$regexp </span><span class="keyword">= </span><span class="string">'/^(('</span><span class="keyword">.</span><span class="default">$number</span><span class="keyword">.</span><span class="string">'|'</span><span class="keyword">.</span><span class="default">$functions</span><span class="keyword">.</span><span class="string">'\s*\((?1)+\)|\((?1)+\))(?:'</span><span class="keyword">.</span><span class="default">$operators</span><span class="keyword">.</span><span class="string">'(?2))?)+$/'</span><span class="keyword">; </span><span class="comment">// Final regexp, heavily using recursive patterns<br><br></span><span class="keyword">if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$regexp</span><span class="keyword">, </span><span class="default">$q</span><span class="keyword">))<br>{<br>&nbsp; &nbsp; </span><span class="default">$test </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'!pi|Ï€!'</span><span class="keyword">, </span><span class="string">'pi()'</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">); </span><span class="comment">// Replace pi with pi function<br>&nbsp; &nbsp; </span><span class="keyword">eval(</span><span class="string">'$result = '</span><span class="keyword">.</span><span class="default">$test</span><span class="keyword">.</span><span class="string">';'</span><span class="keyword">);<br>}<br>else<br>{<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br>}<br><br></span><span class="default">?&gt;<br></span><br>I can't guarantee you absolutely that this will block every possible malicious code nor that it will block malformed code, but that's better than the matheval function below which will allow malformed code like '2+2+' which will throw an error.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="121837">  
  <a class="name">
  <strong class="user"><em>solobot</em></strong></a><div class="date" title="2017-11-07 09:55"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom121837">
<div class="phpcode"><code><span class="html">
eval() is workaround for generating multiple anonymous classes with static properties in loop<br><br>public function generateClassMap()<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach ($this-&gt;classMap as $tableName =&gt; $class)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $c = null;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eval('$c = new class extends \common\MyStaticClass {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; public static $tableName;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; public static function tableName()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return static::$tableName;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };');<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $c::$tableName = $this-&gt;replicationPrefix.$tableName;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;classMap[$tableName] = $c;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br><br>thus every class will have its own $tableName instead of common ancestor.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97063">  
  <a class="name">
  <strong class="user"><em>darkhogg (foo) gmail (bar) com</em></strong></a><div class="date" title="2010-03-30 10:33"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom97063">
<div class="phpcode"><code><span class="html">
The following code<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="keyword">eval( </span><span class="string">'?&gt; foo &lt;?php' </span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>does not throw any error, but prints the opening tag.<br>Adding a space after the open tag fixes it:<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="keyword">eval( </span><span class="string">'?&gt; foo &lt;?php ' </span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="121190">  
  <a class="name">
  <strong class="user"><em>divinity76 at gmail dot com</em></strong></a><div class="date" title="2017-06-06 09:35"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom121190">
<div class="phpcode"><code><span class="html">
imo, this is a better eval replacement: <br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">betterEval</span><span class="keyword">(</span><span class="default">$code</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">tmpfile </span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">$tmpf </span><span class="keyword">= </span><span class="default">stream_get_meta_data </span><span class="keyword">( </span><span class="default">$tmp </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$tmpf </span><span class="keyword">= </span><span class="default">$tmpf </span><span class="keyword">[</span><span class="string">'uri'</span><span class="keyword">];<br>&nbsp; &nbsp; </span><span class="default">fwrite </span><span class="keyword">( </span><span class="default">$tmp</span><span class="keyword">, </span><span class="default">$code </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$ret </span><span class="keyword">= include (</span><span class="default">$tmpf</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">fclose </span><span class="keyword">( </span><span class="default">$tmp </span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="default">$ret</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;<br></span><br>- why? betterEval follows normal php opening and closing tag conventions, there's no need to strip `&lt;?php?&gt;` from the source.&nbsp; and it always throws a ParseError if there was a parse error, instead of returning false (note: this was fixed for normal eval() in php 7.0). - and there's also something about exception backtraces</span>
</code></div>
  </div>
 </div>
  <div class="note" id="118768">  
  <a class="name">
  <strong class="user"><em>Uther</em></strong></a><div class="date" title="2016-02-02 05:33"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom118768">
<div class="phpcode"><code><span class="html">
eval'd code within namespaces which contain class and/or function definitions will be defined in the global namespace... not incredibly obvious :/</span>
</code></div>
  </div>
 </div>
  <div class="note" id="116642">  
  <a class="name">
  <strong class="user"><em>Karel</em></strong></a><div class="date" title="2015-02-03 04:23"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom116642">
<div class="phpcode"><code><span class="html">
For them who are facing syntax error when try execute code in eval,
<br>
<br>
<br><span class="default">&lt;?php
<br>
<br>$str </span><span class="keyword">=&nbsp; </span><span class="string">'&lt;?php echo "test"; ?&gt;'</span><span class="keyword">;
<br>
<br>eval(</span><span class="string">'?&gt;'</span><span class="keyword">.</span><span class="default">$str</span><span class="keyword">.</span><span class="string">'&lt;?php;'</span><span class="keyword">); </span><span class="comment">// outputs test
<br></span><span class="keyword">eval(</span><span class="string">'?&gt;'</span><span class="keyword">.</span><span class="default">$str</span><span class="keyword">.</span><span class="string">'&lt;?'</span><span class="keyword">); </span><span class="comment">// outputs test
<br></span><span class="keyword">eval(</span><span class="string">'?&gt;'</span><span class="keyword">.</span><span class="default">$str</span><span class="keyword">.</span><span class="string">'&lt;?php'</span><span class="keyword">);</span><span class="comment">// throws syntax error - unexpected $end
<br>
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99891">  
  <a class="name">
  <strong class="user"><em>php at rijkvanwel dot nl</em></strong></a><div class="date" title="2010-09-13 07:41"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom99891">
<div class="phpcode"><code><span class="html">
To catch a parse error in eval()'ed code with a custom error handler, use error_get_last() (PHP &gt;= 5.2.0).<br><br><span class="default">&lt;?php<br>$return </span><span class="keyword">= eval( </span><span class="string">'parse error' </span><span class="keyword">);<br><br>if ( </span><span class="default">$return </span><span class="keyword">=== </span><span class="default">false </span><span class="keyword">&amp;&amp; ( </span><span class="default">$error </span><span class="keyword">= </span><span class="default">error_get_last</span><span class="keyword">() ) ) {<br>&nbsp; &nbsp; </span><span class="default">myErrorHandler</span><span class="keyword">( </span><span class="default">$error</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">], </span><span class="default">$error</span><span class="keyword">[</span><span class="string">'message'</span><span class="keyword">], </span><span class="default">$error</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">], </span><span class="default">$error</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">], </span><span class="default">null </span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="comment">// Since the "execution of the following code continues normally", as stated in the manual,<br>&nbsp; &nbsp; // we still have to exit explicitly in case of an error<br>&nbsp; &nbsp; </span><span class="keyword">exit;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87296">  
  <a class="name">
  <strong class="user"><em>php at stock-consulting dot com</em></strong></a><div class="date" title="2008-11-28 08:16"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom87296">
<div class="phpcode"><code><span class="html">
Magic constants like __FILE__ may not return what you expect if used inside eval()'d code. Instead, it'll answer something like "c:\directory\filename.php(123) : eval()'d code" (under Windows, obviously, checked with PHP5.2.6) - which can still be processed with a function like preg_replace to receive the filename of the file containing the eval().
<br>
<br>Example:
<br>
<br><span class="default">&lt;?php
<br>$filename </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'@\(.*\(.*$@'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">__FILE__</span><span class="keyword">);
<br>echo </span><span class="default">$filename</span><span class="keyword">;
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84140">  
  <a class="name">
  <strong class="user"><em>marco at harddisk dot is-a-geek dot org</em></strong></a><div class="date" title="2008-06-30 10:44"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom84140">
<div class="phpcode"><code><span class="html">
eval does not work reliably in conjunction with global, at least not in the cygwin port version.<br><br>So:<br><span class="default">&lt;?PHP<br></span><span class="keyword">class </span><span class="default">foo </span><span class="keyword">{<br>&nbsp; </span><span class="comment">//my class...<br></span><span class="keyword">}<br>function </span><span class="default">load_module</span><span class="keyword">(</span><span class="default">$module</span><span class="keyword">) {<br>&nbsp; eval(</span><span class="string">"global \$"</span><span class="keyword">.</span><span class="default">$module</span><span class="keyword">.</span><span class="string">"_var;"</span><span class="keyword">);<br>&nbsp; eval(</span><span class="string">"\$"</span><span class="keyword">.</span><span class="default">$module</span><span class="keyword">.</span><span class="string">"_var=&amp;new foo();"</span><span class="keyword">);<br>&nbsp; </span><span class="comment">//various stuff ... ...<br></span><span class="keyword">}<br></span><span class="default">load_module</span><span class="keyword">(</span><span class="string">"foo"</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>becomes to working:<br><br><span class="default">&lt;?PHP<br></span><span class="keyword">class </span><span class="default">foo </span><span class="keyword">{<br>&nbsp; </span><span class="comment">//my class...<br></span><span class="keyword">}<br>function </span><span class="default">load_module</span><span class="keyword">(</span><span class="default">$module</span><span class="keyword">) {<br>&nbsp; eval(</span><span class="string">'$GLOBALS["'</span><span class="keyword">.</span><span class="default">$module</span><span class="keyword">.</span><span class="string">'_var"]=&amp;new foo();'</span><span class="keyword">);<br>&nbsp; </span><span class="comment">//various stuff ... ...<br></span><span class="keyword">}<br></span><span class="default">load_module</span><span class="keyword">(</span><span class="string">"foo"</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Note in the 2nd example, you _always_ need to use $GLOBALS[$module] to access the variable!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="81376">  
  <a class="name">
  <strong class="user"><em>Ipseno at yahoo dot com</em></strong></a><div class="date" title="2008-02-25 10:24"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom81376">
<div class="phpcode"><code><span class="html">
If you attempt to call a user defined function in eval() and .php files are obfuscated by Zend encoder, it will result in a fatal error.<br><br>Use a call_user_func() inside eval() to call your personal hand made functions.<br><br>This is user function<br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">square_it</span><span class="keyword">(</span><span class="default">$nmb</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; return </span><span class="default">$nmb </span><span class="keyword">* </span><span class="default">$nmb</span><span class="keyword">;<br>}<br><br></span><span class="default">?&gt;<br></span><br>//Checking if eval sees it?<br><span class="default">&lt;?php<br><br>$code </span><span class="keyword">= </span><span class="default">var_export</span><span class="keyword">( </span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'square_it'</span><span class="keyword">) );<br><br>eval( </span><span class="default">$code </span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">//returns TRUE - so yes it does!<br><br></span><span class="default">?&gt;<br></span><br>This will result in a fatal error:<br>PHP Fatal error:&nbsp; Call to undefined function square_it()<br><span class="default">&lt;?php<br><br>$code </span><span class="keyword">= </span><span class="string">'echo square_it(55);' </span><span class="keyword">;<br><br>eval( </span><span class="default">$code </span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>This will work<br><span class="default">&lt;?php<br><br>$code </span><span class="keyword">= </span><span class="string">'echo call_user_func(\'square_it\', 55);' </span><span class="keyword">;<br><br>eval( </span><span class="default">$code </span><span class="keyword">);<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="124863">  
  <a class="name">
  <strong class="user"><em>joseph at josephcz dot xyz</em></strong></a><div class="date" title="2020-03-29 02:42"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom124863">
<div class="phpcode"><code><span class="html">
In 2020, many people don't want to mix their PHP code and HTML, and they also think PHP itself is better than any template engines. But whenever you are making an template engine, use "include" to include your view file instead of using eval(). Many farmeworks are using this solution, such as Laravel.<br><br>If you rally want to eval a string, write them to a cached .php file first, then include it.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.eval.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:33:44 GMT -->

</body></html>
<html><!-- Mirrored from www.php.net/manual/en/function.mcrypt-decrypt.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 07:18:39 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>mcrypt_decrypt</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.mcrypt-decrypt.html">
 <link rel="shorturl" href="https://www.php.net/mcrypt-decrypt">
 <link rel="alternate" href="https://www.php.net/mcrypt-decrypt" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.mcrypt.html">
 <link rel="prev" href="function.mcrypt-create-iv.html">
 <link rel="next" href="function.mcrypt-enc-get-algorithms-name.html">

 <link rel="alternate" href="function.mcrypt-decrypt.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.mcrypt-decrypt.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.mcrypt-decrypt.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.mcrypt-decrypt.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.mcrypt-decrypt.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.mcrypt-decrypt.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.mcrypt-decrypt.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.mcrypt-decrypt.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.mcrypt-decrypt.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.mcrypt-decrypt.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.crypto.html">Cryptography Extensions</a></li>      <li><a href="book.mcrypt.html">Mcrypt</a></li>      <li><a href="ref.mcrypt.html">Mcrypt Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.mcrypt-decrypt" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mcrypt_decrypt</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.2, PHP 5, PHP 7 &lt; 7.2.0, PECL mcrypt &gt;= 1.0.0)</p><p class="refpurpose"><span class="refname">mcrypt_decrypt</span> — <span class="dc-title">Decrypts crypttext with given parameters</span></p>

 </div>
 <div id="function.mcrypt-decrypt-refsynopsisdiv">
  <div class="warning"><strong class="warning">Warning</strong><p class="simpara">This function has been
<em class="emphasis">DEPRECATED</em> as of PHP 7.1.0 and
<em class="emphasis">REMOVED</em> as of PHP 7.2.0. Relying on this function
is highly discouraged.</p></div>
 </div>
 <div class="refsect1 description" id="refsect1-function.mcrypt-decrypt-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mcrypt_decrypt</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$cipher</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$key</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$mode</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$iv</code><span class="initializer"> = ?</span></span><br>): <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   Decrypts the <code class="parameter">data</code> and returns the unencrypted data.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.mcrypt-decrypt-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    
     <dt>
<code class="parameter">cipher</code></dt>

     <dd>

      <p class="para">One of the <strong><code>MCRYPT_ciphername</code></strong> constants, or the name of the algorithm as string.</p>
     </dd>

    
    
     <dt>
<code class="parameter">key</code></dt>

     <dd>

      <p class="para">
       The key with which the data was encrypted. If the provided key size is
       not supported by the cipher, the function will emit a warning and return <strong><code>false</code></strong>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">data</code></dt>

     <dd>

      <p class="para">
       The data that will be decrypted with the given <code class="parameter">cipher</code>
       and <code class="parameter">mode</code>. If the size of the data is not n * blocksize,
       the data will be padded with '<code class="literal">\0</code>'.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">mode</code></dt>

     <dd>

      <p class="para">One of the <strong><code>MCRYPT_MODE_modename</code></strong> constants, or one of the following strings: "ecb", "cbc", "cfb", "ofb", "nofb" or "stream".</p>
     </dd>

    
    
     <dt>
<code class="parameter">iv</code></dt>

     <dd>

      <p class="para">Used for the initialization in CBC, CFB, OFB modes, and in some algorithms in STREAM mode. If the provided IV size is not supported by the chaining mode or no IV was provided, but the chaining mode requires one, the function will emit a warning and return <strong><code>false</code></strong>.</p>
     </dd>

    
   </dl>

  <p></p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.mcrypt-decrypt-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the decrypted data as a string  or <strong><code>false</code></strong> on failure.
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mcrypt-decrypt-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mcrypt-encrypt.html" class="function" rel="rdfs-seeAlso">mcrypt_encrypt()</a> - Encrypts plaintext with given parameters</span></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="54734">  
  <a class="name">
  <strong class="user"><em>eddiec at stararcher dot com</em></strong></a><div class="date" title="2005-07-13 06:26"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom54734">
<div class="phpcode"><code><span class="html">
It appears that mcrypt_decrypt pads the *RETURN STRING* with nulls ('\0') to fill out to n * blocksize.&nbsp; For old C-programmers, like myself, it is easy to believe the string ends at the first null.&nbsp; In PHP it does not:
<br>
<br>&nbsp; &nbsp; strlen("abc\0\0") returns 5 and *NOT* 3
<br>&nbsp; &nbsp; strcmp("abc", "abc\0\0") returns -2 and *NOT* 0
<br>
<br>I learned this lesson painfully when I passed a string returned from mycrypt_decrypt into a NuSoap message, which happily passed the nulls along to the receiver, who couldn't figure out what I was talking about.
<br>
<br>My solution was:
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; $retval </span><span class="keyword">= </span><span class="default">mcrypt_decrypt</span><span class="keyword">( ...</span><span class="default">etc </span><span class="keyword">...);
<br>&nbsp; &nbsp; </span><span class="default">$retval </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$retval</span><span class="keyword">, </span><span class="string">"\0"</span><span class="keyword">);&nbsp; &nbsp;&nbsp; </span><span class="comment">// trim ONLY the nulls at the END
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="121926">  
  <a class="name">
  <strong class="user"><em>gmmarco at outlook dot my</em></strong></a><div class="date" title="2017-11-28 05:43"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom121926">
<div class="phpcode"><code><span class="html">
Look at <a rel="nofollow" target="_blank">http://php.net/manual/en/function.openssl-decrypt.php</a> for a replacement. <br><br>Supports PHP 5 &gt;= 5.3.0, PHP 7</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86089">  
  <a class="name">
  <strong class="user"><em>david at sickmiller dot com</em></strong></a><div class="date" title="2008-10-02 10:15"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom86089">
<div class="phpcode"><code><span class="html">
If you happen to be decrypting something encrypted in ColdFusion, you'll discover that its encrypt function apparently pads the plaintext with ASCII 4, the "end of transmission" character.<br><br>Building on eddiec's code, you can remove both nulls and EOTs with this:<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; $retval </span><span class="keyword">= </span><span class="default">mcrypt_decrypt</span><span class="keyword">( ...</span><span class="default">etc </span><span class="keyword">...);<br>&nbsp; &nbsp; </span><span class="default">$retval </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$retval</span><span class="keyword">, </span><span class="string">"\0\4"</span><span class="keyword">);&nbsp; &nbsp;&nbsp; </span><span class="comment">// trim ONLY the nulls and EOTs at the END<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="118924">  
  <a class="name">
  <strong class="user"><em>pnz dot r00t at yandex dot ru</em></strong></a><div class="date" title="2016-02-29 11:44"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom118924">
<div class="phpcode"><code><span class="html">
When i using this function i find some problem, with adding additional binary symbols in decode message. <br>$sDecrypt – «2433091»<br>$sDecrypt strlen – 16 (before trim) <br>$sDecrypt – «2433091»<br>$sDecrypt strlen – 7 (after trim)<br>At local PC this problem solved by using trim/trim, but if I send my encrypt message to sever, and try encrypt them, I see that my message is not 16 symbols, as it was in my local pc, it is 32 sybmols, after encode. And trim function not working. I look at symbols code and what I see <br>&nbsp; &nbsp; 50<br>&nbsp; &nbsp; 52<br>&nbsp; &nbsp; 51<br>&nbsp; &nbsp; 51<br>&nbsp; &nbsp; 48<br>&nbsp; &nbsp; 57<br>&nbsp; &nbsp; 49<br>&nbsp; &nbsp; 0<br>&nbsp; &nbsp; 0<br>&nbsp; &nbsp; 0<br>&nbsp; &nbsp; 0<br>&nbsp; &nbsp; 0<br>&nbsp; &nbsp; 0<br>&nbsp; &nbsp; 0<br>&nbsp; &nbsp; 0<br>&nbsp; &nbsp; 0<br>&nbsp; &nbsp; 10<br>&nbsp; &nbsp; 158<br>&nbsp; &nbsp; 112<br>&nbsp; &nbsp; 183<br>&nbsp; &nbsp; 154<br>&nbsp; &nbsp; 27<br>&nbsp; &nbsp; 95<br>&nbsp; &nbsp; 85<br>&nbsp; &nbsp; 42<br>&nbsp; &nbsp; 35<br>&nbsp; &nbsp; 95<br>&nbsp; &nbsp; 54<br>&nbsp; &nbsp; 227<br>&nbsp; &nbsp; 41<br>&nbsp; &nbsp; 179<br>&nbsp; &nbsp; 77<br>After “tabulation symbols” I get some junk symbols, and&nbsp; I solve this problems like this.<br>After mcrypt_decrypt I use this code <br>$plaintext_dec = substr($plaintext_dec, 0, strpos($plaintext_dec, "\0"));<br>I think it is not best resolution for this problem, but I solve my problem :)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="105985">  
  <a class="name">
  <strong class="user"><em>beltrachi</em></strong></a><div class="date" title="2011-09-30 12:34"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom105985">
<div class="phpcode"><code><span class="html">
Caution, MCRYPT_RIJNDAEL_256 is not equivalent to AES_256.
<br>
<br>The way to make RIJNDAEL be decrypted from AES with openssl is to use MCRYPT_RIJNDAEL_128 and padd the string to encrypt before encrypting with the follwing function:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">pkcs5_pad </span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$blocksize</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$pad </span><span class="keyword">= </span><span class="default">$blocksize </span><span class="keyword">- (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) % </span><span class="default">$blocksize</span><span class="keyword">);
<br>&nbsp; &nbsp; return </span><span class="default">$text </span><span class="keyword">. </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="default">chr</span><span class="keyword">(</span><span class="default">$pad</span><span class="keyword">), </span><span class="default">$pad</span><span class="keyword">);
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>On the decryption, the choosing of AES_256 or AES_128, etc. is based on the keysize used in the crypting. In my case it was a 128bit key so I used AES_128.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103511">  
  <a class="name">
  <strong class="user"><em>evangelion207 at hotmail dot com</em></strong></a><div class="date" title="2011-04-17 08:24"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom103511">
<div class="phpcode"><code><span class="html">
Be careful, sometimes mcrypt_decrypt return additional white spaces to the uncrypted string; use trim() for deleting them. I was like 2 hours searching the error and it was that..</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101069">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2010-11-24 03:41"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom101069">
<div class="phpcode"><code><span class="html">
To remove PKCS7 padding:
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; $decrypted </span><span class="keyword">= </span><span class="default">mdecrypt_generic</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">, </span><span class="default">base64_decode</span><span class="keyword">(</span><span class="default">$enc_auth_token</span><span class="keyword">));
<br>&nbsp; &nbsp; </span><span class="default">$dec_s </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$decrypted</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$padding </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$decrypted</span><span class="keyword">[</span><span class="default">$dec_s</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">]);
<br>&nbsp; &nbsp; </span><span class="default">$decrypted </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$decrypted</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">$padding</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112242">  
  <a class="name">
  <strong class="user"><em>artaxerxes2 at iname dot com</em></strong></a><div class="date" title="2013-05-21 04:17"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom112242">
<div class="phpcode"><code><span class="html">
To decrypt data coming from MySQL's AES_ENCRYPT function:<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">mysql_aes_key</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$new_key </span><span class="keyword">= </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="default">chr</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">), </span><span class="default">16</span><span class="keyword">);<br>&nbsp; &nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$len</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$len</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new_key</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">%</span><span class="default">16</span><span class="keyword">] = </span><span class="default">$new_key</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">%</span><span class="default">16</span><span class="keyword">] ^ </span><span class="default">$key</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$new_key</span><span class="keyword">;<br>}<br><br>function </span><span class="default">aes_decrypt</span><span class="keyword">(</span><span class="default">$encrypted</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="comment">// if $encrypted is HEXed, then return it to binary<br>&nbsp; &nbsp; </span><span class="default">$encrypted </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">,</span><span class="default">$encrypted</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">mysql_aes_key</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">mcrypt_decrypt</span><span class="keyword">(</span><span class="default">MCRYPT_RIJNDAEL_128</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">,</span><span class="default">$encrypted</span><span class="keyword">,</span><span class="default">MCRYPT_MODE_ECB</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">),</span><span class="string">"\x00..\x1F"</span><span class="keyword">);<br>}<br><br></span><span class="default">?&gt;<br></span><br>adapted from the article "Replicating MySQL AES Encryption Methods With PHP" (dated 2012-05-20) found somewhere online.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.mcrypt-decrypt.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 07:18:39 GMT -->

</body></html>
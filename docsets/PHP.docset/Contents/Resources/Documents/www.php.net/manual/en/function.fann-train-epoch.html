<html><!-- Mirrored from www.php.net/manual/en/function.fann-train-epoch.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 08:33:59 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>fann_train_epoch</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.fann-train-epoch.html">
 <link rel="shorturl" href="https://www.php.net/fann-train-epoch">
 <link rel="alternate" href="https://www.php.net/fann-train-epoch" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.fann.html">
 <link rel="prev" href="function.fann-test.html">
 <link rel="next" href="function.fann-train-on-data.html">

 <link rel="alternate" href="function.fann-train-epoch.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.fann-train-epoch.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.fann-train-epoch.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.fann-train-epoch.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.fann-train-epoch.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.fann-train-epoch.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.fann-train-epoch.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.fann-train-epoch.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.fann-train-epoch.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.fann-train-epoch.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.other.html">Other Basic Extensions</a></li>      <li><a href="book.fann.html">FANN</a></li>      <li><a href="ref.fann.html">Fann Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.fann-train-epoch" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">fann_train_epoch</h1>
  <p class="verinfo">(PECL fann &gt;= 1.0.0)</p><p class="refpurpose"><span class="refname">fann_train_epoch</span> â€” <span class="dc-title">Train one epoch with a set of training data</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.fann-train-epoch-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>fann_train_epoch</strong></span>(<span class="methodparam"><span class="type">resource</span> <code class="parameter">$ann</code></span>, <span class="methodparam"><span class="type">resource</span> <code class="parameter">$data</code></span>): <span class="type">float</span></div>

  <p class="para rdfs-comment">
   Train one epoch with the training data stored in data. One epoch is
   where all of the training data is considered exactly once.
  </p>
  <p class="para">
   This function returns the MSE error as it is calculated either before or during the actual training.
   This is not the actual MSE after the training epoch, but since calculating this will require to go
   through the entire training set once more. It is more than adequate to use this value during training.
  </p>
  <p class="para">
   The training algorithm used by this function is chosen by <span class="function"><a href="function.fann-set-training-algorithm.html" class="function">fann_set_training_algorithm()</a></span>
   function.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.fann-train-epoch-parameters">
  <h3 class="title">Parameters</h3>
  <dl>
   
    <dt>
<code class="parameter">ann</code></dt>

    <dd>

     <p class="para">Neural network <span class="type">resource</span>.</p>
    </dd>

   
   
    <dt>
<code class="parameter">data</code></dt>

    <dd>

     <p class="para">Neural network training data <span class="type">resource</span>.</p>
    </dd>

   
  </dl>

 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.fann-train-epoch-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   The MSE, or <strong><code>false</code></strong> on error.
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.fann-train-epoch-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.fann-train-on-data.html" class="function" rel="rdfs-seeAlso">fann_train_on_data()</a> - Trains on an entire dataset for a period of time</span></li>
    <li class="member"><span class="function"><a href="function.fann-test-data.html" class="function" rel="rdfs-seeAlso">fann_test_data()</a> - Test a set of training data and calculates the MSE for the training data</span></li>
    <li class="member"><span class="function"><a href="function.fann-get-mse.html" class="function" rel="rdfs-seeAlso">fann_get_MSE()</a> - Reads the mean square error from the network</span></li>
    <li class="member"><span class="function"><a href="function.fann-set-training-algorithm.html" class="function" rel="rdfs-seeAlso">fann_set_training_algorithm()</a> - Sets the training algorithm</span></li>
   </ul>
  <p></p>
 </div>



</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="123271">  
  <a class="name">
  <strong class="user"><em>geekgirljoy at gmail dot com</em></strong></a><div class="date" title="2018-10-29 02:26"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom123271">
<div class="phpcode"><code><span class="html">
This code demonstrates training XOR using fann_train_epoch and will let you watch the training process by observing a psudo MSE (mean squared error).<br><br>Other training functions: fann_train_on_data, fann_train_on_file, fann_train.<br><br>fann_train_epoch is useful when you want to observe the ANN while it is training and perhaps save snapshots or compare competing networks during training. <br><br>fann_train_epoch is different from fann_train in that it takes a data resource (training file) whereas fann_train takes an array of inputs and a separate array of outputs so use fann_train_epoch for observing training on data files (callback training resources) and use fann_train when observing manually specified data. <br><br>Example code: <br><br><span class="default">&lt;?php<br>$num_input </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br></span><span class="default">$num_output </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br></span><span class="default">$num_layers </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">; <br></span><span class="default">$num_neurons_hidden </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">; <br></span><span class="default">$desired_error </span><span class="keyword">= </span><span class="default">0.0001</span><span class="keyword">;<br></span><span class="default">$max_epochs </span><span class="keyword">= </span><span class="default">500000</span><span class="keyword">;<br></span><span class="default">$current_epoch </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br></span><span class="default">$epochs_between_saves </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">; </span><span class="comment">// Minimum number of epochs between saves<br></span><span class="default">$epochs_since_last_save </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br></span><span class="default">$filename </span><span class="keyword">= </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">) . </span><span class="string">"/xor.data"</span><span class="keyword">;<br><br></span><span class="comment">// Initialize psudo mse (mean squared error) to a number greater than the desired_error<br>// this is what the network is trying to minimize.<br></span><span class="default">$psudo_mse_result </span><span class="keyword">= </span><span class="default">$desired_error </span><span class="keyword">* </span><span class="default">10000</span><span class="keyword">; </span><span class="comment">// 1<br></span><span class="default">$best_mse </span><span class="keyword">= </span><span class="default">$psudo_mse_result</span><span class="keyword">; </span><span class="comment">// keep the last best seen MSE network score here<br><br>// Initialize ANN<br></span><span class="default">$ann </span><span class="keyword">= </span><span class="default">fann_create_standard</span><span class="keyword">(</span><span class="default">$num_layers</span><span class="keyword">, </span><span class="default">$num_input</span><span class="keyword">, </span><span class="default">$num_neurons_hidden</span><span class="keyword">, </span><span class="default">$num_output</span><span class="keyword">);<br><br>if (</span><span class="default">$ann</span><span class="keyword">) {<br>&nbsp; echo </span><span class="string">'Training ANN... ' </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">; <br>&nbsp; <br>&nbsp; </span><span class="comment">// Configure the ANN<br>&nbsp; </span><span class="default">fann_set_training_algorithm </span><span class="keyword">(</span><span class="default">$ann </span><span class="keyword">, </span><span class="default">FANN_TRAIN_BATCH</span><span class="keyword">);<br>&nbsp; </span><span class="default">fann_set_activation_function_hidden</span><span class="keyword">(</span><span class="default">$ann</span><span class="keyword">, </span><span class="default">FANN_SIGMOID_SYMMETRIC</span><span class="keyword">);<br>&nbsp; </span><span class="default">fann_set_activation_function_output</span><span class="keyword">(</span><span class="default">$ann</span><span class="keyword">, </span><span class="default">FANN_SIGMOID_SYMMETRIC</span><span class="keyword">);<br>&nbsp; <br>&nbsp; </span><span class="comment">// Read training data<br>&nbsp; </span><span class="default">$train_data </span><span class="keyword">= </span><span class="default">fann_read_train_from_file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">);<br>&nbsp; <br>&nbsp; <br>&nbsp; </span><span class="comment">// Check if psudo_mse_result is greater than our desired_error <br>&nbsp; // if so keep training so long as we are also under max_epochs<br>&nbsp; </span><span class="keyword">while((</span><span class="default">$psudo_mse_result </span><span class="keyword">&gt; </span><span class="default">$desired_error</span><span class="keyword">) &amp;&amp; (</span><span class="default">$current_epoch </span><span class="keyword">&lt;= </span><span class="default">$max_epochs</span><span class="keyword">)){<br>&nbsp; &nbsp; </span><span class="default">$current_epoch</span><span class="keyword">++;<br>&nbsp; &nbsp; </span><span class="default">$epochs_since_last_save</span><span class="keyword">++;&nbsp; <br>&nbsp; <br>&nbsp; &nbsp; </span><span class="comment">// See: <a rel="nofollow" target="_blank">http://php.net/manual/en/function.fann-train-epoch.php</a><br>&nbsp; &nbsp; // Train one epoch with the training data stored in data. <br>&nbsp; &nbsp; //<br>&nbsp; &nbsp; // One epoch is where all of the training data is considered <br>&nbsp; &nbsp; // exactly once.<br>&nbsp; &nbsp; //<br>&nbsp; &nbsp; // This function returns the MSE error as it is calculated <br>&nbsp; &nbsp; // either before or during the actual training. This is not the <br>&nbsp; &nbsp; // actual MSE after the training epoch, but since calculating this <br>&nbsp; &nbsp; // will require to go through the entire training set once more. <br>&nbsp; &nbsp; // It is more than adequate to use this value during training.<br>&nbsp; &nbsp; </span><span class="default">$psudo_mse_result </span><span class="keyword">= </span><span class="default">fann_train_epoch </span><span class="keyword">(</span><span class="default">$ann </span><span class="keyword">, </span><span class="default">$train_data </span><span class="keyword">);<br>&nbsp; &nbsp; echo </span><span class="string">'Epoch ' </span><span class="keyword">. </span><span class="default">$current_epoch </span><span class="keyword">. </span><span class="string">' : ' </span><span class="keyword">. </span><span class="default">$psudo_mse_result </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">; </span><span class="comment">// report<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; // If we haven't saved the ANN in a while...<br>&nbsp; &nbsp; // and the current network is better then the previous best network<br>&nbsp; &nbsp; // as defined by the current MSE being less than the last best MSE<br>&nbsp; &nbsp; // Save it!<br>&nbsp; &nbsp; </span><span class="keyword">if((</span><span class="default">$epochs_since_last_save </span><span class="keyword">&gt;= </span><span class="default">$epochs_between_saves</span><span class="keyword">) &amp;&amp; (</span><span class="default">$psudo_mse_result </span><span class="keyword">&lt; </span><span class="default">$best_mse</span><span class="keyword">)){<br>&nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; </span><span class="default">$best_mse </span><span class="keyword">= </span><span class="default">$psudo_mse_result</span><span class="keyword">; </span><span class="comment">// we have a new best_mse<br>&nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; // Save a Snapshot of the ANN<br>&nbsp; &nbsp; &nbsp; </span><span class="default">fann_save</span><span class="keyword">(</span><span class="default">$ann</span><span class="keyword">, </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">) . </span><span class="string">"/xor.net"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; echo </span><span class="string">'Saved ANN.' </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">; </span><span class="comment">// report the save<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$epochs_since_last_save </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="comment">// reset the count<br>&nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; <br>&nbsp; } </span><span class="comment">// While we're training<br><br>&nbsp; </span><span class="keyword">echo </span><span class="string">'Training Complete! Saving Final Network.'&nbsp; </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br>&nbsp; <br>&nbsp; </span><span class="comment">// Save the final network<br>&nbsp; </span><span class="default">fann_save</span><span class="keyword">(</span><span class="default">$ann</span><span class="keyword">, </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">) . </span><span class="string">"/xor.net"</span><span class="keyword">);&nbsp; <br>&nbsp; </span><span class="default">fann_destroy</span><span class="keyword">(</span><span class="default">$ann</span><span class="keyword">); </span><span class="comment">// free memory<br></span><span class="keyword">}<br>echo </span><span class="string">'All Done!' </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.fann-train-epoch.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 08:33:59 GMT -->

</body></html>
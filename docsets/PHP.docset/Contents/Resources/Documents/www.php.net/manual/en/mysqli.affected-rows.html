<html><!-- Mirrored from www.php.net/manual/en/mysqli.affected-rows.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 10:32:20 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>mysqli::$affected_rows</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="mysqli.affected-rows.html">
 <link rel="shorturl" href="mysqli.affected-rows.html">
 <link rel="alternate" href="mysqli.affected-rows.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="class.mysqli.html">
 <link rel="prev" href="class.mysqli.html">
 <link rel="next" href="mysqli.autocommit.html">

 <link rel="alternate" href="mysqli.affected-rows.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/mysqli.affected-rows.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/mysqli.affected-rows.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/mysqli.affected-rows.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/mysqli.affected-rows.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/mysqli.affected-rows.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/mysqli.affected-rows.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/mysqli.affected-rows.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/mysqli.affected-rows.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/mysqli.affected-rows.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.vendors.html">Vendor Specific Database Extensions</a></li>      <li><a href="set.mysqlinfo.html">MySQL</a></li>      <li><a href="book.mysqli.html">MySQLi</a></li>      <li><a href="class.mysqli.html">mysqli</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="mysqli.affected-rows" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysqli::$affected_rows</h1>
  <h1 class="refname">mysqli_affected_rows</h1>
  <p class="verinfo">(PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">mysqli::$affected_rows</span> -- <span class="refname">mysqli_affected_rows</span> â€” <span class="dc-title">Gets the number of affected rows in a previous MySQL operation</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-mysqli.affected-rows-description">
  <h3 class="title">Description</h3>
  <p class="para">Object-oriented style</p>
  <div class="fieldsynopsis"><span class="type">int</span> <var class="varname"><a href="mysqli.affected-rows.html">$mysqli-&gt;affected_rows</a></var>;</div>

  <p class="para">Procedural style</p>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mysqli_affected_rows</strong></span>(<span class="methodparam"><span class="type"><a href="class.mysqli.html" class="type mysqli">mysqli</a></span> <code class="parameter">$mysql</code></span>): <span class="type"><span class="type">int</span>|<span class="type">string</span></span></div>

  <p class="para rdfs-comment">
   Returns the number of rows affected by the last <code class="literal">INSERT</code>,
   <code class="literal">UPDATE</code>, <code class="literal">REPLACE</code> or 
   <code class="literal">DELETE</code> query.
   Works like <span class="function"><a href="mysqli-result.num-rows.html" class="function">mysqli_num_rows()</a></span> for
   <code class="literal">SELECT</code> statements.
  </p>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-mysqli.affected-rows-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    <dt>
<code class="parameter">
mysql</code></dt>
<dd>
<p class="para">Procedural style only: A <span class="classname"><a href="class.mysqli.html" class="classname">mysqli</a></span> object
returned by <span class="function"><a href="function.mysqli-connect.html" class="function">mysqli_connect()</a></span> or <span class="function"><a href="mysqli.init.html" class="function">mysqli_init()</a></span>
</p></dd>

   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-mysqli.affected-rows-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   An integer greater than zero indicates the number of rows affected or
   retrieved. Zero indicates that no records were updated for an 
   <code class="literal">UPDATE</code> statement, no rows matched the
   <code class="literal">WHERE</code> clause in the query or that no query has yet been
   executed. <code class="literal">-1</code> indicates that the query returned an error or
   that <span class="function"><strong>mysqli_affected_rows()</strong></span> was called for an unbuffered
   <code class="literal">SELECT</code> query.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    If the number of affected rows is greater than the maximum int value
    (<strong><code>PHP_INT_MAX</code></strong>), the number of affected rows will be
    returned as a string.
   </p>
  <p></p></blockquote>
 </div>


 <div class="refsect1 examples" id="refsect1-mysqli.affected-rows-examples">
  <h3 class="title">Examples</h3>
  <div class="example" id="example-1374">
   <p><strong>Example #1 <var class="varname">$mysqli-&gt;affected_rows</var> example</strong></p>
   <div class="example-contents"><p>Object-oriented style</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>mysqli_report</span><span style="color: #007700">(</span><span style="color: #0000BB">MYSQLI_REPORT_ERROR&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">MYSQLI_REPORT_STRICT</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$mysqli&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"my_user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"my_password"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"world"</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&nbsp;Insert&nbsp;rows&nbsp;*/<br></span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"CREATE&nbsp;TABLE&nbsp;Language&nbsp;SELECT&nbsp;*&nbsp;from&nbsp;CountryLanguage"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Affected&nbsp;rows&nbsp;(INSERT):&nbsp;%d\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">affected_rows</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"ALTER&nbsp;TABLE&nbsp;Language&nbsp;ADD&nbsp;Status&nbsp;int&nbsp;default&nbsp;0"</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&nbsp;update&nbsp;rows&nbsp;*/<br></span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"UPDATE&nbsp;Language&nbsp;SET&nbsp;Status=1&nbsp;WHERE&nbsp;Percentage&nbsp;&gt;&nbsp;50"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Affected&nbsp;rows&nbsp;(UPDATE):&nbsp;%d\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">affected_rows</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&nbsp;delete&nbsp;rows&nbsp;*/<br></span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"DELETE&nbsp;FROM&nbsp;Language&nbsp;WHERE&nbsp;Percentage&nbsp;&lt;&nbsp;50"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Affected&nbsp;rows&nbsp;(DELETE):&nbsp;%d\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">affected_rows</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&nbsp;select&nbsp;all&nbsp;rows&nbsp;*/<br></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;CountryCode&nbsp;FROM&nbsp;Language"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Affected&nbsp;rows&nbsp;(SELECT):&nbsp;%d\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">affected_rows</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&nbsp;Delete&nbsp;table&nbsp;Language&nbsp;*/<br></span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"DROP&nbsp;TABLE&nbsp;Language"</span><span style="color: #007700">);</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>Procedural style</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>mysqli_report</span><span style="color: #007700">(</span><span style="color: #0000BB">MYSQLI_REPORT_ERROR&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">MYSQLI_REPORT_STRICT</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"my_user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"my_password"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"world"</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&nbsp;Insert&nbsp;rows&nbsp;*/<br></span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"CREATE&nbsp;TABLE&nbsp;Language&nbsp;SELECT&nbsp;*&nbsp;from&nbsp;CountryLanguage"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Affected&nbsp;rows&nbsp;(INSERT):&nbsp;%d\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">mysqli_affected_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">));<br><br></span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"ALTER&nbsp;TABLE&nbsp;Language&nbsp;ADD&nbsp;Status&nbsp;int&nbsp;default&nbsp;0"</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&nbsp;update&nbsp;rows&nbsp;*/<br></span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"UPDATE&nbsp;Language&nbsp;SET&nbsp;Status=1&nbsp;WHERE&nbsp;Percentage&nbsp;&gt;&nbsp;50"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Affected&nbsp;rows&nbsp;(UPDATE):&nbsp;%d\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">mysqli_affected_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">));<br><br></span><span style="color: #FF8000">/*&nbsp;delete&nbsp;rows&nbsp;*/<br></span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"DELETE&nbsp;FROM&nbsp;Language&nbsp;WHERE&nbsp;Percentage&nbsp;&lt;&nbsp;50"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Affected&nbsp;rows&nbsp;(DELETE):&nbsp;%d\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">mysqli_affected_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">));<br><br></span><span style="color: #FF8000">/*&nbsp;select&nbsp;all&nbsp;rows&nbsp;*/<br></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;CountryCode&nbsp;FROM&nbsp;Language"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Affected&nbsp;rows&nbsp;(SELECT):&nbsp;%d\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">mysqli_affected_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">));<br><br></span><span style="color: #FF8000">/*&nbsp;Delete&nbsp;table&nbsp;Language&nbsp;*/<br></span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"DROP&nbsp;TABLE&nbsp;Language"</span><span style="color: #007700">);</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>The above examples will output:</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>Affected rows (INSERT): 984
Affected rows (UPDATE): 168
Affected rows (DELETE): 815
Affected rows (SELECT): 169
</pre></div>
   </div>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-mysqli.affected-rows-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="mysqli-result.num-rows.html" class="function" rel="rdfs-seeAlso">mysqli_num_rows()</a> - Gets the number of rows in the result set</span></li>
    <li class="member"><span class="function"><a href="mysqli.info.html" class="function" rel="rdfs-seeAlso">mysqli_info()</a> - Retrieves information about the most recently executed query</span></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="102523">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2011-02-18 02:50"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom102523">
<div class="phpcode"><code><span class="html">
On "INSERT INTO ON DUPLICATE KEY UPDATE" queries, though one may expect affected_rows to return only 0 or 1 per row on successful queries, it may in fact return 2.<br><br>From Mysql manual: "With ON DUPLICATE KEY UPDATE, the affected-rows value per row is 1 if the row is inserted as a new row and 2 if an existing row is updated."<br><br>See: <a rel="nofollow" target="_blank">http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html</a><br><br>Here's the sum breakdown _per row_:<br>+0: a row wasn't updated or inserted (likely because the row already existed, but no field values were actually changed during the UPDATE)<br>+1: a row was inserted<br>+2: a row was updated</span>
</code></div>
  </div>
 </div>
  <div class="note" id="120963">  
  <a class="name">
  <strong class="user"><em>Jacques Amar</em></strong></a><div class="date" title="2017-04-10 04:07"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom120963">
<div class="phpcode"><code><span class="html">
While using prepared statements, even if there is no result set (Like in an UPDATE or DELETE), you still need to store the results before affected_rows returns the actual number:<br><br><span class="default">&lt;?php<br>$del_stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br></span><span class="default">$del_stmt</span><span class="keyword">-&gt;</span><span class="default">store_result</span><span class="keyword">();<br></span><span class="default">$count </span><span class="keyword">= </span><span class="default">$del_stmt</span><span class="keyword">-&gt;</span><span class="default">affected_rows</span><span class="keyword">;<br></span><span class="default">?&gt;<br></span><br>Otherwise things will just be frustrating ..</span>
</code></div>
  </div>
 </div>
  <div class="note" id="116152">  
  <a class="name">
  <strong class="user"><em>Michael</em></strong></a><div class="date" title="2014-11-15 06:35"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom116152">
<div class="phpcode"><code><span class="html">
If you need to know specifically whether the WHERE condition of an UPDATE operation failed to match rows, or that simply no rows required updating you need to instead check mysqli::$info.<br><br>As this returns a string that requires parsing, you can use the following to convert the results into an associative array.<br><br>Object oriented style:<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; preg_match_all </span><span class="keyword">(</span><span class="string">'/(\S[^:]+): (\d+)/'</span><span class="keyword">, </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">info</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">); <br>&nbsp; &nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">array_combine </span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br></span><span class="default">?&gt;<br></span><br>Procedural style:<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; preg_match_all </span><span class="keyword">(</span><span class="string">'/(\S[^:]+): (\d+)/'</span><span class="keyword">, </span><span class="default">mysqli_info </span><span class="keyword">(</span><span class="default">$link</span><span class="keyword">), </span><span class="default">$matches</span><span class="keyword">); <br>&nbsp; &nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">array_combine </span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br></span><span class="default">?&gt;<br></span><br>You can then use the array to test for the different conditions<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">$info </span><span class="keyword">[</span><span class="string">'Rows matched'</span><span class="keyword">] == </span><span class="default">0</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"This operation did not match any rows.\n"</span><span class="keyword">;<br>&nbsp; &nbsp; } elseif (</span><span class="default">$info </span><span class="keyword">[</span><span class="string">'Changed'</span><span class="keyword">] == </span><span class="default">0</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"This operation matched rows, but none required updating.\n"</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; if (</span><span class="default">$info </span><span class="keyword">[</span><span class="string">'Changed'</span><span class="keyword">] &lt; </span><span class="default">$info </span><span class="keyword">[</span><span class="string">'Rows matched'</span><span class="keyword">]) {<br>&nbsp; &nbsp; &nbsp; &nbsp; echo (</span><span class="default">$info </span><span class="keyword">[</span><span class="string">'Rows matched'</span><span class="keyword">] - </span><span class="default">$info </span><span class="keyword">[</span><span class="string">'Changed'</span><span class="keyword">]).</span><span class="string">" rows matched but were not changed.\n"</span><span class="keyword">;<br>&nbsp; &nbsp; }<br></span><span class="default">?&gt;<br></span><br>This approach can be used with any query that mysqli::$info supports (INSERT INTO, LOAD DATA, ALTER TABLE, and UPDATE), for other any queries it returns an empty array.<br><br>For any UPDATE operation the array returned will have the following elements:<br><br>Array<br>(<br>&nbsp; &nbsp; [Rows matched] =&gt; 1<br>&nbsp; &nbsp; [Changed] =&gt; 0<br>&nbsp; &nbsp; [Warnings] =&gt; 0<br>)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115180">  
  <a class="name">
  <strong class="user"><em>fastest963 at gmail dot com</em></strong></a><div class="date" title="2014-06-10 05:50"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom115180">
<div class="phpcode"><code><span class="html">
empty($db-&gt;affected_rows) will return TRUE even if affected_rows is greater than 0. Manually check &lt; 1 if you're looking for failure.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="118435">  
  <a class="name">
  <strong class="user"><em>anonymous</em></strong></a><div class="date" title="2015-12-04 10:48"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom118435">
<div class="phpcode"><code><span class="html">
This may seem obvious, but if you do an UPDATE with each of the values in your SET clause having the exact same value that is already in the table, then affected_rows returns 0.&nbsp; For example:<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; $mysqli </span><span class="keyword">= new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$usr</span><span class="keyword">, </span><span class="default">$pwd</span><span class="keyword">, </span><span class="default">$db</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$appointment_date </span><span class="keyword">= </span><span class="string">"2015-12-07"</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$sql </span><span class="keyword">= </span><span class="string">"update appointments set appointment_date = ? where appointment_id = 78"</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">bind_param</span><span class="keyword">(</span><span class="string">"s"</span><span class="keyword">,</span><span class="default">$appointment_date</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br>&nbsp; &nbsp; echo </span><span class="default">$mysqli </span><span class="keyword">-&gt;</span><span class="default">affected_rows </span><span class="keyword">. </span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br></span><span class="default">?&gt;<br></span><br>This returns 1 the first time I run it after changing the value of the $appointment_date variable.&nbsp; When I run it a second time (making no changes), it returns 0.&nbsp; I also verified the same behavior without using prepared statements.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="94612">  
  <a class="name">
  <strong class="user"><em>oilpc at oilpc dot com</em></strong></a><div class="date" title="2009-11-14 10:06"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom94612">
<div class="phpcode"><code><span class="html">
For "INSERT" or "UPDATE" statement for modifying data contained in one row of one table I checked if number of affected rows equals 1 to determine success of the operation. It works fine both for errors and false value of WHERE condition (that might be generated according to specific application user acces privileges).<br><span class="default">&lt;?php<br></span><span class="keyword">if (</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">affected_rows</span><span class="keyword">==</span><span class="default">1</span><span class="keyword">){<br>&nbsp; &nbsp; echo </span><span class="string">"success"</span><span class="keyword">;<br>}<br>else {<br>&nbsp; &nbsp; echo </span><span class="string">"fail"</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;<br></span><br>Checking if mysqli-&gt;affected_rows will equal -1 or not is not a good method of determining success of "INSERT IGNORE" statements. Example: Ignoring duplicate key errors while inserting some rows containing data provided by user only if they will match specified unique constraint causes returning of -1 value by mysqli-&gt;affected_rows even if rows were inserted. (checked on MySQL 5.0.85 linux and php 5.2.9-2 windows). However mysqli-&gt;sqlstate returns no error if statement was executed successfully.<br><span class="default">&lt;?php<br></span><span class="keyword">if (</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">affected_rows</span><span class="keyword">!=-</span><span class="default">1</span><span class="keyword">){<br>&nbsp; &nbsp; echo </span><span class="string">"success"</span><span class="keyword">;</span><span class="comment">// for "INSERT IGNORE" statements will not occur if there were any duplicate key errors ignored during execution of the query<br></span><span class="keyword">}<br>else {<br>&nbsp; &nbsp; echo </span><span class="string">"fail"</span><span class="keyword">;</span><span class="comment">// "INSERT IGNORE" statements causing any duplicate key errors (however ignored) lead to mysqli-&gt;affected_rows equal -1<br></span><span class="keyword">}<br><br></span><span class="comment">// Example below works for "INSERT IGNORE" stattements, too<br></span><span class="keyword">if (</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">sqlstate</span><span class="keyword">==</span><span class="string">"00000"</span><span class="keyword">){<br>&nbsp; &nbsp; echo </span><span class="string">"success"</span><span class="keyword">;<br>}<br>else {<br>&nbsp; &nbsp; echo </span><span class="string">"fail"</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/mysqli.affected-rows.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 10:32:20 GMT -->

</body></html>
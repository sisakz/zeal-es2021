<html><!-- Mirrored from www.php.net/manual/en/function.imagecreatefrompng.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:20:14 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>imagecreatefrompng</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.imagecreatefrompng.html">
 <link rel="shorturl" href="https://www.php.net/imagecreatefrompng">
 <link rel="alternate" href="https://www.php.net/imagecreatefrompng" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.image.html">
 <link rel="prev" href="function.imagecreatefromjpeg.html">
 <link rel="next" href="function.imagecreatefromstring.html">

 <link rel="alternate" href="function.imagecreatefrompng.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.imagecreatefrompng.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.imagecreatefrompng.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.imagecreatefrompng.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.imagecreatefrompng.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.imagecreatefrompng.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.imagecreatefrompng.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.imagecreatefrompng.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.imagecreatefrompng.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.imagecreatefrompng.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.utilspec.image.html">Image Processing and Generation</a></li>      <li><a href="book.image.html">GD</a></li>      <li><a href="ref.image.html">GD and Image Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.imagecreatefrompng" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imagecreatefrompng</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">imagecreatefrompng</span> â€” <span class="dc-title">Create a new image from file or URL</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imagecreatefrompng-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>imagecreatefrompng</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>): <span class="type"><span class="type"><a href="class.gdimage.html" class="type GdImage">GdImage</a></span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>imagecreatefrompng()</strong></span> returns an image identifier
   representing the image obtained from the given filename.
  </p>
  <div class="tip"><strong class="tip">Tip</strong><p class="simpara">A URL can be used as a
filename with this function if the <a href="filesystem.configuration.html#ini.allow-url-fopen" class="link">fopen wrappers</a> have been enabled.
See <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span> for more details on how to specify the
filename. See the <a href="wrappers.html" class="xref">Supported Protocols and Wrappers</a> for links to information
about what abilities the various wrappers have, notes on their usage,
and information on any predefined variables they may
provide.</p></div>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imagecreatefrompng-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    
     <dt>
<code class="parameter">filename</code></dt>

     <dd>

      <p class="para">
       Path to the PNG image.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imagecreatefrompng-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">Returns an image object on success, <strong><code>false</code></strong> on errors.</p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.imagecreatefrompng-changelog">
  <h3 class="title">Changelog</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>Version</th>
      <th>Description</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       On success, this function returns a <span class="classname"><a href="class.gdimage.html" class="classname">GDImage</a></span> instance now;
       previously, a <span class="type">resource</span> was returned.
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.imagecreatefrompng-examples">
  <h3 class="title">Examples</h3>
  <div class="example" id="example-2600">
   <p><strong>Example #1 Example to handle an error during loading of a PNG</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">LoadPNG</span><span style="color: #007700">(</span><span style="color: #0000BB">$imgname</span><span style="color: #007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Attempt&nbsp;to&nbsp;open&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">=&nbsp;@</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #0000BB">$imgname</span><span style="color: #007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;See&nbsp;if&nbsp;it&nbsp;failed&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(!</span><span style="color: #0000BB">$im</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Create&nbsp;a&nbsp;blank&nbsp;image&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$im&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatetruecolor</span><span style="color: #007700">(</span><span style="color: #0000BB">150</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">30</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$bgc&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$tc&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagefilledrectangle</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">150</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">30</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$bgc</span><span style="color: #007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Output&nbsp;an&nbsp;error&nbsp;message&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagestring</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Error&nbsp;loading&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$imgname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$tc</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$im</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Content-Type:&nbsp;image/png'</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$img&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">LoadPNG</span><span style="color: #007700">(</span><span style="color: #DD0000">'bogus.image'</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$img</span><span style="color: #007700">);<br></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$img</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>The above example will output
something similar to:</p></div>
   <div class="mediaobject">
    
    <div class="imageobject">
     <img src="images/21009b70229598c6a80eef8b45bf282b-imagecreatefrompng.png" alt="imagecreatefrompng() example" width="150" height="30">
    </div>
   </div>
  </div>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="43024">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2004-06-07 04:14"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom43024">
<div class="phpcode"><code><span class="html">
If you're trying to load a translucent png-24 image but are finding an absence of transparency (like it's black), you need to enable alpha channel AND save the setting. I'm new to GD and it took me almost two hours to figure this out.<br><br><span class="default">&lt;?php<br>$imgPng </span><span class="keyword">= </span><span class="default">imageCreateFromPng</span><span class="keyword">(</span><span class="default">$strImagePath</span><span class="keyword">);<br></span><span class="default">imageAlphaBlending</span><span class="keyword">(</span><span class="default">$imgPng</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br></span><span class="default">imageSaveAlpha</span><span class="keyword">(</span><span class="default">$imgPng</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br><br></span><span class="comment">/* Output image to browser */<br></span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br></span><span class="default">imagePng</span><span class="keyword">(</span><span class="default">$imgPng</span><span class="keyword">); <br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73546">  
  <a class="name">
  <strong class="user"><em>marcos at assl-site dot net</em></strong></a><div class="date" title="2007-02-28 12:23"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom73546">
<div class="phpcode"><code><span class="html">
I had the same problem as jboyd1189 at yahoo dot com but I solve d it allocating more memory dynamically.<br><br>Usually the memory_limit var on php.ini is set to 8M. Unfortunately, the required amount of memory to manage a PNG image about 1000x1000 could be bigger !<br><br>The approach I used to solve the problem is:<br><br>1-Calculate the memory required by the image<br>2-Set the new memory_limit value <br>3-Create the PNG image and thumbnail<br>4-Restore the original value<br><br>1-The following value works for me:<br>$required_memory = Round($width * $height * $size['bits']);<br><br>Note that for JPEG the requirements are not the same:<br><a rel="nofollow" target="_blank">http://es2.php.net/manual/en/function.imagecreatefromjpeg.php#60241</a><br><br>2-Use somthing like: <br>$new_limit=memory_get_usage() + $required_memory;<br>ini_set("memory_limit", $new_limit);<br><br>4-ini_restore ("memory_limit");</span>
</code></div>
  </div>
 </div>
  <div class="note" id="126300">  
  <a class="name">
  <strong class="user"><em>sageptr at gmail dot com</em></strong></a><div class="date" title="2021-08-02 07:58"><strong>1 month ago</strong></div>
  <div class="text" id="Hcom126300">
<div class="phpcode"><code><span class="html">
Because gd and imagick do not support animated PNG (at this moment), i wrote a simple function to determine if given PNG is APNG or not. It does not validate PNG, only checks whenever "acTL" chunk appears before "IDAT" like the specification says: <a rel="nofollow" target="_blank">https://wiki.mozilla.org/APNG_Specification</a><br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">is_apng</span><span class="keyword">(</span><span class="default">string $filename</span><span class="keyword">): </span><span class="default">bool<br></span><span class="keyword">{<br>&nbsp; &nbsp; </span><span class="default">$f </span><span class="keyword">= new \</span><span class="default">SplFileObject</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">'rb'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="default">$f</span><span class="keyword">-&gt;</span><span class="default">fread</span><span class="keyword">(</span><span class="default">8</span><span class="keyword">);<br>&nbsp; &nbsp; if (</span><span class="default">$header </span><span class="keyword">!== </span><span class="string">"\x89PNG\r\n\x1A\n"</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; while (!</span><span class="default">$f</span><span class="keyword">-&gt;</span><span class="default">eof</span><span class="keyword">()) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$bytes </span><span class="keyword">=&nbsp; </span><span class="default">$f</span><span class="keyword">-&gt;</span><span class="default">fread</span><span class="keyword">(</span><span class="default">4</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$bytes</span><span class="keyword">) &lt; </span><span class="default">4</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'N'</span><span class="keyword">, </span><span class="default">$bytes</span><span class="keyword">)[</span><span class="default">1</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$chunkname </span><span class="keyword">= </span><span class="default">$f</span><span class="keyword">-&gt;</span><span class="default">fread</span><span class="keyword">(</span><span class="default">4</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; switch (</span><span class="default">$chunkname</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'acTL'</span><span class="keyword">:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'IDAT'</span><span class="keyword">:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$f</span><span class="keyword">-&gt;</span><span class="default">fseek</span><span class="keyword">(</span><span class="default">$length </span><span class="keyword">+ </span><span class="default">4</span><span class="keyword">, </span><span class="default">SEEK_CUR</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90364">  
  <a class="name">
  <strong class="user"><em>admin at wdfa dot co dot uk</em></strong></a><div class="date" title="2009-04-17 03:06"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom90364">
<div class="phpcode"><code><span class="html">
When using imagecreatepng with alpha blending you will lose the blending.<br><br>To over come this use something like the following<br><span class="default">&lt;?php<br>$dstimage</span><span class="keyword">=</span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">);<br></span><span class="default">$srcimage</span><span class="keyword">=</span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">);<br></span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$dstimage</span><span class="keyword">,</span><span class="default">$srcimage</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">,</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>Where $width and $height are the width and height of the $src image.<br><br>This will create a true colour image then copy the png image to this true colour image and retain alpha blending.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="118146">  
  <a class="name">
  <strong class="user"><em>Cyrille37</em></strong></a><div class="date" title="2015-10-13 11:00"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom118146">
<div class="phpcode"><code><span class="html">
The image size (width x height) should not exceed INT_MAX ... It's still thrue on a 64 bits computer.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="121768">  
  <a class="name">
  <strong class="user"><em>katalin at knittedforyou dot com</em></strong></a><div class="date" title="2017-10-17 04:45"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom121768">
<div class="phpcode"><code><span class="html">
I have this code: <br><br>if (exif_imagetype($this-&gt;img_name) == IMAGETYPE_PNG) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;image = imagecreatefrompng($this-&gt;img_name);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Error::log('It is a png: '.$this-&gt;img_name);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (Exception $e) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "The image file has some strange charachters. Probably not a png image?";<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;image = '';<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;img_name = '';<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br><br>And I get this error in the error.log: <br>PHP Unknown error:&nbsp; imagecreatefrompng(): gd-png: fatal libpng error: Extra compressed data\n in Unknown on line 0<br><br>The file that I try to open is a generated .png image which I can open from gimp and Geeqie. <br><br>What is the problem? Could you please help me?</span>
</code></div>
  </div>
 </div>
  <div class="note" id="67854">  
  <a class="name">
  <strong class="user"><em>jboyd1189 at yahoo dot com</em></strong></a><div class="date" title="2006-07-05 02:49"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom67854">
<div class="phpcode"><code><span class="html">
I was having a terrible time with the imagecreatefrompng function as it was working perfectly for one image and not at all for another.&nbsp; After many hours of frustration, I discovered that the problem was the image size (number of pixels).&nbsp; It appears that the maximum number of pixels this function will process is 1,040,000.&nbsp; So, be sure that the pixel resolution of the image (eg. 1040 x 1000) does not exceed this value.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.imagecreatefrompng.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:20:14 GMT -->

</body></html>
<html><!-- Mirrored from www.php.net/manual/en/function.feof.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:31:04 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>feof</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.feof.html">
 <link rel="shorturl" href="https://www.php.net/feof">
 <link rel="alternate" href="https://www.php.net/feof" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.filesystem.html">
 <link rel="prev" href="function.fclose.html">
 <link rel="next" href="function.fflush.html">

 <link rel="alternate" href="function.feof.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.feof.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.feof.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.feof.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.feof.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.feof.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.feof.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.feof.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.feof.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.feof.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.fileprocess.file.html">File System Related Extensions</a></li>      <li><a href="book.filesystem.html">Filesystem</a></li>      <li><a href="ref.filesystem.html">Filesystem Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.feof" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">feof</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">feof</span> â€” <span class="dc-title">Tests for end-of-file on a file pointer</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.feof-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>feof</strong></span>(<span class="methodparam"><span class="type">resource</span> <code class="parameter">$stream</code></span>): <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   Tests for end-of-file on a file pointer.
  </p>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-function.feof-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    
     <dt>
<code class="parameter">stream</code></dt>

     <dd>

      <p class="para">The file pointer must be valid, and must point to
a file successfully opened by <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span> or
<span class="function"><a href="function.fsockopen.html" class="function">fsockopen()</a></span> (and not yet closed by
<span class="function"><a href="function.fclose.html" class="function">fclose()</a></span>).</p>
     </dd>

    
   </dl>

  <p></p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.feof-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <strong><code>true</code></strong> if the file pointer is at EOF or an error occurs
   (including socket timeout); otherwise returns <strong><code>false</code></strong>.
  </p>
 </div>

 
 <div class="refsect1 notes" id="refsect1-function.feof-notes">
  <h3 class="title">Notes</h3>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">
    If a connection opened by <span class="function"><a href="function.fsockopen.html" class="function">fsockopen()</a></span> wasn't closed
    by the server, <span class="function"><strong>feof()</strong></span> will hang. To workaround this, see 
    below example:
    </p><div class="example" id="example-2090">
     <p><strong>Example #1 Handling timeouts with <span class="function"><strong>feof()</strong></span></strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">safe_feof</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;&amp;</span><span style="color: #0000BB">$start&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">NULL</span><span style="color: #007700">)&nbsp;{<br>&nbsp;</span><span style="color: #0000BB">$start&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br><br>&nbsp;return&nbsp;</span><span style="color: #0000BB">feof</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #FF8000">/*&nbsp;Assuming&nbsp;$fp&nbsp;is&nbsp;previously&nbsp;opened&nbsp;by&nbsp;fsockopen()&nbsp;*/<br><br></span><span style="color: #0000BB">$start&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">NULL</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$timeout&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ini_get</span><span style="color: #007700">(</span><span style="color: #DD0000">'default_socket_timeout'</span><span style="color: #007700">);<br><br>while(!</span><span style="color: #0000BB">safe_feof</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$start</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;(</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">$start</span><span style="color: #007700">)&nbsp;&lt;&nbsp;</span><span style="color: #0000BB">$timeout</span><span style="color: #007700">)<br>{<br>&nbsp;</span><span style="color: #FF8000">/*&nbsp;Handle&nbsp;*/<br></span><span style="color: #007700">}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   <p></p>
  </div>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">
    If the passed file pointer is not valid you may get an infinite loop, because
    <span class="function"><strong>feof()</strong></span> fails to return <strong><code>true</code></strong>.
    </p><div class="example" id="example-2091">
     <p><strong>Example #2 <span class="function"><strong>feof()</strong></span> example with an invalid file pointer</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;if&nbsp;file&nbsp;can&nbsp;not&nbsp;be&nbsp;read&nbsp;or&nbsp;doesn't&nbsp;exist&nbsp;fopen&nbsp;function&nbsp;returns&nbsp;FALSE<br></span><span style="color: #0000BB">$file&nbsp;</span><span style="color: #007700">=&nbsp;@</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">"no_such_file"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"r"</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;FALSE&nbsp;from&nbsp;fopen&nbsp;will&nbsp;issue&nbsp;warning&nbsp;and&nbsp;result&nbsp;in&nbsp;infinite&nbsp;loop&nbsp;here<br></span><span style="color: #007700">while&nbsp;(!</span><span style="color: #0000BB">feof</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">))&nbsp;{<br>}<br><br></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   <p></p>
  </div>
 </div>

 
</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="67261">  
  <a class="name">
  <strong class="user"><em>ironoxid at libero dot it</em></strong></a><div class="date" title="2006-06-06 06:52"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom67261">
<div class="phpcode"><code><span class="html">
I really thought that the feof() was TRUE when the logical file pointer is a EOF.<br>but no ! <br>we need to read and get an empty record before the eof() reports TRUE.<br><br>So<br><br>$fp = fopen('test.bin','rb');<br>while(!feof($fp)) {<br>&nbsp; $c = fgetc($fp);<br>&nbsp; // ... do something with $c <br>&nbsp; echo ftell($fp), ",";<br>}<br>echo 'EOF!';<br><br>prints for two time the last byte position.<br>If our file length is 5 byte this code prints <br><br>0,1,2,3,4,5,5,EOF!<br><br>Because of this, you have to do another check to verify if fgetc really reads another byte (to prevent error on "do something with $c" ^_^).<br><br>To prevent errors you have to use this code<br><br>$fp = fopen('test.bin','rb');<br>while(!feof($fp)) {<br>&nbsp; $c = fgetc($fp);<br>&nbsp; if($c === false) break;<br>&nbsp; // ... do something with $c <br>}<br><br>but this is the same of<br><br>$fp = fopen('test.bin','rb');<br>while(($c = fgetc($fp))!==false) {<br>&nbsp; // ... do something with $c <br>}<br><br>Consequently feof() is simply useless.<br>Before write this note I want to submit this as a php bug but one php developer said that this does not imply a bug in PHP itself (<a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=35136&amp;edit=2</a>).<br><br>If this is not a bug I think that this need at least to be noticed.<br><br>Sorry for my bad english.<br>Bye ;)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="117809">  
  <a class="name">
  <strong class="user"><em>line dot loic at gmail dot com</em></strong></a><div class="date" title="2015-08-13 09:13"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom117809">
<div class="phpcode"><code><span class="html">
To avoid infinite loops and the warning :<br>"Warning: feof() expects parameter 1 to be resource, boolean given"<br><br>You need to check that the fopen function return the correct type.<br>This can be achieved very easily with gettype().<br>Here is an example :<br><br>$source = fopen($xml_uri, "r");<br>$xml = "";<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>if(gettype($source) == "resource") { // Check here !<br>&nbsp; &nbsp; while (!feof($source)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; $xml .= fgets($source, 4096);<br>&nbsp; &nbsp; }<br>}<br><br>echo $xml;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96074">  
  <a class="name">
  <strong class="user"><em>sudo dot adam dot carruthers at gmail dot com</em></strong></a><div class="date" title="2010-02-06 09:01"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom96074">
<div class="phpcode"><code><span class="html">
When using feof() on a TCP stream, i found the following to work (after many hours of frustration and anger):<br><br>NOTE: I used ";" to denote the end of data transmission.&nbsp; This can be modified to whatever the server's end of file or in this case, end of output character is.<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; &nbsp; &nbsp; $cursor </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$inData </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; while(</span><span class="default">strcmp</span><span class="keyword">(</span><span class="default">$cursor</span><span class="keyword">, </span><span class="string">";"</span><span class="keyword">) != </span><span class="default">0</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$cursor </span><span class="keyword">= </span><span class="default">fgetc</span><span class="keyword">(</span><span class="default">$sock</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$inData</span><span class="keyword">.= </span><span class="default">$cursor</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$sock</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; echo(</span><span class="default">$inData</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Since strcmp() returns 0 when the two strings are equal, it will return non zero as long as the cursor is not ";".&nbsp; Using the above method will add ";" to the string, but the fix for this is simple.<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; &nbsp; &nbsp; $cursor </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$inData </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cursor </span><span class="keyword">= </span><span class="default">fgetc</span><span class="keyword">(</span><span class="default">$sock</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; while(</span><span class="default">strcmp</span><span class="keyword">(</span><span class="default">$cursor</span><span class="keyword">, </span><span class="string">";"</span><span class="keyword">) != </span><span class="default">0</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$inData</span><span class="keyword">.= </span><span class="default">$cursor</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$sock</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; echo(</span><span class="default">$inData</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>I hope this helps someone.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="71252">  
  <a class="name">
  <strong class="user"><em>cmr at forestfactory dot de</em></strong></a><div class="date" title="2006-11-19 08:57"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom71252">
<div class="phpcode"><code><span class="html">
Here's solution 3:<br><br>&lt;?<br>$fp = fopen("myfile.txt", "r");<br>while ( ($current_line = fgets($fp)) !== false ) {<br>&nbsp; // do stuff to the current line here<br>}<br>fclose($fp);<br>?&gt;<br><br>AFAICS fgets() never returns an empty string, so we can also write:<br><br>&lt;?<br>$fp = fopen("myfile.txt", "r");<br>while ( $current_line = fgets($fp) ) {<br>&nbsp; // do stuff to the current line here<br>}<br>fclose($fp);<br>?&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="67114">  
  <a class="name">
  <strong class="user"><em>m a p o p a at g m a i l. c o m</em></strong></a><div class="date" title="2006-06-03 05:58"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom67114">
<div class="phpcode"><code><span class="html">
you&nbsp; can avoid the infinite loop and filling the error logs <br>by an simple if statement <br>Here is the example<br><br>&nbsp; &nbsp; $handle = fopen("<a rel="nofollow" target="_blank">http://xml.weather.yahoo.com/forecastrss?p=AYXX0008&amp;u=f</a>", "r");<br>&nbsp; &nbsp; $xml = "";<br>&nbsp; &nbsp; if ($handle)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp;&nbsp; while (!feof($handle))<br>&nbsp; &nbsp; &nbsp;&nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $xml .= fread($handle, 128);<br>&nbsp; &nbsp; &nbsp;&nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; fclose($handle);<br>&nbsp; &nbsp; }</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95425">  
  <a class="name">
  <strong class="user"><em>jakicoll</em></strong></a><div class="date" title="2010-01-02 04:59"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom95425">
<div class="phpcode"><code><span class="html">
Please note that feof() used with TCP-Connections, returns false as long as the connection is open.<br>It even returns false when there is no data available.<br><br>BTW: Using feof() with HTTP for a single request, you should always make sure that you set the HTTP-Header "Connection" to "close" and _not_ to "keep-alive".</span>
</code></div>
  </div>
 </div>
  <div class="note" id="81436">  
  <a class="name">
  <strong class="user"><em>honzam+php at ipdgroup dot com</em></strong></a><div class="date" title="2008-02-28 02:17"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom81436">
<div class="phpcode"><code><span class="html">
Johannes: Remember note from stream_get_meta_data page: For socket streams this member [eof] can be TRUE&nbsp; even when unread_bytes&nbsp; is non-zero. To determine if there is more data to be read, use feof() instead of reading this item. <br><br>Another thing: better not rely on the "including socket timeout" part of when feof returns true. Just found program looping two days in while(!feof($fd)) fread ... with 20 seconds timeout in PHP 4.3.10.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107449">  
  <a class="name">
  <strong class="user"><em>dewi at dewimorgan dot com</em></strong></a><div class="date" title="2012-02-09 11:17"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom107449">
<div class="phpcode"><code><span class="html">
Return values in the documentation are incorrectly stated. It says: <br><br>Returns TRUE if the file pointer is at EOF or an error occurs (including socket timeout); otherwise returns FALSE.<br><br>Correct text would be more like:<br><br>Returns FALSE if no filehandle was passed; <br>returns NULL if no filehandle was passed; <br>returns TRUE if the file pointer is at EOF or an error occurs (including socket timeout);<br>otherwise returns FALSE.<br><br>As an example, running the following from the commandline:<br><br>php -r 'echo <br>&nbsp; &nbsp; "Empty: ".var_export(feof(), true)."\n".<br>&nbsp; &nbsp; "Null: ".var_export(feof(NULL), true)."\n".<br>&nbsp; &nbsp; "Undefined: ".var_export(feof($undef), true)."\n"<br>;'<br><br>This will output:<br><br>PHP Warning:&nbsp; Wrong parameter count for feof() in Command line code on line 1<br>PHP Warning:&nbsp; feof(): supplied argument is not a valid stream resource in Command line code on line 1<br>PHP Warning:&nbsp; feof(): supplied argument is not a valid stream resource in Command line code on line 1<br><br>Empty: NULL<br>Null: false<br>Undefined: false<br><br>This can, as other commenters have reported, result in infinite loops and massive PHP error logfiles, if the file handle returned by fopen() is invalid for any reason.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="70715">  
  <a class="name">
  <strong class="user"><em>Tom</em></strong></a><div class="date" title="2006-10-24 03:27"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom70715">
<div class="phpcode"><code><span class="html">
feof() is, in fact, reliable.&nbsp; However, you have to use it carefully in conjunction with fgets().&nbsp; A common (but incorrect) approach is to try something like this:<br><br>&lt;?<br>$fp = fopen("myfile.txt", "r");<br>while (!feof($fp)) {<br>&nbsp; $current_line = fgets($fp);<br>&nbsp; // do stuff to the current line here<br>}<br>fclose($fp);<br>?&gt;<br><br>The problem when processing plain text files is that feof() will not return true after getting the last line of input.&nbsp; You need to try to get input _and fail_ before feof() returns true.&nbsp; You can think of the loop above working like this:<br><br>* (merrily looping, getting lines and processing them)<br>* fgets used to get 2nd to last line<br>* line is processed<br>* loop back up -- feof returns false, so do the steps inside the loop<br>* fgets used to get last line<br>* line is processed<br>* loop back up -- since the last call to fgets worked (you got the last line), feof still returns false, so you do the steps inside the loop again<br>* fgets used to try to get another line (but there's nothing there!)<br>* your code doesn't realize this, and tries to process this non-existent line (typically by doing the same actions again)<br>* now when your code loops back up, feof returns true, and your loop ends<br><br>There's two ways to solve this:<br><br>1. You can put an additional test for feof() inside the loop<br>2. You can move around your calls to fgets() so that the testing of feof() happens in a better location<br><br>Here's solution 1:<br><br>&lt;?<br>$fp = fopen("myfile.txt", "r");<br>while(!feof($fp)) {<br>&nbsp; $current_line = fgets($fp);<br>&nbsp; if (!feof($fp)) {<br>&nbsp; &nbsp; // process current line<br>&nbsp; }<br>}<br>fclose($fp);<br>?&gt;<br><br>And here's solution 2 (IMHO, more elegant):<br><br>&lt;?<br>$fp = fopen("myfile.txt", "r");<br>$current_line = fgets($fp);<br>while (!feof($fp)) {<br>&nbsp; // process current line<br>&nbsp; $current_line = fgets($fp);<br>}<br>fclose($fp);<br>?&gt;<br><br>FYI, the eof() function in C++ works the exact same way, so this isn't just some weird PHP thing...</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77912">  
  <a class="name">
  <strong class="user"><em>Jet</em></strong></a><div class="date" title="2007-09-19 07:03"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom77912">
<div class="phpcode"><code><span class="html">
To avoid infinite loop with fgets() just use do..while statement.<br><br><span class="default">&lt;?php<br></span><span class="keyword">if (</span><span class="default">$f </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'myfile.txt'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">)) do {<br>&nbsp; &nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="comment">// do any stuff here...<br></span><span class="keyword">} while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">));<br></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122925">  
  <a class="name">
  <strong class="user"><em>DimeCadmium</em></strong></a><div class="date" title="2018-07-10 07:22"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122925">
<div class="phpcode"><code><span class="html">
feof() does not test for the actual end of a file, it tests for an exceptional condition known as end-of-file. (It's based on the C function of the same name which "tests the&nbsp; end-of-file&nbsp; indicator&nbsp; for&nbsp; the&nbsp; stream")<br><br>That is to say, feof() only tells you whether fread() (and friends) have run into EOF, to allow you to differentiate it from other errors. You should be testing the return value of fread() (or whatever function you're using to read), not feof().<br><br>In particular, if your filehandle is invalid (file doesn't exist / permissions issue / etc.) or fread() encounters some other error, feof will return false, and your code will be running an infinite loop processing the FALSE returned from fread().<br><br>From the (C) manpage for fread():<br>&nbsp; &nbsp; &nbsp;&nbsp; fread() does not distinguish between end-of-file and error, and callers<br>&nbsp; &nbsp; &nbsp;&nbsp; must use feof(3) and ferror(3) to determine which occurred.<br>That is the SOLE purpose for feof().</span>
</code></div>
  </div>
 </div>
  <div class="note" id="50613">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2005-03-04 09:02"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom50613">
<div class="phpcode"><code><span class="html">
if you're worried the file pointer is invalid, TEST IT before you go into your loop... that way it'll never be an infinite loop.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="60284">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2006-01-01 06:27"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom60284">
<div class="phpcode"><code><span class="html">
if you use fseek function to pos the pointer exceed the size the file,feof still return true.so note that when you use feof as the condition of while loop.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113366">  
  <a class="name">
  <strong class="user"><em>Alwar</em></strong></a><div class="date" title="2013-10-02 07:41"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom113366">
<div class="phpcode"><code><span class="html">
Don't use feof to test if you have readed all data sent by the other end of the socket. As i know it would return true only when the other end closes the connection.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="40717">  
  <a class="name">
  <strong class="user"><em>Johannes</em></strong></a><div class="date" title="2004-03-12 02:47"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom40717">
<div class="phpcode"><code><span class="html">
I found feof() to be a slow function when using a non-blocking connection.<br><br>The function stream_get_meta_data() returns much quicker and has a return field 'eof'.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="117578">  
  <a class="name">
  <strong class="user"><em>lulzury at Yahoo dot com</em></strong></a><div class="date" title="2015-07-01 05:34"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom117578">
<div class="phpcode"><code><span class="html">
From washington dot edu css342:<br>On unix/linux, every line in a file has an End-Of-Line (EOL) character and the EOF character is after the last line. On windows, each line has an EOL characters except the last line. So unix/linux file's last line is <br>&nbsp; &nbsp; &nbsp; stuff, EOL, EOF <br>whereas windows file's last line, if the cursor is on the line, is <br>&nbsp; &nbsp; &nbsp; stuff, EOF <br><br>So set up data files on windows to be the same as on unix/linux. This way, you will correctly determine eof under both unix/linux and windows. In general, you must exit all loops and all functions immediately when you are attempting to read an item that would be past the eof. <br><br>Here is a typical set up that will work correctly. Suppose in a data file, there are multiple lines of data. In some function is the loop where you are reading and handling this data. This loop will look similar to the following.<br>&nbsp; &nbsp;&nbsp; // infinite loop to read and handle a line of data<br>&nbsp; &nbsp;&nbsp; for (;;) {<br>&nbsp; &nbsp; &nbsp; &nbsp; $ln = fgets($fp);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (feof($fp)) break;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; // read the rest of the line<br>&nbsp; &nbsp; &nbsp; &nbsp; // do whatever with data<br>&nbsp; &nbsp;&nbsp; }<br>If you dislike infinite loops, you can accomplish this same thing using a while loop by priming the loop and reading again at the end:<br>&nbsp; &nbsp; $ln = fgets($fp);<br>&nbsp; &nbsp;&nbsp; while (!feof($fp)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; // read the rest of the line<br>&nbsp; &nbsp; &nbsp; &nbsp; // do whatever with data<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $ln = fgets($fp);<br>&nbsp; &nbsp;&nbsp; }</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.feof.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:31:04 GMT -->

</body></html>
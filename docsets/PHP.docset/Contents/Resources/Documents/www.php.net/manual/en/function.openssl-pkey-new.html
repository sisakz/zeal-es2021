<html><!-- Mirrored from www.php.net/manual/en/function.openssl-pkey-new.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:39:05 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>openssl_pkey_new</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.openssl-pkey-new.html">
 <link rel="shorturl" href="https://www.php.net/openssl-pkey-new">
 <link rel="alternate" href="https://www.php.net/openssl-pkey-new" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.openssl.html">
 <link rel="prev" href="function.openssl-pkey-get-public.html">
 <link rel="next" href="function.openssl-private-decrypt.html">

 <link rel="alternate" href="function.openssl-pkey-new.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.openssl-pkey-new.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.openssl-pkey-new.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.openssl-pkey-new.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.openssl-pkey-new.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.openssl-pkey-new.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.openssl-pkey-new.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.openssl-pkey-new.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.openssl-pkey-new.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.openssl-pkey-new.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.crypto.html">Cryptography Extensions</a></li>      <li><a href="book.openssl.html">OpenSSL</a></li>      <li><a href="ref.openssl.html">OpenSSL Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.openssl-pkey-new" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">openssl_pkey_new</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.2.0, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">openssl_pkey_new</span> â€” <span class="dc-title">Generates a new private key </span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.openssl-pkey-new-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>openssl_pkey_new</strong></span>(<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">array</span><span class="type"></span></span> <code class="parameter">$options</code><span class="initializer"> = <strong><code>null</code></strong></span></span>): <span class="type"><span class="type"><a href="class.opensslasymmetrickey.html" class="type OpenSSLAsymmetricKey">OpenSSLAsymmetricKey</a></span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>openssl_pkey_new()</strong></span> generates a new private
   key.
   How to obtain the public component of the key is shown in an example below.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
 <span class="simpara">
  You need to have a valid <var class="filename">openssl.cnf</var> installed for
  this function to operate correctly.
  See the notes under <a href="openssl.installation.html" class="link">the installation
  section</a> for more information.
 </span>
</p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.openssl-pkey-new-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       You can finetune the key generation (such as specifying the number of
       bits) using <code class="parameter">options</code>.  See
       <span class="function"><a href="function.openssl-csr-new.html" class="function">openssl_csr_new()</a></span> for more information about
       <code class="parameter">options</code>.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.openssl-pkey-new-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns an <span class="classname"><a href="class.opensslasymmetrickey.html" class="classname">OpenSSLAsymmetricKey</a></span> instance for the pkey on success, or <strong><code>false</code></strong> on
   error.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.openssl-pkey-new-changelog">
  <h3 class="title">Changelog</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>Version</th>
      <th>Description</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       On success, this function returns an <span class="classname"><a href="class.opensslasymmetrickey.html" class="classname">OpenSSLAsymmetricKey</a></span> instance now;
       previously, a <a href="language.types.resource.html" class="link">resource</a> of type <code class="literal">OpenSSL key</code> was returned.
      </td>
     </tr>

     <tr>
      <td>7.1.0</td>
      <td>The <code class="parameter">curve_name</code> option was added to make it possible to create EC keys.</td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.openssl-pkey-new-examples">
  <h3 class="title">Examples</h3>
  <div class="example" id="example-900">
   <p><strong>Example #1 Obtain the public key from a private key</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$private_key&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_pkey_new</span><span style="color: #007700">();<br></span><span style="color: #0000BB">$public_key_pem&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_pkey_get_details</span><span style="color: #007700">(</span><span style="color: #0000BB">$private_key</span><span style="color: #007700">)[</span><span style="color: #DD0000">'key'</span><span style="color: #007700">];<br>echo&nbsp;</span><span style="color: #0000BB">$public_key_pem</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$public_key&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_pkey_get_public</span><span style="color: #007700">(</span><span style="color: #0000BB">$public_key_pem</span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$public_key</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>The above example will output
something similar to:</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArZFsmN2P6rx1Xt7YV95o
gcdlal0k3ryiIhFNzjwtRNNTXfEfBr6lUuaIJYQ8/XqEBX0hpcfuuF6tTRlonA3t
WLME0QFD93YVsAaXcy76YqjjqcRRodIBphAbYyyMI/lXkQAdn7kbAmr7neSOsMYJ
El9Wo4Hl4oG6e52ZnYHyqW9dxh4hX93eupR2TmcCdVf+r9xoHewP0KJYSHt7vDUX
AQlWYcQiWHIadFsmL0orr6mutlXFReoHbesgKY9/3YLOu0JfxflSjIZ2JeL1NTl1
MsmODsUwgAUrwnWKKx+eQUP5g3GnSB3dPkRh9zRVRiLNWbCugyjrf3e6DgQWrW7j
pwIDAQAB
-----END PUBLIC KEY-----
resource(5) of type (OpenSSL key)
</pre></div>
   </div>
  </div>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="111769">  
  <a class="name">
  <strong class="user"><em>dirt at awoms dot com</em></strong></a><div class="date" title="2013-03-26 08:52"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom111769">
<div class="phpcode"><code><span class="html">
Working example:<br><br>$config = array(<br>&nbsp; &nbsp; "digest_alg" =&gt; "sha512",<br>&nbsp; &nbsp; "private_key_bits" =&gt; 4096,<br>&nbsp; &nbsp; "private_key_type" =&gt; OPENSSL_KEYTYPE_RSA,<br>);<br>&nbsp; &nbsp; <br>// Create the private and public key<br>$res = openssl_pkey_new($config);<br><br>// Extract the private key from $res to $privKey<br>openssl_pkey_export($res, $privKey);<br><br>// Extract the public key from $res to $pubKey<br>$pubKey = openssl_pkey_get_details($res);<br>$pubKey = $pubKey["key"];<br><br>$data = 'plaintext data goes here';<br><br>// Encrypt the data to $encrypted using the public key<br>openssl_public_encrypt($data, $encrypted, $pubKey);<br><br>// Decrypt the data using the private key and store the results in $decrypted<br>openssl_private_decrypt($encrypted, $decrypted, $privKey);<br><br>echo $decrypted;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="116765">  
  <a class="name">
  <strong class="user"><em>scott at brynen dot com</em></strong></a><div class="date" title="2015-02-24 09:36"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom116765">
<div class="phpcode"><code><span class="html">
If you try and generate a new key using openssl_pkey_new(), and need to specify the size of the key, the key MUST be type-bound to integer<br><br>// works<br>$keysize = 1024;<br>$ssl = openssl_pkey_new (array('private_key_bits' =&gt; $keysize));<br><br>// fails<br>$keysize = "1024";<br>$ssl = openssl_pkey_new (array('private_key_bits' =&gt; $keysize));<br><br>// works (force to int)<br>$keysize = "1024";<br>$ssl = openssl_pkey_new (array('private_key_bits' =&gt; (int)$keysize));</span>
</code></div>
  </div>
 </div>
  <div class="note" id="123410">  
  <a class="name">
  <strong class="user"><em>gomez dot alejandre at gmail dot com</em></strong></a><div class="date" title="2018-12-08 01:43"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom123410">
<div class="phpcode"><code><span class="html">
Not forget the $configArgs for windows users :D, or the method throws a error with the primary key<br><br>//write your configurations :D<br>$configargs = array(<br>&nbsp; "config" =&gt; "C:/xampp/php/extras/openssl/openssl.cnf",<br>&nbsp; 'private_key_bits'=&gt; 2048,<br>&nbsp; 'default_md' =&gt; "sha256",<br>);<br><br>// Create the keypair<br>$res=openssl_pkey_new($configargs);<br>// Get private key<br>openssl_pkey_export($res, $privKey,NULL,$configargs);<br><br>and it's for all methods ._ .<br><br>a full implementation example here.<br><br><a rel="nofollow" target="_blank">https://gist.github.com/DuckHunter213/269a0efd17e709f7f1f177ae7da46ad1</a><br><br>this error take me 3 full days you'r welcome :)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82253">  
  <a class="name">
  <strong class="user"><em>Brad</em></strong></a><div class="date" title="2008-04-02 12:17"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom82253">
<div class="phpcode"><code><span class="html">
It's easier than all that, if you just want the keys:<br><br><span class="default">&lt;?php<br></span><span class="comment">// Create the keypair<br></span><span class="default">$res</span><span class="keyword">=</span><span class="default">openssl_pkey_new</span><span class="keyword">();<br><br></span><span class="comment">// Get private key<br></span><span class="default">openssl_pkey_export</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">, </span><span class="default">$privkey</span><span class="keyword">);<br><br></span><span class="comment">// Get public key<br></span><span class="default">$pubkey</span><span class="keyword">=</span><span class="default">openssl_pkey_get_details</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">);<br></span><span class="default">$pubkey</span><span class="keyword">=</span><span class="default">$pubkey</span><span class="keyword">[</span><span class="string">"key"</span><span class="keyword">];<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="123488">  
  <a class="name">
  <strong class="user"><em>Jan</em></strong></a><div class="date" title="2019-01-03 09:02"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom123488">
<div class="phpcode"><code><span class="html">
In case this function returns false, then check your openssl.cnf and make sure that in the [req] section of this file the entry default_bits is not commented out.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="120814">  
  <a class="name">
  <strong class="user"><em>dodginess at yahoo dot com</em></strong></a><div class="date" title="2017-03-15 11:39"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom120814">
<div class="phpcode"><code><span class="html">
If you're using openssl_pkey_new() in conjunction with openssl_csr_new() and want to change the CSR digest algorithm as well as specify a custom key size, the configuration override should be defined once and sent to both functions:<br><br><span class="default">&lt;?php<br>$config </span><span class="keyword">= array(<br>&nbsp; &nbsp; </span><span class="string">'digest_alg' </span><span class="keyword">=&gt; </span><span class="string">'sha1'</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'private_key_bits' </span><span class="keyword">=&gt; </span><span class="default">2048</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'private_key_type' </span><span class="keyword">=&gt; </span><span class="default">OPENSSL_KEYTYPE_RSA</span><span class="keyword">,<br>);<br><br></span><span class="default">$privkey </span><span class="keyword">= </span><span class="default">openssl_pkey_new</span><span class="keyword">(</span><span class="default">$config</span><span class="keyword">);<br><br></span><span class="default">$csr </span><span class="keyword">= </span><span class="default">openssl_csr_new</span><span class="keyword">(</span><span class="default">$dn</span><span class="keyword">, </span><span class="default">$privkey</span><span class="keyword">, </span><span class="default">$config</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Although openssl_pkey_new() will accept the 'digest_alg' argument it won't use it, and setting the value has no effect unless you also set this value for openssl_csr_new(). The reason for this is that the $config array is acting as a drop-in replacement for the values found in the openssl.cnf file, so it must contain all of the override values that you need even if the function they're being sent to won't use them.<br><br>Also, if you change the 'digest_alg' to something like 'sha256' and still get an MD5 signed CSR check your openssl.cnf file to see whether the digest algorithm you want to use is actually supported.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="42800">  
  <a class="name">
  <strong class="user"><em>NOSPAM dot alchaemist at hiperlinux dot com dot ar</em></strong></a><div class="date" title="2004-05-30 12:17"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom42800">
<div class="phpcode"><code><span class="html">
As you probably found, getting the public key is not as direct as you might think with this documentation.<br><br>You can easily get into messages like:<br><br>Warning: openssl_pkey_get_public(): Don't know how to get public key from this private key (the documentation lied) in D:\www\keys.php on line 4<br><br>The correct steps to get the whole thing seem to be these:<br><br>&lt;?<br>$dn = array("countryName" =&gt; 'XX', "stateOrProvinceName" =&gt; 'State', "localityName" =&gt; 'SomewhereCity', "organizationName" =&gt; 'MySelf', "organizationalUnitName" =&gt; 'Whatever', "commonName" =&gt; 'mySelf', "emailAddress" =&gt; 'user@domain.com');<br>$privkeypass = '1234';<br>$numberofdays = 365;<br><br>$privkey = openssl_pkey_new();<br>$csr = openssl_csr_new($dn, $privkey);<br>$sscert = openssl_csr_sign($csr, null, $privkey, $numberofdays);<br>openssl_x509_export($sscert, $publickey);<br>openssl_pkey_export($privkey, $privatekey, $privkeypass);<br>openssl_csr_export($csr, $csrStr);<br><br>echo $privatekey; // Will hold the exported PriKey<br>echo $publickey;&nbsp; // Will hold the exported PubKey<br>echo $csrStr;&nbsp; &nbsp;&nbsp; // Will hold the exported Certificate<br>?&gt;<br><br>Now all you need to do is to make some research on each individual function.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108951">  
  <a class="name">
  <strong class="user"><em>zelnaga at gmail dot com</em></strong></a><div class="date" title="2012-06-07 05:21"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom108951">
<div class="phpcode"><code><span class="html">
Getting the public key corresponding to a particular private key, through the methods provided for by OpenSSL, is a bit cumbersome. An easier way to do it is to use phpseclib, a pure PHP RSA implementation:<br><br><span class="default">&lt;?php<br></span><span class="keyword">include(</span><span class="string">'Crypt/RSA.php'</span><span class="keyword">);<br><br></span><span class="default">$rsa </span><span class="keyword">= new </span><span class="default">Crypt_RSA</span><span class="keyword">();<br></span><span class="default">$rsa</span><span class="keyword">-&gt;</span><span class="default">loadKey</span><span class="keyword">(</span><span class="string">'...'</span><span class="keyword">);<br><br></span><span class="default">$privatekey </span><span class="keyword">= </span><span class="default">$rsa</span><span class="keyword">-&gt;</span><span class="default">getPrivateKey</span><span class="keyword">();<br></span><span class="default">$publickey </span><span class="keyword">= </span><span class="default">$rsa</span><span class="keyword">-&gt;</span><span class="default">getPublicKey</span><span class="keyword">();<br></span><span class="default">?&gt;<br></span><br>Doesn't require any extensions be installed.&nbsp; It'll use bcmath or gmp if they're available, for speed, but doesn't even require those.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102392">  
  <a class="name">
  <strong class="user"><em>jthijssen at notloxic dot nl</em></strong></a><div class="date" title="2011-02-11 06:17"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom102392">
<div class="phpcode"><code><span class="html">
If you want to change the default private key size (1024) too something else you can use the following code:<br> <br><span class="default">&lt;?php <br>$config </span><span class="keyword">= array(</span><span class="string">'private_key_bits' </span><span class="keyword">=&gt; </span><span class="default">512</span><span class="keyword">);<br></span><span class="default">$privKey </span><span class="keyword">= </span><span class="default">openssl_pkey_new</span><span class="keyword">(</span><span class="default">$config</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>Mind though that the minimum number of bits is 384. Any lower will trigger an error.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.openssl-pkey-new.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:39:05 GMT -->

</body></html>
<html><!-- Mirrored from www.php.net/manual/en/function.microtime.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 07:28:40 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>microtime</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.microtime.html">
 <link rel="shorturl" href="https://www.php.net/microtime">
 <link rel="alternate" href="https://www.php.net/microtime" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.datetime.html">
 <link rel="prev" href="function.localtime.html">
 <link rel="next" href="function.mktime.html">

 <link rel="alternate" href="function.microtime.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.microtime.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.microtime.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.microtime.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.microtime.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.microtime.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.microtime.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.microtime.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.microtime.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.microtime.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.calendar.html">Date and Time Related Extensions</a></li>      <li><a href="book.datetime.html">Date/Time</a></li>      <li><a href="ref.datetime.html">Date/Time Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.microtime" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">microtime</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">microtime</span> — <span class="dc-title">Return current Unix timestamp with microseconds</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.microtime-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>microtime</strong></span>(<span class="methodparam"><span class="type">bool</span> <code class="parameter">$as_float</code><span class="initializer"> = <strong><code>false</code></strong></span></span>): <span class="type"><span class="type">string</span>|<span class="type">float</span></span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>microtime()</strong></span> returns the current Unix timestamp with
   microseconds. This function is only available on operating systems that
   support the gettimeofday() system call.
  </p>
  <p class="para">
   For performance measurements, using <span class="function"><a href="function.hrtime.html" class="function">hrtime()</a></span> is recommended.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.microtime-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    
     <dt>
<code class="parameter">as_float</code></dt>

     <dd>

      <p class="para">
       If used and set to <strong><code>true</code></strong>, <span class="function"><strong>microtime()</strong></span> will return a
       <span class="type">float</span> instead of a <span class="type">string</span>, as described in
       the return values section below.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.microtime-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   By default, <span class="function"><strong>microtime()</strong></span> returns a <span class="type">string</span> in
   the form "msec sec", where <code class="literal">sec</code> is the number of seconds 
   since the Unix epoch (0:00:00 January 1,1970 GMT), and <code class="literal">msec</code> 
   measures microseconds that have elapsed since <code class="literal">sec</code> 
   and is also expressed in seconds.
  </p>
  <p class="para">
   If <code class="parameter">as_float</code> is set to <strong><code>true</code></strong>, then
   <span class="function"><strong>microtime()</strong></span> returns a <span class="type">float</span>, which
   represents the current time in seconds since the Unix epoch accurate to the
   nearest microsecond.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.microtime-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-2046">
    <p><strong>Example #1 Timing script execution</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$time_start&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;Sleep&nbsp;for&nbsp;a&nbsp;while<br></span><span style="color: #0000BB">usleep</span><span style="color: #007700">(</span><span style="color: #0000BB">100</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$time_end&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$time&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$time_end&nbsp;</span><span style="color: #007700">-&nbsp;</span><span style="color: #0000BB">$time_start</span><span style="color: #007700">;<br><br>echo&nbsp;</span><span style="color: #DD0000">"Did&nbsp;nothing&nbsp;in&nbsp;</span><span style="color: #0000BB">$time</span><span style="color: #DD0000">&nbsp;seconds\n"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="example-2047">
    <p><strong>Example #2 <span class="function"><strong>microtime()</strong></span> and <code class="literal">REQUEST_TIME_FLOAT</code></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;Randomize&nbsp;sleeping&nbsp;time<br></span><span style="color: #0000BB">usleep</span><span style="color: #007700">(</span><span style="color: #0000BB">mt_rand</span><span style="color: #007700">(</span><span style="color: #0000BB">100</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10000</span><span style="color: #007700">));<br><br></span><span style="color: #FF8000">//&nbsp;REQUEST_TIME_FLOAT&nbsp;is&nbsp;available&nbsp;in&nbsp;the&nbsp;$_SERVER&nbsp;superglobal&nbsp;array.<br>//&nbsp;It&nbsp;contains&nbsp;the&nbsp;timestamp&nbsp;of&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;request&nbsp;with&nbsp;microsecond&nbsp;precision.<br></span><span style="color: #0000BB">$time&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">"REQUEST_TIME_FLOAT"</span><span style="color: #007700">];<br><br>echo&nbsp;</span><span style="color: #DD0000">"Did&nbsp;nothing&nbsp;in&nbsp;</span><span style="color: #0000BB">$time</span><span style="color: #DD0000">&nbsp;seconds\n"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.microtime-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.time.html" class="function" rel="rdfs-seeAlso">time()</a> - Return current Unix timestamp</span></li>
    <li class="member"><span class="function"><a href="function.hrtime.html" class="function" rel="rdfs-seeAlso">hrtime()</a> - Get the system's high resolution time</span></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="112104">  
  <a class="name">
  <strong class="user"><em>Russell G.</em></strong></a><div class="date" title="2013-05-03 08:34"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom112104">
<div class="phpcode"><code><span class="html">
Note that the timestamp returned is "with microseconds", not "in microseconds". This is especially good to know if you pass 'true' as the parameter and then calculate the difference between two float values -- the result is already in seconds; it doesn't need to be divided by a million.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111107">  
  <a class="name">
  <strong class="user"><em>player27</em></strong></a><div class="date" title="2013-01-15 04:31"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom111107">
<div class="phpcode"><code><span class="html">
You can use one variable to check execution $time as follow:
<br>
<br><span class="default">&lt;?php
<br>$time </span><span class="keyword">= -</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);
<br></span><span class="default">$hash </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br>for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1000</span><span class="keyword">,</span><span class="default">4000</span><span class="keyword">); ++</span><span class="default">$i</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$hash </span><span class="keyword">^= </span><span class="default">md5</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">str_shuffle</span><span class="keyword">(</span><span class="string">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="keyword">), </span><span class="default">0</span><span class="keyword">, </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">)));
<br>}
<br></span><span class="default">$time </span><span class="keyword">+= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);
<br>echo </span><span class="string">"Hash: </span><span class="default">$hash</span><span class="string"> iterations:</span><span class="default">$i</span><span class="string"> time: "</span><span class="keyword">,</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%f'</span><span class="keyword">, </span><span class="default">$time</span><span class="keyword">),</span><span class="default">PHP_EOL</span><span class="keyword">;
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101628">  
  <a class="name">
  <strong class="user"><em>jamie at bishopston dot net</em></strong></a><div class="date" title="2010-12-30 12:55"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom101628">
<div class="phpcode"><code><span class="html">
All these timing scripts rely on microtime which relies on gettimebyday(2)<br><br>This can be inaccurate on servers that run ntp to syncronise the servers<br>time.<br><br>For timing, you should really use clock_gettime(2) with the<br>CLOCK_MONOTONIC flag set.<br><br>This returns REAL WORLD time, not affected by intentional clock drift.<br><br>This may seem a bit picky, but I recently saw a server that's clock was an<br>hour out, and they'd set it to 'drift' to the correct time (clock is speeded<br>up until it reaches the correct time)<br><br>Those sorts of things can make a real impact.<br><br>Any solutions, seeing as php doesn't have a hook into clock_gettime?<br><br>More info here: <a rel="nofollow" target="_blank">http://tinyurl.com/28vxja9</a><br><br><a rel="nofollow" target="_blank">http://blog.habets.pp.se/2010/09/</a><br>gettimeofday-should-never-be-used-to-measure-time</span>
</code></div>
  </div>
 </div>
  <div class="note" id="59052">  
  <a class="name">
  <strong class="user"><em>radek at pinkbike com</em></strong></a><div class="date" title="2005-11-24 08:48"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom59052">
<div class="phpcode"><code><span class="html">
A lot of the comments here suggest adding in the following way:&nbsp; (float)$usec + (float)$sec<br>Make sure you have the float precision high enough as with the default precision of 12, you are only precise to the 0.01 seconds.&nbsp; <br>Set this in you php.ini file.<br>&nbsp; &nbsp; &nbsp; &nbsp; precision&nbsp; &nbsp; =&nbsp; 16</span>
</code></div>
  </div>
 </div>
  <div class="note" id="124984">  
  <a class="name">
  <strong class="user"><em>shdwlynxjunk at yahoo dot com</em></strong></a><div class="date" title="2020-05-07 07:40"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom124984">
<div class="phpcode"><code><span class="html">
It is important to note that microtime(TRUE) does NOT always return a float (at least in PHP 5.x; I have not tested 7.x).&nbsp; If it happens to land on an exact second, it returns an integer instead.<br><br>Here is some simple code to illustrate this:<br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="keyword">for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">5000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; echo </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">) . </span><span class="string">"\n"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">100</span><span class="keyword">); </span><span class="comment">// Adjust this if your PC is too fast/slow<br>&nbsp; &nbsp; </span><span class="keyword">}<br></span><span class="default">?&gt;<br></span><br>When you run this at a command line, you'll see output like this (and you'll know EXACTLY when I ran this):<br>1588881290.9992<br>1588881290.9994<br>1588881290.9996<br>1588881290.9998<br>1588881291&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;-- Look, Ma, an integer!<br>1588881291.0002<br>1588881291.0004<br>1588881291.0006<br>1588881291.0008<br><br>Why does this matter?&nbsp; Because if you want to format microtime into a very friendly but exact date/time, this popular code will fail on exact seconds (but works great otherwise):<br><br><span class="default">&lt;?php<br>&nbsp;&nbsp; $raw_time </span><span class="keyword">= </span><span class="default">DateTime</span><span class="keyword">::</span><span class="default">createFromFormat</span><span class="keyword">(</span><span class="string">'U.u'</span><span class="keyword">, </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">)); </span><span class="comment">// This line will not create an object when microtime returns an integer because it depends on the number being a float, including a decimal point!<br>&nbsp;&nbsp; </span><span class="default">$today </span><span class="keyword">= </span><span class="default">$raw_time</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">'Y-m-d H:i:s.u'</span><span class="keyword">); </span><span class="comment">// This will die when format is attempted on a non-object<br></span><span class="default">?&gt;<br></span><br>The fix is to format the microtime output to force it to always be a float:<br><span class="default">&lt;?php<br>&nbsp;&nbsp; $utime </span><span class="keyword">= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%.4f'</span><span class="keyword">, </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">));<br>&nbsp;&nbsp; </span><span class="default">$raw_time </span><span class="keyword">= </span><span class="default">DateTime</span><span class="keyword">::</span><span class="default">createFromFormat</span><span class="keyword">(</span><span class="string">'U.u'</span><span class="keyword">, </span><span class="default">$utime</span><span class="keyword">);<br>&nbsp;&nbsp; </span><span class="default">$today </span><span class="keyword">= </span><span class="default">$raw_time</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">'Y-m-d H:i:s.u'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Paraphrasing the characters on Silicon Valley, "Always Float! Always Float!&nbsp; Always Float!"</span>
</code></div>
  </div>
 </div>
  <div class="note" id="124127">  
  <a class="name">
  <strong class="user"><em>Carlos Reche</em></strong></a><div class="date" title="2019-08-20 02:19"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom124127">
<div class="phpcode"><code><span class="html">
As previously pointed out, setting the parameter $get_as_float as true will not allow microseconds precision (what would mean 6 decimal digits). It happens because the float returned has a big integer section, what crops the decimal one leaving it with less than 6 digits.<br><br>Here is a solution to easily calculate the execution time of a script without having to alter any configuration parameter. It uses the former way of getting microseconds.<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">class </span><span class="default">Timer </span><span class="keyword">{<br><br>&nbsp; &nbsp; private </span><span class="default">$timeStart</span><span class="keyword">;<br>&nbsp; &nbsp; private </span><span class="default">$microsecondsStart</span><span class="keyword">;<br>&nbsp; &nbsp; private </span><span class="default">$timeStop</span><span class="keyword">;<br>&nbsp; &nbsp; private </span><span class="default">$microsecondsStop</span><span class="keyword">;<br><br>&nbsp; &nbsp; public function </span><span class="default">__construct</span><span class="keyword">() {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">start</span><span class="keyword">();<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; public function </span><span class="default">start</span><span class="keyword">(): </span><span class="default">void </span><span class="keyword">{<br>&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">microsecondsStart</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">timeStart</span><span class="keyword">] = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">, </span><span class="default">microtime</span><span class="keyword">());<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$timeStop&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$microsecondsStop </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; public function </span><span class="default">stop</span><span class="keyword">(): </span><span class="default">void </span><span class="keyword">{<br>&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">microsecondsStop</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">timeStop</span><span class="keyword">] = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">, </span><span class="default">microtime</span><span class="keyword">());<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; public function </span><span class="default">getTime</span><span class="keyword">(): </span><span class="default">float </span><span class="keyword">{<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$timeEnd&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">timeStop</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$microsecondsEnd </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">microsecondsStop</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">$timeEnd</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="default">$microsecondsEnd</span><span class="keyword">, </span><span class="default">$timeEnd</span><span class="keyword">] = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">, </span><span class="default">microtime</span><span class="keyword">());<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$seconds&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">$timeEnd </span><span class="keyword">- </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">timeStart</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$microseconds </span><span class="keyword">= </span><span class="default">$microsecondsEnd </span><span class="keyword">- </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">microsecondsStart</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// now the integer section ($seconds) should be small enough<br>&nbsp; &nbsp; &nbsp; &nbsp; // to allow a float with 6 decimal digits<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">round</span><span class="keyword">((</span><span class="default">$seconds </span><span class="keyword">+ </span><span class="default">$microseconds</span><span class="keyword">), </span><span class="default">6</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>}<br><br></span><span class="default">$t </span><span class="keyword">= new </span><span class="default">Timer</span><span class="keyword">();<br></span><span class="default">usleep</span><span class="keyword">(</span><span class="default">250</span><span class="keyword">);<br>echo </span><span class="default">$t</span><span class="keyword">-&gt;</span><span class="default">getTime</span><span class="keyword">();<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="125754">  
  <a class="name">
  <strong class="user"><em>aldemarcalazans at gmail dot com</em></strong></a><div class="date" title="2021-02-01 08:46"><strong>7 months ago</strong></div>
  <div class="text" id="Hcom125754">
<div class="phpcode"><code><span class="html">
The description of "msec", in this documentation, is very bad.<br><br>It is NOT the microseconds that have elapsed since "sec" (if so, it should be given as an integer, without the "0." in the beginning of the string).<br>It IS the fractional part of the time elapsed since "sec", with microseconds (10E-6) precision, if the last "00" are not considered significant".<br>If the last two digits are significant, then we would have a precision of 10E-8 seconds.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83504">  
  <a class="name">
  <strong class="user"><em>luke at lucanos dot com</em></strong></a><div class="date" title="2008-05-28 04:48"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom83504">
<div class="phpcode"><code><span class="html">
Rather than using the list() function, etc. I have found the following code to be a bit cleaner and simpler:<br><span class="default">&lt;?php<br>$theTime </span><span class="keyword">= </span><span class="default">array_sum</span><span class="keyword">( </span><span class="default">explode</span><span class="keyword">( </span><span class="string">' ' </span><span class="keyword">, </span><span class="default">microtime</span><span class="keyword">() ) );<br>echo </span><span class="default">$theTime</span><span class="keyword">;<br></span><span class="comment"># Displays "1212018372.3366"<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91566">  
  <a class="name">
  <strong class="user"><em>gomodo at free dot fr</em></strong></a><div class="date" title="2009-06-17 03:32"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom91566">
<div class="phpcode"><code><span class="html">
Need a mini benchmark ?<br>Use microtime with this (very smart) benchmark function :<br><br>mixed mini_bench_to(array timelist[, return_array=false])<br>return a mini bench result<br><br>-the timelist first key must be 'start'<br>-default return a resume string, or array if return_array= true :<br>'total_time' (ms) in first row<br>details (purcent) in next row<br><br>example :<br><span class="default">&lt;?php<br></span><span class="keyword">unset(</span><span class="default">$t</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// if previous used<br><br>//-- zone to bench<br></span><span class="default">$t</span><span class="keyword">[</span><span class="string">'start'</span><span class="keyword">] = </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br></span><span class="default">$tab_test</span><span class="keyword">=array(</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">,</span><span class="default">7</span><span class="keyword">,</span><span class="default">8</span><span class="keyword">);<br></span><span class="default">$fact</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;<br></span><span class="default">$t</span><span class="keyword">[</span><span class="string">'init_values'</span><span class="keyword">] = </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br>foreach (</span><span class="default">$tab_test </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$fact</span><span class="keyword">=</span><span class="default">$fact</span><span class="keyword">*</span><span class="default">$value</span><span class="keyword">;<br>}<br></span><span class="default">$t</span><span class="keyword">[</span><span class="string">'loop_fact'</span><span class="keyword">] = </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br>echo </span><span class="string">"fact = "</span><span class="keyword">.</span><span class="default">$fact</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br></span><span class="comment">//-- END zone to bench<br><br></span><span class="keyword">echo </span><span class="string">"---- string result----\n"</span><span class="keyword">;<br></span><span class="default">$str_result_bench</span><span class="keyword">=</span><span class="default">mini_bench_to</span><span class="keyword">(</span><span class="default">$t</span><span class="keyword">);<br>echo </span><span class="default">$str_result_bench</span><span class="keyword">; </span><span class="comment">// string return<br></span><span class="keyword">echo </span><span class="string">"---- tab result----\n"</span><span class="keyword">;<br></span><span class="default">$tab_result_bench</span><span class="keyword">=</span><span class="default">mini_bench_to</span><span class="keyword">(</span><span class="default">$t</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">);<br>echo </span><span class="default">var_export</span><span class="keyword">(</span><span class="default">$tab_result_bench</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>this example return:<br><br>---- string result----<br>total time : 0.0141 ms<br>start -&gt; init_values : 51.1 %<br>init_values -&gt; loop_fact : 48.9 %<br>---- tab result----<br>array (<br>&nbsp; 'total_time' =&gt; 0.0141,<br>&nbsp; 'start -&gt; init_values' =&gt; 51.1,<br>&nbsp; 'init_values -&gt; loop_fact' =&gt; 48.9,<br>)<br><br>The function to include :<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">mini_bench_to</span><span class="keyword">(</span><span class="default">$arg_t</span><span class="keyword">, </span><span class="default">$arg_ra</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) <br>&nbsp; {<br>&nbsp; &nbsp; </span><span class="default">$tttime</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">((</span><span class="default">end</span><span class="keyword">(</span><span class="default">$arg_t</span><span class="keyword">)-</span><span class="default">$arg_t</span><span class="keyword">[</span><span class="string">'start'</span><span class="keyword">])*</span><span class="default">1000</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">);<br>&nbsp; &nbsp; if (</span><span class="default">$arg_ra</span><span class="keyword">) </span><span class="default">$ar_aff</span><span class="keyword">[</span><span class="string">'total_time'</span><span class="keyword">]=</span><span class="default">$tttime</span><span class="keyword">;<br>&nbsp; &nbsp; else </span><span class="default">$aff</span><span class="keyword">=</span><span class="string">"total time : "</span><span class="keyword">.</span><span class="default">$tttime</span><span class="keyword">.</span><span class="string">"ms\n"</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$prv_cle</span><span class="keyword">=</span><span class="string">'start'</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$prv_val</span><span class="keyword">=</span><span class="default">$arg_t</span><span class="keyword">[</span><span class="string">'start'</span><span class="keyword">];<br><br>&nbsp; &nbsp; foreach (</span><span class="default">$arg_t </span><span class="keyword">as </span><span class="default">$cle</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$cle</span><span class="keyword">!=</span><span class="string">'start'</span><span class="keyword">)&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$prcnt_t</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(((</span><span class="default">round</span><span class="keyword">((</span><span class="default">$val</span><span class="keyword">-</span><span class="default">$prv_val</span><span class="keyword">)*</span><span class="default">1000</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">)/</span><span class="default">$tttime</span><span class="keyword">)*</span><span class="default">100</span><span class="keyword">),</span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$arg_ra</span><span class="keyword">) </span><span class="default">$ar_aff</span><span class="keyword">[</span><span class="default">$prv_cle</span><span class="keyword">.</span><span class="string">' -&gt; '</span><span class="keyword">.</span><span class="default">$cle</span><span class="keyword">]=</span><span class="default">$prcnt_t</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aff</span><span class="keyword">.=</span><span class="default">$prv_cle</span><span class="keyword">.</span><span class="string">' -&gt; '</span><span class="keyword">.</span><span class="default">$cle</span><span class="keyword">.</span><span class="string">' : '</span><span class="keyword">.</span><span class="default">$prcnt_t</span><span class="keyword">.</span><span class="string">" %\n"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$prv_val</span><span class="keyword">=</span><span class="default">$val</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$prv_cle</span><span class="keyword">=</span><span class="default">$cle</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; if (</span><span class="default">$arg_ra</span><span class="keyword">) return </span><span class="default">$ar_aff</span><span class="keyword">;<br>&nbsp; &nbsp; return </span><span class="default">$aff</span><span class="keyword">;<br>&nbsp; }<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="121536">  
  <a class="name">
  <strong class="user"><em>how to set nonce value with microtime</em></strong></a><div class="date" title="2017-08-18 10:50"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom121536">
<div class="phpcode"><code><span class="html">
Using microtime() to set 'nonce' value:<br><br>ini_set("precision", 16);<br>$nonce="nonce=".microtime(true)/0.000001;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113078">  
  <a class="name">
  <strong class="user"><em>Daniel Rhodes</em></strong></a><div class="date" title="2013-08-27 12:54"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom113078">
<div class="phpcode"><code><span class="html">
But note that the default 'precision' setting of PHP* - which is used when a float is converted to a stringy format by echo()ing, casting or json_encode()ing etc - is not enough to hold the six digit accuracy of microtime(true).<br><br>Out of the box, microtime(true) will echo something like:<br><br>1377611450.1234<br><br>Which is obviously less than microsecond accuracy. You'll probably want to bump the 'precision' setting up to 16 which will echo something like:<br><br>1377611450.123456<br><br>*Internally* it will be accurate to the six digits even with the default 'precision', but a lot of things (ie. NoSQL databases) are moving to all-text representations these days so it becomes a bit more important.<br><br>* 14 at the time of writing</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101561">  
  <a class="name">
  <strong class="user"><em>Robin Leffmann</em></strong></a><div class="date" title="2010-12-24 12:07"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom101561">
<div class="phpcode"><code><span class="html">
While doing some experiments on using microtime()'s output for an entropy generator I found that its microsecond value was always quantified to the nearest hundreds (i.e. the number ends with 00), which affected the randomness of the entropy generator. This output pattern was consistent on three separate machines, running OpenBSD, Mac OS X and Windows.<br> <br>The solution was to instead use gettimeofday()'s output, as its usec value followed no quantifiable pattern on any of the three test platforms.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="126378">  
  <a class="name">
  <strong class="user"><em>zital at riseup dot net</em></strong></a><div class="date" title="2021-09-01 09:50"><strong>9 days ago</strong></div>
  <div class="text" id="Hcom126378">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php <br></span><span class="comment">//timestamp in milliseconds:<br></span><span class="default">intval</span><span class="keyword">(</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)*</span><span class="default">1000</span><span class="keyword">)<br><br></span><span class="comment">//timestamp in microseconds:<br></span><span class="default">intval</span><span class="keyword">(</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)*</span><span class="default">1000</span><span class="keyword">*</span><span class="default">1000</span><span class="keyword">)<br><br></span><span class="comment">//timestamp in nanoseconds:<br></span><span class="default">intval</span><span class="keyword">(</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)*</span><span class="default">1000</span><span class="keyword">*</span><span class="default">1000</span><span class="keyword">*</span><span class="default">1000</span><span class="keyword">)</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122789">  
  <a class="name">
  <strong class="user"><em>joe from wonderland org</em></strong></a><div class="date" title="2018-06-01 01:10"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122789">
<div class="phpcode"><code><span class="html">
A convenient way to write the current time / microtime as formatted string in your timezone as expression?<br><br><span class="default">&lt;?php<br>$nowDate </span><span class="keyword">= </span><span class="string">'DateTime&nbsp; now is: ' </span><span class="keyword">. (new \</span><span class="default">DateTime</span><span class="keyword">(</span><span class="default">null</span><span class="keyword">,(new \</span><span class="default">DateTimeZone</span><span class="keyword">(</span><span class="string">'Europe/Berlin'</span><span class="keyword">))))-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">'Y-m-d H:i:s'</span><span class="keyword">);<br><br></span><span class="default">$microDate </span><span class="keyword">= </span><span class="string">'Microtime now is: ' </span><span class="keyword">. </span><span class="default">date_create_from_format</span><span class="keyword">( </span><span class="string">'U.u'</span><span class="keyword">, </span><span class="default">number_format</span><span class="keyword">(</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">), </span><span class="default">6</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">))-&gt;</span><span class="default">setTimezone</span><span class="keyword">((new \</span><span class="default">DateTimeZone</span><span class="keyword">(</span><span class="string">'Europe/Berlin'</span><span class="keyword">)))-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">'ymd H:i:s.u e'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>For the microtime expression only the procedural style can be used. If you do not use namespaces the backslashes may be removed.<br>PHP &gt;= 5.4 needed due to accessing a member of a newly created object in a single expression "(new DateTime())-&gt;format('Y-m-d H:i:s.u')"<br><br>DateTime&nbsp; now is: 2018-06-01 14:54:58 Europe/Berlin<br>Microtime now is: 180601 14:54:58.781716 Europe/Berlin</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108255">  
  <a class="name">
  <strong class="user"><em>thomas</em></strong></a><div class="date" title="2012-04-12 02:45"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom108255">
<div class="phpcode"><code><span class="html">
I have been getting negative values substracting a later microtime(true) call from an earlier microtime(true) call on Windows with PHP 5.3.8<br><br>Produces negative values<br>------------------------------<br>for($i = 0; $i&lt;100; $i++) {<br>&nbsp; &nbsp; $x =&nbsp; microtime(true);<br>&nbsp; &nbsp; //short calculation<br>&nbsp; &nbsp; $y = microtime(true);<br>&nbsp; &nbsp; echo ($y-$x) . "\n"; // &lt;--- mostly negatives<br>}<br><br>Calling usleep(1) seems to work<br>---------------------------------------<br>for($i = 0; $i&lt;100; $i++) {<br>&nbsp; &nbsp; $x =&nbsp; microtime(true);<br>&nbsp; &nbsp; //short calculation<br>&nbsp; &nbsp; usleep(1);<br>&nbsp; &nbsp; $y = microtime(true);<br>&nbsp; &nbsp; echo ($y-$x) . "\n"; // &lt;--- fixed now<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="53969">  
  <a class="name">
  <strong class="user"><em>vladson at pc-labs dot info</em></strong></a><div class="date" title="2005-06-19 03:49"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom53969">
<div class="phpcode"><code><span class="html">
I like to use bcmath for it<br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">micro_time</span><span class="keyword">() {<br>&nbsp; &nbsp; </span><span class="default">$temp </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">, </span><span class="default">microtime</span><span class="keyword">());<br>&nbsp; &nbsp; return </span><span class="default">bcadd</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">$temp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">6</span><span class="keyword">);<br>}<br><br></span><span class="default">$time_start </span><span class="keyword">= </span><span class="default">micro_time</span><span class="keyword">();<br></span><span class="default">sleep</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br></span><span class="default">$time_stop </span><span class="keyword">= </span><span class="default">micro_time</span><span class="keyword">();<br><br></span><span class="default">$time_overall </span><span class="keyword">= </span><span class="default">bcsub</span><span class="keyword">(</span><span class="default">$time_stop</span><span class="keyword">, </span><span class="default">$time_start</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">);<br>echo </span><span class="string">"Execution time - </span><span class="default">$time_overall</span><span class="string"> Seconds"</span><span class="keyword">;<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104053">  
  <a class="name">
  <strong class="user"><em>langpavel at phpskelet dot org</em></strong></a><div class="date" title="2011-05-19 01:46"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom104053">
<div class="phpcode"><code><span class="html">
I use this for measure duration of script execution. This function should be defined (and of couse first call made) as soon as possible.<br><br><span class="default">&lt;?php<br></span><span class="comment">/**<br> * get execution time in seconds at current point of call in seconds<br> * @return float Execution time at this point of call<br> */<br></span><span class="keyword">function </span><span class="default">get_execution_time</span><span class="keyword">()<br>{<br>&nbsp; &nbsp; static </span><span class="default">$microtime_start </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br>&nbsp; &nbsp; if(</span><span class="default">$microtime_start </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$microtime_start </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">0.0</span><span class="keyword">; <br>&nbsp; &nbsp; }&nbsp; &nbsp; <br>&nbsp; &nbsp; return </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">) - </span><span class="default">$microtime_start</span><span class="keyword">; <br>}<br></span><span class="default">get_execution_time</span><span class="keyword">();<br><br></span><span class="default">?&gt;<br></span><br>However it is true that result depends of gettimeofday() call. ([jamie at bishopston dot net] wrote this &amp; I can confirm)<br>If system time change, result of this function can be unpredictable (much greater or less than zero).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="66187">  
  <a class="name">
  <strong class="user"><em>EdorFaus</em></strong></a><div class="date" title="2006-05-16 12:47"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom66187">
<div class="phpcode"><code><span class="html">
Of the methods I've seen here, and thought up myself, to convert microtime() output into a numerical value, the microtime_float() one shown in the documentation proper(using explode,list,float,+) is the slowest in terms of runtime.<br><br>I implemented the various methods, ran each in a tight loop 1,000,000 times, and compared runtimes (and output). I did this 10 times to make sure there wasn't a problem of other things putting a load spike on the server. I'll admit I didn't take into account martijn at vanderlee dot com's comments on testing accuracy, but as I figured the looping code etc would be the same, and this was only meant as a relative comparison, it should not be necessary.<br><br>The above method took on average 5.7151877 seconds, while a method using substr and simply adding strings with . took on average 3.0144226 seconds. rsalazar at innox dot com dot mx's method using preg_replace used on average 4.1819633 seconds. This shows that there are indeed differences, but for normal use noone is going to notice it.<br><br>Note that the substr method mentioned isn't quite the one given anonymously below, but one I made based on it:<br><span class="default">&lt;?php<br>$time</span><span class="keyword">=</span><span class="default">microtime</span><span class="keyword">();<br></span><span class="default">$timeval</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$time</span><span class="keyword">,</span><span class="default">11</span><span class="keyword">).</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$time</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Also worth noting is that the microtime_float() method gets faster, and no less accurate, if the (float) conversions are taken out and the variables are simply added together.<br><br>Any of the methods that used + or array_sum ended up rounding the result to 2 digits after the decimal point, while (most of) the ones using preg_replace or substr and . kept all the digits.<br><br>For accurate timing, since floating-point arithmetic would lose precision, I stored microtime results as-is and calculated time difference with this function:<br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">microtime_used</span><span class="keyword">(</span><span class="default">$before</span><span class="keyword">,</span><span class="default">$after</span><span class="keyword">) {<br>&nbsp; &nbsp; return (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$after</span><span class="keyword">,</span><span class="default">11</span><span class="keyword">)-</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$before</span><span class="keyword">,</span><span class="default">11</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; +(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$after</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">)-</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$before</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">));<br>}<br></span><span class="default">?&gt;<br></span><br>For further information, the script itself, etc, see <a rel="nofollow" target="_blank">http://edorfaus.xepher.net/div/convert-method-test.php</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="112725">  
  <a class="name">
  <strong class="user"><em>Nads</em></strong></a><div class="date" title="2013-07-17 08:28"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom112725">
<div class="phpcode"><code><span class="html">
Get date time with milliseconds<br><br>$micro_date = microtime();<br>$date_array = explode(" ",$micro_date);<br>$date = date("Y-m-d H:i:s",$date_array[1]);<br>echo "Date: $date:" . $date_array[0];<br><br>Test accuracy by running it in a loop.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="121830">  
  <a class="name">
  <strong class="user"><em>johovich at yandex dot ru</em></strong></a><div class="date" title="2017-11-05 04:15"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom121830">
<div class="phpcode"><code><span class="html">
//Function to convert microtime return to human readable units<br>//функция для конвертации времени, принимает значения в секундах<br><br>function convert_time($time)<br>{<br>&nbsp; &nbsp; if($time == 0 ){<br>&nbsp; &nbsp; &nbsp; &nbsp; return 0;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; //допустимые единицы измерения<br>&nbsp; &nbsp; $unit=array(-4=&gt;'ps', -3=&gt;'ns',-2=&gt;'mcs',-1=&gt;'ms',0=&gt;'s');<br>&nbsp; &nbsp; //логарифм времени в сек по основанию 1000<br>&nbsp; &nbsp; //берем значение не больше 0, т.к. секунды у нас последняя изменяемая по тысяче величина, дальше по 60<br>&nbsp; &nbsp; $i=min(0,floor(log($time,1000)));<br><br>&nbsp; &nbsp; //тут делим наше время на число соответствующее единицам измерения т.е. на миллион для секунд,<br>&nbsp; &nbsp; //на тысячу для миллисекунд<br>&nbsp; &nbsp; $t = @round($time/pow(1000,$i) , 1);<br>&nbsp; &nbsp; return $t.$unit[$i];<br>}</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.microtime.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 07:28:40 GMT -->

</body></html>
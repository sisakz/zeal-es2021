<html><!-- Mirrored from www.php.net/manual/en/function.mb-substr.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:11:47 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>mb_substr</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.mb-substr.html">
 <link rel="shorturl" href="https://www.php.net/mb-substr">
 <link rel="alternate" href="https://www.php.net/mb-substr" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.mbstring.html">
 <link rel="prev" href="function.mb-substr-count.html">
 <link rel="next" href="book.pspell.html">

 <link rel="alternate" href="function.mb-substr.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.mb-substr.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.mb-substr.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.mb-substr.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.mb-substr.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.mb-substr.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.mb-substr.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.mb-substr.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.mb-substr.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.mb-substr.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.international.html">Human Language and Character Encoding Support</a></li>      <li><a href="book.mbstring.html">Multibyte String</a></li>      <li><a href="ref.mbstring.html">Multibyte String Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.mb-substr" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mb_substr</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.6, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">mb_substr</span> — <span class="dc-title">Get part of string</span></p>

 </div>
   
 <div class="refsect1 description" id="refsect1-function.mb-substr-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mb_substr</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$string</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$start</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">int</span><span class="type"></span></span> <code class="parameter">$length</code><span class="initializer"> = <strong><code>null</code></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">?</span><span class="type"><span class="type">string</span><span class="type"></span></span> <code class="parameter">$encoding</code><span class="initializer"> = <strong><code>null</code></strong></span></span><br>): <span class="type">string</span></div>

  <p class="para rdfs-comment">
   Performs a multi-byte safe
   <span class="function"><a href="function.substr.html" class="function">substr()</a></span> operation based on
   number of characters. Position is
   counted from the beginning of
   <code class="parameter">string</code>. First character's position is
   0. Second character position is 1, and so on. 
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mb-substr-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    
     <dt>
<code class="parameter">string</code></dt>

     <dd>

      <p class="para">
       The <span class="type">string</span> to extract the substring from.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">start</code></dt>

     <dd>

      <p class="para">
       If <code class="parameter">start</code> is non-negative, the returned string
       will start at the <code class="parameter">start</code>'th position in
       <code class="parameter">string</code>, counting from zero. For instance,
       in the string '<code class="literal">abcdef</code>', the character at
       position <code class="literal">0</code> is '<code class="literal">a</code>', the
       character at position <code class="literal">2</code> is
       '<code class="literal">c</code>', and so forth.
      </p>
      <p class="para">
       If <code class="parameter">start</code> is negative, the returned string
       will start at the <code class="parameter">start</code>'th character
       from the end of <code class="parameter">string</code>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">length</code></dt>

     <dd>

      <p class="para">
       Maximum number of characters to use from <code class="parameter">string</code>. If
       omitted or <code class="literal">NULL</code> is passed, extract all characters to
       the end of the string.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">encoding</code></dt>

     <dd>

      <p class="para">The <code class="parameter">encoding</code>
parameter is the character encoding. If it is omitted or <strong><code>null</code></strong>, the internal character
encoding value will be used.</p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mb-substr-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   <span class="function"><strong>mb_substr()</strong></span> returns the portion of
   <code class="parameter">string</code> specified by the
   <code class="parameter">start</code> and
   <code class="parameter">length</code> parameters.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.mb-substr-changelog">
  <h3 class="title">Changelog</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>Version</th>
      <th>Description</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
 <td>8.0.0</td>
 <td>
  <code class="parameter">encoding</code> is nullable now.
 </td>
</tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 seealso" id="refsect1-function.mb-substr-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mb-strcut.html" class="function" rel="rdfs-seeAlso">mb_strcut()</a> - Get part of string</span></li>
    <li class="member"><span class="function"><a href="function.mb-internal-encoding.html" class="function" rel="rdfs-seeAlso">mb_internal_encoding()</a> - Set/Get internal character encoding</span></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="77515">  
  <a class="name">
  <strong class="user"><em>Silvan</em></strong></a><div class="date" title="2007-09-01 03:30"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom77515">
<div class="phpcode"><code><span class="html">
Passing null as length will not make mb_substr use it's default, instead it will interpret it as 0.<br><span class="default">&lt;?php<br>mb_substr</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">,</span><span class="default">null</span><span class="keyword">,</span><span class="default">$encoding</span><span class="keyword">); </span><span class="comment">//Returns '' (empty string) just like substr()<br></span><span class="default">?&gt;<br></span>Instead use:<br><span class="default">&lt;?php<br>mb_substr</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">,</span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">),</span><span class="default">$encoding</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="117764">  
  <a class="name">
  <strong class="user"><em>qbolec at gmail dot com</em></strong></a><div class="date" title="2015-08-05 03:10"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom117764">
<div class="phpcode"><code><span class="html">
As you often need to iterate over UTF-8 characters inside a string, you might be tempted to use mb_substr($text,$i,1).<br>The problem with this is that there is no "magic" way to find $i-th character inside UTF-8 string, other than reading it byte by byte from the begining. Thus a loop which calls mb_substr($text,$i,1) N times for all possible N values of $i, will take much longer than expected. The larger the $i gets, the longer is the search for $i-th letter. As characters are between 1 to 6 bytes long, one can convince oneself, that the execution time of such loop is actually Theta(N^2), which can be really slow even for moderately long texts.<br>One way to work around it is to first split your text into an array of letters using some smart preprocessing, and only then iterate over the array.<br>Here is the idea:<br><span class="default">&lt;?php<br></span><span class="keyword">class </span><span class="default">Strings<br></span><span class="keyword">{<br>&nbsp; public static function </span><span class="default">len</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">){<br>&nbsp; &nbsp; return </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="string">'UTF-8'</span><span class="keyword">);<br>&nbsp; }<br>&nbsp; public static function </span><span class="default">charAt</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">){<br>&nbsp; &nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br>&nbsp; }<br>&nbsp; public static function </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">){<br>&nbsp; &nbsp; if(</span><span class="default">$y</span><span class="keyword">===</span><span class="default">NULL</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$y</span><span class="keyword">=</span><span class="default">self</span><span class="keyword">::</span><span class="default">len</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,</span><span class="string">'UTF-8'</span><span class="keyword">);<br>&nbsp; }<br>&nbsp; public static function </span><span class="default">letters</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">){<br>&nbsp; &nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">len</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br>&nbsp; &nbsp; if(</span><span class="default">$len</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; return array();<br>&nbsp; &nbsp; }else if(</span><span class="default">$len </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; return array(</span><span class="default">$a</span><span class="keyword">);<br>&nbsp; &nbsp; }else{<br>&nbsp; &nbsp; &nbsp; return </span><span class="default">Arrays</span><span class="keyword">::</span><span class="default">concat</span><span class="keyword">(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">letters</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$len</span><span class="keyword">&gt;&gt;</span><span class="default">1</span><span class="keyword">)),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">letters</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$len</span><span class="keyword">&gt;&gt;</span><span class="default">1</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; );<br>&nbsp; &nbsp; }<br>&nbsp; }<br></span><span class="default">?&gt;<br></span>As you can see, the Strings::letters($text) split the text recursively into two parts. Each level of the recursion requires time linear in the length of the string, and there is logarithmic number of levels, so the total runtime is O(N log N), which is still more than theoretically optimal O(N), but sadly this is the best idea I've got.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="55405">  
  <a class="name">
  <strong class="user"><em>xiaogil at yahoo dot fr</em></strong></a><div class="date" title="2005-08-02 08:33"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom55405">
<div class="phpcode"><code><span class="html">
Thanks Darien from /freenode #php for the following example (a little bit changed).<br><br>It just prints the 6th character of $string.<br>You can replace the digits by the same in japanese, chinese or whatever language to make a test, it works perfect.<br><br><span class="default">&lt;?php<br>mb_internal_encoding</span><span class="keyword">(</span><span class="string">"UTF-8"</span><span class="keyword">);<br></span><span class="default">$string </span><span class="keyword">= </span><span class="string">"0123456789"</span><span class="keyword">;<br></span><span class="default">$mystring </span><span class="keyword">= </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br>echo </span><span class="default">$mystring</span><span class="keyword">;<br></span><span class="default">?&gt;<br></span><br>(I couldn't replace 0123456789 by chinese numbers for example here, because it's automatically converted into latin digits on this website, look : <br>&amp;#38646;&amp;#19968;&amp;#20108;&amp;#19977;&amp;#22235;<br>&amp;#20116;&amp;#20845;&amp;#19971;&amp;#20843;&amp;#20061;)<br><br>gilv</span>
</code></div>
  </div>
 </div>
  <div class="note" id="50275">  
  <a class="name">
  <strong class="user"><em>drraf at tlen dot pl</em></strong></a><div class="date" title="2005-02-23 06:44"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom50275">
<div class="phpcode"><code><span class="html">
Note: If borders are out of string - mb_string() returns empty _string_, when function substr() returns _boolean_ false in this case.<br>Keep this in mind when using "===" comparisions.<br><br>Example code:<br><span class="default">&lt;?php<br><br>var_dump</span><span class="keyword">( </span><span class="default">substr</span><span class="keyword">( </span><span class="string">'abc'</span><span class="keyword">, </span><span class="default">5</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) ); </span><span class="comment">// returns "false"<br></span><span class="default">var_dump</span><span class="keyword">( </span><span class="default">mb_substr</span><span class="keyword">( </span><span class="string">'abc'</span><span class="keyword">, </span><span class="default">5</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) ); </span><span class="comment">// returns ""<br><br></span><span class="default">?&gt;<br></span><br>It's especially confusing when using mbstring with function overloading turned on.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112070">  
  <a class="name">
  <strong class="user"><em>desmatic at gmail dot com</em></strong></a><div class="date" title="2013-04-29 03:51"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom112070">
<div class="phpcode"><code><span class="html">
quick and dirty loop through multibyte string<br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">get_character_classes</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">"UTF-8"</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$current_encoding </span><span class="keyword">= </span><span class="default">mb_internal_encoding</span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">mb_internal_encoding</span><span class="keyword">(</span><span class="default">$encoding</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$has </span><span class="keyword">= array();<br>&nbsp; &nbsp; </span><span class="default">$stringlength </span><span class="keyword">= </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br>&nbsp; &nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$stringlength</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if ((</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="string">"0"</span><span class="keyword">) &amp;&amp; (</span><span class="default">$c </span><span class="keyword">&lt;= </span><span class="string">"9"</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'numeric'</span><span class="keyword">] = </span><span class="string">"numeric"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if ((</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="string">"a"</span><span class="keyword">) &amp;&amp; (</span><span class="default">$c </span><span class="keyword">&lt;= </span><span class="string">"z"</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'alpha'</span><span class="keyword">] = </span><span class="string">"alpha"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'alphalower'</span><span class="keyword">] = </span><span class="string">'alphalower'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if ((</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="string">"A"</span><span class="keyword">) &amp;&amp; (</span><span class="default">$c </span><span class="keyword">&lt;= </span><span class="string">"Z"</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'alpha'</span><span class="keyword">] = </span><span class="string">"alpha"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'alphaupper'</span><span class="keyword">] = </span><span class="string">"alphaupper"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if ((</span><span class="default">$c </span><span class="keyword">== </span><span class="string">"$"</span><span class="keyword">) || (</span><span class="default">$c </span><span class="keyword">== </span><span class="string">"£"</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'currency'</span><span class="keyword">] = </span><span class="string">"currency"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if ((</span><span class="default">$c </span><span class="keyword">== </span><span class="string">"."</span><span class="keyword">) &amp;&amp; (</span><span class="default">$has</span><span class="keyword">[</span><span class="string">'decimal'</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'decimals'</span><span class="keyword">] = </span><span class="string">"decimals"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if (</span><span class="default">$c </span><span class="keyword">== </span><span class="string">"."</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'decimal'</span><span class="keyword">] = </span><span class="string">"decimal"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if (</span><span class="default">$c </span><span class="keyword">== </span><span class="string">","</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'comma'</span><span class="keyword">] = </span><span class="string">"comma"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if (</span><span class="default">$c </span><span class="keyword">== </span><span class="string">"-"</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'dash'</span><span class="keyword">] = </span><span class="string">"dash"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if (</span><span class="default">$c </span><span class="keyword">== </span><span class="string">" "</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'space'</span><span class="keyword">] = </span><span class="string">"space"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if (</span><span class="default">$c </span><span class="keyword">== </span><span class="string">"/"</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'slash'</span><span class="keyword">] = </span><span class="string">"slash"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if (</span><span class="default">$c </span><span class="keyword">== </span><span class="string">":"</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'colon'</span><span class="keyword">] = </span><span class="string">"colon"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if ((</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="string">" "</span><span class="keyword">) &amp;&amp; (</span><span class="default">$c </span><span class="keyword">&lt;= </span><span class="string">"~"</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'ascii'</span><span class="keyword">] = </span><span class="string">"ascii"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$has</span><span class="keyword">[</span><span class="string">'binary'</span><span class="keyword">] = </span><span class="string">"binary"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">mb_internal_encoding</span><span class="keyword">(</span><span class="default">$current_encoding</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; return </span><span class="default">$has</span><span class="keyword">;<br>}<br><br></span><span class="default">$string </span><span class="keyword">= </span><span class="string">"1234asdfA£^_{}|}~žščř"</span><span class="keyword">;<br>echo </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">get_character_classes</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">), </span><span class="default">true</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Array<br>(<br>&nbsp; &nbsp; [numeric] =&gt; numeric<br>&nbsp; &nbsp; [alpha] =&gt; alpha<br>&nbsp; &nbsp; [alphalower] =&gt; alphalower<br>&nbsp; &nbsp; [alphaupper] =&gt; alphaupper<br>&nbsp; &nbsp; [currency] =&gt; currency<br>&nbsp; &nbsp; [ascii] =&gt; ascii<br>&nbsp; &nbsp; [binary] =&gt; binary<br>)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="106737">  
  <a class="name">
  <strong class="user"><em>p dot assenov at aip-solutions dot com</em></strong></a><div class="date" title="2011-12-02 09:17"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom106737">
<div class="phpcode"><code><span class="html">
I'm trying to capitalize only the first character of the string and tried some of the examples above but they didn't work. It seems mb_substr() cannot calculate the length of the string in multi-byte encoding (UTF-8) and it should be set explicitly. Here is the corrected version:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">mb_ucfirst</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$enc </span><span class="keyword">= </span><span class="string">'utf-8'</span><span class="keyword">) {
<br>&nbsp; &nbsp; return </span><span class="default">mb_strtoupper</span><span class="keyword">(</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">$enc</span><span class="keyword">), </span><span class="default">$enc</span><span class="keyword">).</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$enc</span><span class="keyword">), </span><span class="default">$enc</span><span class="keyword">);
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>cheers!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="119517">  
  <a class="name">
  <strong class="user"><em>qdinar at gmail dot com</em></strong></a><div class="date" title="2016-06-27 04:06"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom119517">
<div class="phpcode"><code><span class="html">
you can make mb_substr working faster with long strings with usage of ucs-2 encoding.<br><br><span class="default">&lt;?php<br><br>header</span><span class="keyword">(</span><span class="string">'Content-Type: text/html; charset=utf-8'</span><span class="keyword">);<br>echo </span><span class="string">'&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" &gt;'</span><span class="keyword">;<br><br>function </span><span class="default">test</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">=</span><span class="string">'utf8'</span><span class="keyword">){<br>&nbsp; &nbsp; </span><span class="default">$t1</span><span class="keyword">=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$textlen</span><span class="keyword">=</span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$substr_len</span><span class="keyword">=</span><span class="default">3</span><span class="keyword">;<br>&nbsp; &nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$textlen</span><span class="keyword">-</span><span class="default">$substr_len</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$substr</span><span class="keyword">=</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">$substr_len</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; echo </span><span class="string">'mb_substr, '</span><span class="keyword">.</span><span class="default">$encoding</span><span class="keyword">.</span><span class="string">': '</span><span class="keyword">.(</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)-</span><span class="default">$t1</span><span class="keyword">);<br>&nbsp; &nbsp; echo </span><span class="string">' . check: '</span><span class="keyword">;<br>&nbsp; &nbsp; if(</span><span class="default">$encoding</span><span class="keyword">==</span><span class="string">'ucs2'</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$substr</span><span class="keyword">=</span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$substr</span><span class="keyword">,</span><span class="string">'utf-8'</span><span class="keyword">,</span><span class="string">'ucs2'</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">var_dump</span><span class="keyword">( </span><span class="default">$substr </span><span class="keyword">);<br>&nbsp; &nbsp; echo </span><span class="string">' . &lt;br&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br>}<br><br></span><span class="default">$corpus_short</span><span class="keyword">=</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">'тест Тест '</span><span class="keyword">,</span><span class="default">1000</span><span class="keyword">);<br></span><span class="comment">// it works likewise slowly with "test Test" with utf8<br></span><span class="default">mb_internal_encoding</span><span class="keyword">(</span><span class="string">'utf-8'</span><span class="keyword">);<br></span><span class="default">test</span><span class="keyword">(</span><span class="default">$corpus_short</span><span class="keyword">);<br><br></span><span class="default">$corpus_short_ucs2</span><span class="keyword">=</span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$corpus_short</span><span class="keyword">,</span><span class="string">'ucs2'</span><span class="keyword">,</span><span class="string">'utf-8'</span><span class="keyword">);<br></span><span class="default">mb_internal_encoding</span><span class="keyword">(</span><span class="string">'ucs2'</span><span class="keyword">);<br></span><span class="default">test</span><span class="keyword">(</span><span class="default">$corpus_short_ucs2</span><span class="keyword">,</span><span class="string">'ucs2'</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>output:<br><br>mb_substr, utf8: 0.26480984687805 . check: string(5) "ст " .<br><br>mb_substr, ucs2: 0.0048871040344238 . check: string(5) "ст " .</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113329">  
  <a class="name">
  <strong class="user"><em>sanjuro at 1up-games dot com</em></strong></a><div class="date" title="2013-09-27 06:18"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom113329">
<div class="phpcode"><code><span class="html">
A serious pitfall when using mb_substr() set to HTML-ENTITIES encoding is that the function performs a number of conversions before returning the value, the worst one being that html special characters are not just counted but decoded.<br><br><span class="default">&lt;?php<br><br>mb_internal_encoding</span><span class="keyword">(</span><span class="string">"ISO-8859-1"</span><span class="keyword">); echo </span><span class="default">mb_internal_encoding</span><span class="keyword">(),</span><span class="string">"\n&lt;br&gt;&lt;br&gt;\n"</span><span class="keyword">;<br><br></span><span class="default">$a</span><span class="keyword">=</span><span class="string">'j&amp;uuml;st &amp;#228; &amp;quot; simple &amp;quot; &amp;#26085;&amp;#26412; &amp;lt;b&amp;gt;test&amp;lt;/b&amp;gt;'</span><span class="keyword">;<br><br>echo </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">),</span><span class="string">"\n&lt;br&gt;&lt;br&gt;\n"</span><span class="keyword">;<br></span><span class="comment">// page source: j&amp;uuml;st &amp;#228; &amp;quot; simple &amp;quot; &amp;#26085;&amp;#26412; &amp;lt;b&amp;gt;test&amp;lt;/b&amp;gt;<br><br></span><span class="keyword">echo </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">),</span><span class="string">'HTML-ENTITIES'</span><span class="keyword">);<br></span><span class="comment">// page source: j&amp;uuml;st &amp;auml; " simple " &amp;#26085;&amp;#26412; &lt;b&gt;test&lt;/b&gt;<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86473">  
  <a class="name">
  <strong class="user"><em>projektas at gmail dot com</em></strong></a><div class="date" title="2008-10-21 06:29"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom86473">
<div class="phpcode"><code><span class="html">
First letter in upper case &lt;hr /&gt;<br><br><span class="default">&lt;?php<br>header </span><span class="keyword">(</span><span class="string">'Content-type: text/html; charset=utf-8'</span><span class="keyword">);<br><br>if (isset(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'check'</span><span class="keyword">]) &amp;&amp; !empty(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'check'</span><span class="keyword">])) {<br>&nbsp; &nbsp; echo </span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">ucfirst_utf8</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'check'</span><span class="keyword">]));<br>} else {<br>&nbsp; &nbsp; echo </span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">ucfirst_utf8</span><span class="keyword">(</span><span class="string">'Žąsinų'</span><span class="keyword">));<br>}<br><br>function </span><span class="default">ucfirst_utf8</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br>&nbsp; &nbsp; if (</span><span class="default">mb_check_encoding</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="string">'UTF-8'</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$first </span><span class="keyword">= </span><span class="default">mb_substr</span><span class="keyword">(<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">mb_strtoupper</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="string">"utf-8"</span><span class="keyword">),</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="string">'utf-8'<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$first</span><span class="keyword">.</span><span class="default">mb_substr</span><span class="keyword">(<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">mb_strtolower</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="string">"utf-8"</span><span class="keyword">),</span><span class="default">1</span><span class="keyword">,</span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">),</span><span class="string">'utf-8'<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">);<br>&nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$str</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;<br></span><br>&lt;form method="post" action="" &gt;<br>&nbsp; &nbsp; &lt;input type="input" name="check" /&gt;<br>&nbsp; &nbsp; &lt;input type="submit" /&gt;<br>&lt;/form&gt;</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.mb-substr.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:11:47 GMT -->

</body></html>
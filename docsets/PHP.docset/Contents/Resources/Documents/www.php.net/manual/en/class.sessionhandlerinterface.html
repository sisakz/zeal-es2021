<html><!-- Mirrored from www.php.net/manual/en/class.sessionhandlerinterface.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 05:37:41 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>SessionHandlerInterface</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="class.sessionhandlerinterface.html">
 <link rel="shorturl" href="https://www.php.net/sessionhandlerinterface">
 <link rel="alternate" href="https://www.php.net/sessionhandlerinterface" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="book.session.html">
 <link rel="prev" href="sessionhandler.write.html">
 <link rel="next" href="sessionhandlerinterface.close.html">

 <link rel="alternate" href="class.sessionhandlerinterface.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/class.sessionhandlerinterface.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/class.sessionhandlerinterface.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/class.sessionhandlerinterface.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/class.sessionhandlerinterface.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/class.sessionhandlerinterface.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/class.sessionhandlerinterface.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/class.sessionhandlerinterface.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/class.sessionhandlerinterface.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/class.sessionhandlerinterface.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.session.html">Session Extensions</a></li>      <li><a href="book.session.html">Sessions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="class.sessionhandlerinterface" class="reference">

 <h1 class="title">The SessionHandlerInterface class</h1>
 

 <div class="partintro"><p class="verinfo">(PHP 5 &gt;= 5.4.0, PHP 7, PHP 8)</p>


  <div class="section" id="sessionhandlerinterface.intro">
   <h2 class="title">Introduction</h2>
   <p class="para">
    <span class="classname"><strong class="classname">SessionHandlerInterface</strong></span> is an interface which defines the minimal
    prototype for creating a custom session handler. In order to pass a custom
    session handler to <span class="function"><a href="function.session-set-save-handler.html" class="function">session_set_save_handler()</a></span> using its
    <abbr class="abbrev">OOP</abbr> invocation, the class can implement this interface.
   </p>
   <p class="para">
    Please note the callback methods of this class are designed to be called internally by
    PHP and are not meant to be called from user-space code.
   </p>
  </div>


  <div class="section" id="sessionhandlerinterface.synopsis">
   <h2 class="title">Interface synopsis</h2>


   <div class="classsynopsis">
    <div class="ooclass"></div>


    <div class="classsynopsisinfo">
     <span class="oointerface">
      <span class="modifier">interface</span> <strong class="interfacename">SessionHandlerInterface</strong></span> {</div>


    <div class="classsynopsisinfo classsynopsisinfo_comment">/* Methods */</div>
    <div class="methodsynopsis dc-description">
   <span class="modifier">abstract</span> <span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.close.html" class="methodname">close</a></span>(): <span class="type">bool</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">abstract</span> <span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.destroy.html" class="methodname">destroy</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$id</code></span>): <span class="type">bool</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">abstract</span> <span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.gc.html" class="methodname">gc</a></span>(<span class="methodparam"><span class="type">int</span> <code class="parameter">$max_lifetime</code></span>): <span class="type"><span class="type">int</span>|<span class="type"><span class="type false">false</span></span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">abstract</span> <span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.open.html" class="methodname">open</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$path</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$name</code></span>): <span class="type">bool</span></div>
<div class="methodsynopsis dc-description"><span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.read.html" class="methodname">read</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$id</code></span>): <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>
<div class="methodsynopsis dc-description"><span class="modifier">abstract</span> <span class="modifier">public</span> <span class="methodname"><a href="sessionhandlerinterface.write.html" class="methodname">write</a></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$id</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>): <span class="type">bool</span></div>

   }</div>


  </div>

  <div class="section" id="sessionhandlerinterface.examples">
   <div class="example" id="example-4691">
    <p><strong>Example #1 
     Example using <span class="classname"><strong class="classname">SessionHandlerInterface</strong></span>
    </strong></p>
    <div class="example-contents"><p>
     The following example provides file based session storage similar to the
     PHP sessions default save handler <code class="parameter">files</code>.  This
     example could easily be extended to cover database storage using your
     favorite PHP supported database engine.
    </p></div>
    <div class="example-contents"><p>
     Note we use the OOP prototype with <span class="function"><a href="function.session-set-save-handler.html" class="function">session_set_save_handler()</a></span> and
     register the shutdown function using the function's parameter flag.  This is generally
     advised when registering objects as session save handlers.
    </p></div>
    <div class="caution"><strong class="caution">Caution</strong>
     <p class="para">
      For brevity, this example omits input validation. However, the
      <code class="literal">$id</code> parameters are actually user supplied values which
      require proper validation/sanitization to avoid vulnerabilities, such as
      path traversal issues. <em class="emphasis">So do not use this example unmodified in
      production environments.</em>
     </p>
    </div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">MySessionHandler&nbsp;</span><span style="color: #007700">implements&nbsp;</span><span style="color: #0000BB">SessionHandlerInterface<br></span><span style="color: #007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;</span><span style="color: #0000BB">$savePath</span><span style="color: #007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #0000BB">$savePath</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sessionName</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$savePath</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">is_dir</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">mkdir</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0777</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">close</span><span style="color: #007700">()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">read</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(string)@</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #DD0000">/sess_</span><span style="color: #0000BB">$id</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">file_put_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #DD0000">/sess_</span><span style="color: #0000BB">$id</span><span style="color: #DD0000">"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">)&nbsp;===&nbsp;</span><span style="color: #0000BB">false&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">false&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">destroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$file&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #DD0000">/sess_</span><span style="color: #0000BB">$id</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">file_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">unlink</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">gc</span><span style="color: #007700">(</span><span style="color: #0000BB">$maxlifetime</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">glob</span><span style="color: #007700">(</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">savePath</span><span style="color: #DD0000">/sess_*"</span><span style="color: #007700">)&nbsp;as&nbsp;</span><span style="color: #0000BB">$file</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">filemtime</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">)&nbsp;+&nbsp;</span><span style="color: #0000BB">$maxlifetime&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">()&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">file_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">unlink</span><span style="color: #007700">(</span><span style="color: #0000BB">$file</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br></span><span style="color: #0000BB">$handler&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">MySessionHandler</span><span style="color: #007700">();<br></span><span style="color: #0000BB">session_set_save_handler</span><span style="color: #007700">(</span><span style="color: #0000BB">$handler</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br></span><span style="color: #0000BB">session_start</span><span style="color: #007700">();<br><br></span><span style="color: #FF8000">//&nbsp;proceed&nbsp;to&nbsp;set&nbsp;and&nbsp;retrieve&nbsp;values&nbsp;by&nbsp;key&nbsp;from&nbsp;$_SESSION</span>
</span>
</code></div>
    </div>

   </div>
  </div>

 </div>

 































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="sessionhandlerinterface.close.html">SessionHandlerInterface::close</a> — Close the session</li><li><a href="sessionhandlerinterface.destroy.html">SessionHandlerInterface::destroy</a> — Destroy a session</li><li><a href="sessionhandlerinterface.gc.html">SessionHandlerInterface::gc</a> — Cleanup old sessions</li><li><a href="sessionhandlerinterface.open.html">SessionHandlerInterface::open</a> — Initialize session</li><li><a href="sessionhandlerinterface.read.html">SessionHandlerInterface::read</a> — Read session data</li><li><a href="sessionhandlerinterface.write.html">SessionHandlerInterface::write</a> — Write session data</li></ul>
</div>

<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="122032">  
  <a class="name">
  <strong class="user"><em>ohcc at 163 dot com</em></strong></a><div class="date" title="2017-12-16 04:50"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122032">
<div class="phpcode"><code><span class="html">
As of PHP 7.0, you can implement SessionUpdateTimestampHandlerInterface to <br>define your own session id validating method like validate_sid and the timestamp updating method like update_timestamp in the non-OOP prototype of session_set_save_handler().<br><br>SessionUpdateTimestampHandlerInterface is a new interface introduced in PHP 7.0, which has not been documented yet. It has two abstract methods: SessionUpdateTimestampHandlerInterface :: validateId($sessionId) and SessionUpdateTimestampHandlerInterface :: updateTimestamp($sessionId, $sessionData).<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="comment">/*<br>&nbsp; &nbsp; &nbsp;&nbsp; @author Wu Xiancheng<br>&nbsp; &nbsp; &nbsp;&nbsp; Code structure for PHP 7.0+ only because SessionUpdateTimestampHandlerInterface is introduced in PHP 7.0<br>&nbsp; &nbsp; &nbsp;&nbsp; With this class you can validate php session id and update the timestamp of php session data<br>&nbsp; &nbsp; &nbsp;&nbsp; with the OOP prototype of session_set_save_handler() in PHP 7.0+<br>&nbsp; &nbsp; */<br>&nbsp; &nbsp; </span><span class="keyword">class </span><span class="default">PHPSessionXHandler </span><span class="keyword">implements </span><span class="default">SessionHandlerInterface</span><span class="keyword">, </span><span class="default">SessionUpdateTimestampHandlerInterface </span><span class="keyword">{<br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">close</span><span class="keyword">(){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// return value should be true for success or false for failure<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ...<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">destroy</span><span class="keyword">(</span><span class="default">$sessionId</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// return value should be true for success or false for failure<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ... <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">gc</span><span class="keyword">(</span><span class="default">$maximumLifetime</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// return value should be true for success or false for failure<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ...<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">open</span><span class="keyword">(</span><span class="default">$sessionSavePath</span><span class="keyword">, </span><span class="default">$sessionName</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// return value should be true for success or false for failure<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ...<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">read</span><span class="keyword">(</span><span class="default">$sessionId</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// return value should be the session data or an empty string<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ...<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">write</span><span class="keyword">(</span><span class="default">$sessionId</span><span class="keyword">, </span><span class="default">$sessionData</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// return value should be true for success or false for failure<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ...<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">create_sid</span><span class="keyword">(){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// available since PHP 5.5.1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // invoked internally when a new session id is needed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // no parameter is needed and return value should be the new session id created<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ...<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">validateId</span><span class="keyword">(</span><span class="default">$sessionId</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// implements SessionUpdateTimestampHandlerInterface::validateId()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // available since PHP 7.0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // return value should be true if the session id is valid otherwise false<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // if false is returned a new session id will be generated by php internally<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ...<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">updateTimestamp</span><span class="keyword">(</span><span class="default">$sessionId</span><span class="keyword">, </span><span class="default">$sessionData</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// implements SessionUpdateTimestampHandlerInterface::validateId()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // available since PHP 7.0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // return value should be true for success or false for failure<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ...<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; }<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122030">  
  <a class="name">
  <strong class="user"><em>ohcc at 163 dot com</em></strong></a><div class="date" title="2017-12-16 08:06"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122030">
<div class="phpcode"><code><span class="html">
The non-OOP prototype of session_set_save_handler() supports validate_sid and update_timestamp as of PHP 7.0 while the OOP prototype doesn't even in PHP 7.2. However the OOP prototype does support create_sid since PHP 5.5.1.<br><br>validate_sid($sessionId)<br>&nbsp; This callback is to validate $sessionId. Its return value should be true for valid session id $sessionId or false for invalid session id $sessionId. If false is returned, a new session id is generated to replace the invalid session id $sessionId.<br><br>update_timestamp($sessionId)<br>&nbsp; This call back is to update timestamp, and its return value should be true for success or false for failure.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="116288">  
  <a class="name">
  <strong class="user"><em>avenidagez at foro5 dot com</em></strong></a><div class="date" title="2014-12-06 03:54"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom116288">
<div class="phpcode"><code><span class="html">
Note that session_start( ) calls open then read and the class returns true for open and the value of session or empty for read.<br>Well, then there is no catch for errors, this is, session_start() must return false on failure, but that is not the case for the class implementation on method open, no matter if you return true or false or whatever from open, it is ignored by session_start() function and proceeds to read method<br>A bug?, if open returns false, session_start() should stop the next step (read) and return itself false<br><br>if(session_start()) ...code<br>else exit( );<br><br>So forget about session_start() return value, you need to implement an error catch routine and exit() in case of failure on open method</span>
</code></div>
  </div>
 </div>
  <div class="note" id="110125">  
  <a class="name">
  <strong class="user"><em>warxcell at gmail dot com</em></strong></a><div class="date" title="2012-09-21 11:12"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom110125">
<div class="phpcode"><code><span class="html">
You should prepend &lt;b&gt;\&lt;/b&gt; before class name, to tell php its from root namespace.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122817">  
  <a class="name">
  <strong class="user"><em>tony at marston-home dot demon dot co dot uk</em></strong></a><div class="date" title="2018-06-10 03:45"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122817">
<div class="phpcode"><code><span class="html">
Your custom session handler should not contain calls to any of the session functions, such as session_name() or session_id(), as the relevant values are passed as arguments on various handler methods. Attempting to obtain values from alternative sources may not work as expected.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="124839">  
  <a class="name">
  <strong class="user"><em>ohcc at 163 dot com</em></strong></a><div class="date" title="2020-03-22 01:50"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom124839">
<div class="phpcode"><code><span class="html">
If you want to use type declarations in your own session handling class, don't "implements" the SessionHandlerInterface, SessionIdInterface, or SessinUpdateTimestampInterface, otherwise you will get a fatal error saying that declaration of the class method must be compatible with the interface method.<br><br>a bad example<br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="keyword">class </span><span class="default">SessionWuXianchengHandler </span><span class="keyword">implements </span><span class="default">SessionHandlerInterface </span><span class="keyword">{&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">open</span><span class="keyword">(</span><span class="default">string $sessionPath</span><span class="keyword">, </span><span class="default">string $sessionName</span><span class="keyword">) : </span><span class="default">bool </span><span class="keyword">{<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; ......<br>&nbsp; &nbsp; }<br></span><span class="default">?&gt;<br></span><br>a good example<br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="keyword">class </span><span class="default">SessionWuXianchengHandler </span><span class="keyword">{<br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">open</span><span class="keyword">(</span><span class="default">string $sessionPath</span><span class="keyword">, </span><span class="default">string $sessionName</span><span class="keyword">) : </span><span class="default">bool </span><span class="keyword">{<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; ......<br>&nbsp; &nbsp; }<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="121970">  
  <a class="name">
  <strong class="user"><em>ohcc at 163 dot com</em></strong></a><div class="date" title="2017-12-03 10:40"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom121970">
<div class="phpcode"><code><span class="html">
As of PHP 5.5.1, another method create_sid() is supported. It will be called when session_regenerate_id() is invoked.<br><br>SessionHandlerInterface {<br>&nbsp; &nbsp; /* Methods */<br>&nbsp; &nbsp; abstract public bool close ( void )<br>&nbsp; &nbsp; abstract public bool create_sid ( void )&nbsp; &nbsp; <br>&nbsp; &nbsp; abstract public bool destroy ( string $session_id )<br>&nbsp; &nbsp; abstract public bool gc ( int $maxlifetime )<br>&nbsp; &nbsp; abstract public bool open ( string $save_path , string $session_name )<br>&nbsp; &nbsp; abstract public string read ( string $session_id )<br>&nbsp; &nbsp; abstract public bool write ( string $session_id , string $session_data )<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="118246">  
  <a class="name">
  <strong class="user"><em>StanE</em></strong></a><div class="date" title="2015-11-02 07:46"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom118246">
<div class="phpcode"><code><span class="html">
I think there is a small "error" in the example of the class MySessionHandler in method gc(). It uses the function filemtime() whose return value is cached by PHP. Add the following line inside the foreach block in the gc() method:<br><br>clearstatcache(true, $file);</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/class.sessionhandlerinterface.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 05:37:41 GMT -->

</body></html>
<html><!-- Mirrored from www.php.net/manual/en/faq.passwords.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 01:57:21 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Password Hashing</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="faq.passwords.html">
 <link rel="shorturl" href="https://www.php.net/passwords">
 <link rel="alternate" href="https://www.php.net/passwords" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="faq.html">
 <link rel="prev" href="faq.using.html">
 <link rel="next" href="faq.html.html">

 <link rel="alternate" href="faq.passwords.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/faq.passwords.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/faq.passwords.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/faq.passwords.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/faq.passwords.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/faq.passwords.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/faq.passwords.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/faq.passwords.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/faq.passwords.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/faq.passwords.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="faq.html">FAQ</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="faq.passwords" class="chapter">
  <h1>Safe Password Hashing</h1>

  
  
  <p class="para">
   This section explains the reasons behind using hashing functions
   to secure passwords, as well as how to do so effectively.
  </p>
  
  <div class="qandaset"><ol class="qandaset_questions"><li><a href="#faq.passwords.hashing">
     
      Why should I hash passwords supplied by users of my application?
     
    </a></li><li><a href="#faq.passwords.fasthash">
     
      Why are common hashing functions such as md5 and
      sha1 unsuitable for passwords?
     
    </a></li><li><a href="#faq.passwords.bestpractice">
     
      How should I hash my passwords, if the common hash functions are
      not suitable?
     
    </a></li><li><a href="#faq.passwords.salt">
     
      What is a salt?
     
    </a></li><li><a href="#faq.password.storing-salts">
     
      How do I store my salts?
     
    </a></li></ol></div>
   <dl class="qandaentry" id="faq.passwords.hashing">
    <dt><strong>
     
      Why should I hash passwords supplied by users of my application?
     
    </strong></dt>
    <dd class="answer">
     <p class="para">
      Password hashing is one of the most basic security considerations that
      must be made when designing any application that accepts passwords
      from users. Without hashing, any passwords that are stored in your
      application's database can be stolen if the database is compromised, and
      then immediately used to compromise not only your application, but also
      the accounts of your users on other services, if they do not use
      unique passwords.
     </p>
     <p class="para">
      By applying a hashing algorithm to your user's passwords before storing
      them in your database, you make it implausible for any attacker to
      determine the original password, while still being able to compare
      the resulting hash to the original password in the future.
     </p>
     <p class="para">
      It is important to note, however, that hashing passwords only protects
      them from being compromised in your data store, but does not necessarily
      protect them from being intercepted by malicious code injected into your
      application itself.
     </p>
    </dd>
   </dl>
   <dl class="qandaentry" id="faq.passwords.fasthash">
    <dt><strong>
     
      Why are common hashing functions such as <span class="function"><a href="function.md5.html" class="function">md5()</a></span> and
      <span class="function"><a href="function.sha1.html" class="function">sha1()</a></span> unsuitable for passwords?
     
    </strong></dt>
    <dd class="answer">
     <p class="para">
      Hashing algorithms such as MD5, SHA1 and SHA256 are designed to be
      very fast and efficient. With modern techniques and computer equipment,
      it has become trivial to "brute force" the output of these algorithms,
      in order to determine the original input.
     </p>
     <p class="para">
      Because of how quickly a modern computer can "reverse" these hashing
      algorithms, many security professionals strongly suggest against
      their use for password hashing.
     </p>
    </dd>
   </dl>
   <dl class="qandaentry" id="faq.passwords.bestpractice">
    <dt><strong>
     
      How should I hash my passwords, if the common hash functions are
      not suitable?
     
    </strong></dt>
    <dd class="answer">
     <p class="para">
      When hashing passwords, the two most important considerations are the
      computational expense, and the salt. The more computationally expensive
      the hashing algorithm, the longer it will take to brute force its
      output.
     </p>
     <p class="para">
      PHP provides
      <a href="book.password.html" class="link">a native password hashing API</a> that
      safely handles both <a href="function.password-hash.html" class="link">hashing</a>
      and <a href="function.password-verify.html" class="link">verifying passwords</a>
      in a secure manner.
     </p>
     
     <p class="para">
      Another option is the <span class="function"><a href="function.crypt.html" class="function">crypt()</a></span> function, which
      supports several hashing algorithms. When using
      this function, you are guaranteed that the algorithm you select is
      available, as PHP contains native implementations of each supported
      algorithm, in case one or more are not supported by your system.
     </p>
     <p class="para">
      The suggested algorithm to use when hashing passwords is Blowfish, which
      is also the default used by the password hashing API, as it is
      significantly more computationally expensive than MD5 or SHA1, while
      still being scalable.
     </p>
     <p class="para">
      Note that if you are using <span class="function"><a href="function.crypt.html" class="function">crypt()</a></span> to verify a
      password, you will need to take care to prevent timing attacks by using
      a constant time string comparison. Neither PHP's
      <a href="language.operators.comparison.html" class="link">== and === operators</a>
      nor <span class="function"><a href="function.strcmp.html" class="function">strcmp()</a></span> perform constant time string
      comparisons. As <span class="function"><a href="function.password-verify.html" class="function">password_verify()</a></span> will do this for
      you, you are strongly encouraged to use the
      <a href="book.password.html" class="link">native password hashing API</a>
      whenever possible.
     </p>
    </dd>
   </dl>
   <dl class="qandaentry" id="faq.passwords.salt">
    <dt><strong>
     
      What is a salt?
     
    </strong></dt>
    <dd class="answer">
     <p class="para">
      A cryptographic salt is data which is applied during the hashing process
      in order to eliminate the possibility of the output being looked up
      in a list of pre-calculated pairs of hashes and their input, known as
      a rainbow table.
     </p>
     <p class="para">
      In more simple terms, a salt is a bit of additional data which makes
      your hashes significantly more difficult to crack. There are a number of
      services online which provide extensive lists of pre-computed hashes, as
      well as the original input for those hashes. The use of a salt makes it
      implausible or impossible to find the resulting hash in one of these
      lists.
     </p>
     <p class="para">
      <span class="function"><a href="function.password-hash.html" class="function">password_hash()</a></span> will create a random salt if one
      isn't provided, and this is generally the easiest and most secure
      approach.
     </p>
    </dd>
   </dl>
   <dl class="qandaentry" id="faq.password.storing-salts">
    <dt><strong>
     
      How do I store my salts?
     
    </strong></dt>
    <dd class="answer">
     <p class="para">
      When using <span class="function"><a href="function.password-hash.html" class="function">password_hash()</a></span> or
      <span class="function"><a href="function.crypt.html" class="function">crypt()</a></span>, the return value includes the salt as part
      of the generated hash. This value should be stored verbatim in your
      database, as it includes information about the hash function that was
      used and can then be given directly to
      <span class="function"><a href="function.password-verify.html" class="function">password_verify()</a></span> or <span class="function"><a href="function.crypt.html" class="function">crypt()</a></span> when
      verifying passwords.
     </p>
     <p class="para">
      The following diagram shows the format of a return value from
      <span class="function"><a href="function.crypt.html" class="function">crypt()</a></span> or <span class="function"><a href="function.password-hash.html" class="function">password_hash()</a></span>. As you
      can see, they are self-contained, with all the information on the
      algorithm and salt required for future password verification.
     </p>
     <p class="para">
      </p><div class="mediaobject">
       
       <div class="imageobject">
        <img src="images/2a34c7f2e658f6ae74f3869f2aa5886f-crypt-text-rendered.svg" alt="
        The components of the value returned by password_hash and crypt: in
        order, the chosen algorithm, the algorithm's options, the salt used,
        and the hashed password.
       " width="690" height="192">
       </div>
      </div>
     <p></p>
    </dd>
   </dl>
  
  
 </div>

<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="114618">  
  <a class="name">
  <strong class="user"><em>alf dot henrik at ascdevel dot com</em></strong></a><div class="date" title="2014-03-12 07:58"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom114618">
<div class="phpcode"><code><span class="html">
I feel like I should comment some of the clams being posted as replies here.<br><br>For starters, speed IS an issue with MD5 in particular and also SHA1. I've written my own MD5 bruteforce application just for the fun of it, and using only my CPU I can easily check a hash against about 200mill. hash per second. The main reason for this speed is that you for most attempts can bypass 19 out of 64 steps in the algorithm. For longer input (&gt; 16 characters) it won't apply, but I'm sure there's some ways around it.<br><br>If you search online you'll see people claiming to be able to check against billions of hashes per second using GPUs. I wouldn't be surprised if it's possible to reach 100 billion per second on a single computer alone these days, and it's only going to get worse. It would require a watt monster with 4 dual high-end GPUs or something, but still possible.<br><br>Here's why 100 billion per second is an issue:<br>Assume most passwords contain a selection of 96 characters. A password with 8 characters would then have 96^8 = 7,21389578984e+15 combinations.<br>With 100 billion per second it would then take 7,21389578984e+15 / 3600 = ~20 hours to figure out what it actually says. Keep in mind that you'll need to add the numbers for 1-7 characters as well. 20 hours is not a lot if you want to target a single user. <br><br>So on essence:<br>There's a reason why newer hash algorithms are specifically designed not to be easily implemented on GPUs.<br><br>Oh, and I can see there's someone mentioning MD5 and rainbow tables. If you read the numbers here, I hope you realize how incredibly stupid and useless rainbow tables have become in terms of MD5. Unless the input to MD5 is really huge, you're just not going to be able to compete with GPUs here. By the time a storage media is able to produce far beyond 3TB/s, the CPUs and GPUs will have reached much higher speeds.<br><br>As for SHA1, my belief is that it's about a third slower than MD5. I can't verify this myself, but it seems to be the case judging the numbers presented for MD5 and SHA1. The issue with speeds is basically very much the same here as well.<br><br>The moral here:<br>Please do as told. Don't every use MD5 and SHA1 for hasing passwords ever again. We all know passwords aren't going to be that long for most people, and that's a major disadvantage. Adding long salts will help for sure, but unless you want to add some hundred bytes of salt, there's going to be fast bruteforce applications out there ready to reverse engineer your passwords or your users' passwords.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="119525">  
  <a class="name">
  <strong class="user"><em>swardx at gmail dot com</em></strong></a><div class="date" title="2016-06-29 09:36"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom119525">
<div class="phpcode"><code><span class="html">
A great read..<br><br><a rel="nofollow" target="_blank">https://nakedsecurity.sophos.com/2013/11/20/serious-security-how-to-store-your-users-passwords-safely/</a><br><br>Serious Security: How to store your users’ passwords safely<br><br>In summary, here is our minimum recommendation for safe storage of your users’ passwords:<br><br>&nbsp; &nbsp; Use a strong random number generator to create a salt of 16 bytes or longer.<br>&nbsp; &nbsp; Feed the salt and the password into the PBKDF2 algorithm.<br>&nbsp; &nbsp; Use HMAC-SHA-256 as the core hash inside PBKDF2.<br>&nbsp; &nbsp; Perform 20,000 iterations or more. (June 2016.)<br>&nbsp; &nbsp; Take 32 bytes (256 bits) of output from PBKDF2 as the final password hash.<br>&nbsp; &nbsp; Store the iteration count, the salt and the final hash in your password database.<br>&nbsp; &nbsp; Increase your iteration count regularly to keep up with faster cracking tools.<br><br>Whatever you do, don’t try to knit your own password storage algorithm.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109002">  
  <a class="name">
  <strong class="user"><em>fluffy at beesbuzz dot biz</em></strong></a><div class="date" title="2012-06-11 11:33"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom109002">
<div class="phpcode"><code><span class="html">
The security issue with simple hashing (md5 et al) isn't really the speed, so much as the fact that it's idempotent; two different people with the same password will have the same hash, and so if one person's hash is brute-forced, the other one will as well.&nbsp; This facilitates rainbow attacks.&nbsp; Simply slowing the hash down isn't a very useful tactic for improving security.&nbsp; It doesn't matter how slow and cumbersome your hash algorithm is - as soon as someone has a weak password that's in a dictionary, EVERYONE with that weak password is vulnerable.<br><br>Also, hash algorithms such as md5 are for the purpose of generating a digest and checking if two things are probably the same as each other; they are not intended to be impossible to generate a collision for.&nbsp; Even if an underlying password itself requires a lot of brute forcing to determine, that doesn't mean it will be impossible to find some other bit pattern that generates the same hash in a trivial amount of time.<br><br>As such: please, please, PLEASE only use salted hashes for password storage.&nbsp; There is no reason to implement your own salted hash mechanism, either, as crypt() already does an excellent job of this.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/faq.passwords.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 01:57:28 GMT -->

</body></html>
<html><!-- Mirrored from www.php.net/manual/en/function.preg-replace.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 09:37:52 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>preg_replace</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.preg-replace.html">
 <link rel="shorturl" href="https://www.php.net/preg-replace">
 <link rel="alternate" href="https://www.php.net/preg-replace" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.pcre.html">
 <link rel="prev" href="function.preg-replace-callback.html">
 <link rel="next" href="function.preg-split.html">

 <link rel="alternate" href="function.preg-replace.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.preg-replace.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.preg-replace.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.preg-replace.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.preg-replace.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.preg-replace.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.preg-replace.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.preg-replace.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.preg-replace.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.preg-replace.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.text.html">Text Processing</a></li>      <li><a href="book.pcre.html">PCRE</a></li>      <li><a href="ref.pcre.html">PCRE Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.preg-replace" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">preg_replace</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">preg_replace</span> — <span class="dc-title">Perform a regular expression search and replace</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.preg-replace-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>preg_replace</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><span class="type">string</span>|<span class="type">array</span></span> <code class="parameter">$pattern</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><span class="type">string</span>|<span class="type">array</span></span> <code class="parameter">$replacement</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><span class="type">string</span>|<span class="type">array</span></span> <code class="parameter">$subject</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$limit</code><span class="initializer"> = -1</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter reference">&amp;$count</code><span class="initializer"> = <strong><code>null</code></strong></span></span><br>): <span class="type"><span class="type">string</span>|<span class="type">array</span>|<span class="type">null</span></span></div>

  <p class="para rdfs-comment">
   Searches <code class="parameter">subject</code> for matches to
   <code class="parameter">pattern</code> and replaces them with
   <code class="parameter">replacement</code>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.preg-replace-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    
     <dt>
<code class="parameter">pattern</code></dt>

     <dd>

      <p class="para">
       The pattern to search for. It can be either a string or an array with
       strings.
      </p>
      <p class="para">
       Several <a href="reference.pcre.pattern.modifiers.html" class="link">PCRE modifiers</a>
       are also available.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">replacement</code></dt>

     <dd>

      <p class="para">
       The string or an array with strings to replace. If this parameter is a
       string and the <code class="parameter">pattern</code> parameter is an array,
       all patterns will be replaced by that string. If both
       <code class="parameter">pattern</code> and <code class="parameter">replacement</code>
       parameters are arrays, each <code class="parameter">pattern</code> will be
       replaced by the <code class="parameter">replacement</code> counterpart. If
       there are fewer elements in the <code class="parameter">replacement</code>
       array than in the <code class="parameter">pattern</code> array, any extra
       <code class="parameter">pattern</code>s will be replaced by an empty string.
      </p>
      <p class="para">
       <code class="parameter">replacement</code> may contain references of the form
       <code class="literal">\<span class="replaceable">n</span></code> or
       <code class="literal">$<span class="replaceable">n</span></code>, with the latter form
       being the preferred one. Every such reference will be replaced by the text
       captured by the <span class="replaceable">n</span>'th parenthesized pattern.
       <span class="replaceable">n</span> can be from 0 to 99, and
       <code class="literal">\0</code> or <code class="literal">$0</code> refers to the text matched
       by the whole pattern. Opening parentheses are counted from left to right
       (starting from 1) to obtain the number of the capturing subpattern.
       Note that backslashes in <span class="type">string</span> literals may require to be escaped.
      </p>
      <p class="para">
       When working with a replacement pattern where a backreference is 
       immediately followed by another number (i.e.: placing a literal number
       immediately after a matched pattern), you cannot use the familiar 
       <code class="literal">\1</code> notation for your backreference.  
       <code class="literal">\11</code>, for example, would confuse
       <span class="function"><strong>preg_replace()</strong></span> since it does not know whether you
       want the <code class="literal">\1</code> backreference followed by a literal 
       <code class="literal">1</code>, or the <code class="literal">\11</code> backreference
       followed by nothing.  In this case the solution is to use 
       <code class="literal">${1}1</code>.  This creates an isolated
       <code class="literal">$1</code> backreference, leaving the <code class="literal">1</code>
       as a literal.
      </p>
      <p class="para">
       When using the deprecated <code class="literal">e</code> modifier, this function escapes
       some characters (namely <code class="literal">'</code>, <code class="literal">"</code>,
       <code class="literal">\</code> and NULL) in the strings that replace the
       backreferences. This is done to ensure that no syntax errors arise
       from backreference usage with either single or double quotes (e.g.
       <code class="literal">'strlen(\'$1\')+strlen("$2")'</code>). Make sure you are
       aware of PHP's <a href="language.types.string.html" class="link">string
       syntax</a> to know exactly how the interpreted string will look.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">subject</code></dt>

     <dd>

      <p class="para">
       The string or an array with strings to search and replace.
      </p>
      <p class="para">
       If <code class="parameter">subject</code> is an array, then the search and
       replace is performed on every entry of <code class="parameter">subject</code>,
       and the return value is an array as well.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">limit</code></dt>

     <dd>

      <p class="para">
       The maximum possible replacements for each pattern in each
       <code class="parameter">subject</code> string. Defaults to
       <code class="literal">-1</code> (no limit).
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">count</code></dt>

     <dd>

      <p class="para">
       If specified, this variable will be filled with the number of
       replacements done.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.preg-replace-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   <span class="function"><strong>preg_replace()</strong></span> returns an array if the
   <code class="parameter">subject</code> parameter is an array, or a string
   otherwise.
  </p>
  <p class="para">
   If matches are found, the new <code class="parameter">subject</code> will
   be returned, otherwise <code class="parameter">subject</code> will be
   returned unchanged or <strong><code>null</code></strong> if an error occurred.
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-function.preg-replace-errors">
  <h3 class="title">Errors/Exceptions</h3>
  <p class="para">
   Using the "\e" modifier is an error;
   an <strong><code>E_WARNING</code></strong> is emitted in this case.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.preg-replace-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-4716">
    <p><strong>Example #1 Using backreferences followed by numeric literals</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'April&nbsp;15,&nbsp;2003'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$pattern&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'/(\w+)&nbsp;(\d+),&nbsp;(\d+)/i'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$replacement&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'${1}1,$3'</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$pattern</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replacement</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>April1,2003
</pre></div>
    </div>
   </div>
  <p></p>
  <p class="para">
   </p><div class="example" id="example-4717">
    <p><strong>Example #2 Using indexed arrays with <span class="function"><strong>preg_replace()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'The&nbsp;quick&nbsp;brown&nbsp;fox&nbsp;jumps&nbsp;over&nbsp;the&nbsp;lazy&nbsp;dog.'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$patterns&nbsp;</span><span style="color: #007700">=&nbsp;array();<br></span><span style="color: #0000BB">$patterns</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'/quick/'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$patterns</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'/brown/'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$patterns</span><span style="color: #007700">[</span><span style="color: #0000BB">2</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'/fox/'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$replacements&nbsp;</span><span style="color: #007700">=&nbsp;array();<br></span><span style="color: #0000BB">$replacements</span><span style="color: #007700">[</span><span style="color: #0000BB">2</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'bear'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$replacements</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'black'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$replacements</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'slow'</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$patterns</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replacements</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>The bear black slow jumps over the lazy dog.
</pre></div>
    </div>
    <div class="example-contents"><p>
     By ksorting patterns and replacements, we should get what we wanted.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>ksort</span><span style="color: #007700">(</span><span style="color: #0000BB">$patterns</span><span style="color: #007700">);<br></span><span style="color: #0000BB">ksort</span><span style="color: #007700">(</span><span style="color: #0000BB">$replacements</span><span style="color: #007700">);<br>echo&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$patterns</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replacements</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>The slow black bear jumps over the lazy dog.
</pre></div>
    </div>
   </div>
  <p></p>
  <p class="para">
   </p><div class="example" id="example-4718">
    <p><strong>Example #3 Replacing several values</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$patterns&nbsp;</span><span style="color: #007700">=&nbsp;array&nbsp;(</span><span style="color: #DD0000">'/(19|20)(\d{2})-(\d{1,2})-(\d{1,2})/'</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'/^\s*{(\w+)}\s*=/'</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$replace&nbsp;</span><span style="color: #007700">=&nbsp;array&nbsp;(</span><span style="color: #DD0000">'\3/\4/\1\2'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'$\1&nbsp;='</span><span style="color: #007700">);<br>echo&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$patterns</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replace</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'{startDate}&nbsp;=&nbsp;1999-5-27'</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>$startDate = 5/27/1999
</pre></div>
    </div>
   </div>
  <p></p>
  <p class="para">
   </p><div class="example" id="example-4719">
    <p><strong>Example #4 Strip whitespace</strong></p>
    <div class="example-contents"><p>
     This example strips excess whitespace from a string.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'foo&nbsp;&nbsp;&nbsp;o'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'/\s\s+/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$str</span><span style="color: #007700">);<br></span><span style="color: #FF8000">//&nbsp;This&nbsp;will&nbsp;be&nbsp;'foo&nbsp;o'&nbsp;now<br></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$str</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
  <p class="para">
   </p><div class="example" id="example-4720">
    <p><strong>Example #5 Using the <code class="parameter">count</code> parameter</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$count&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br><br>echo&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'/\d/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'/\s/'</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">'*'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'xp&nbsp;4&nbsp;to'</span><span style="color: #007700">,&nbsp;-</span><span style="color: #0000BB">1&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$count</span><span style="color: #007700">);<br>echo&nbsp;</span><span style="color: #0000BB">$count</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//3<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>xp***to
3
</pre></div>
    </div>
   </div>
  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.preg-replace-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    When using arrays with <code class="parameter">pattern</code> and
    <code class="parameter">replacement</code>, the keys are processed in the order
    they appear in the array. This is <em class="emphasis">not necessarily</em> the
    same as the numerical index order. If you use indexes to identify which
    <code class="parameter">pattern</code> should be replaced by which
    <code class="parameter">replacement</code>, you should perform a
    <span class="function"><a href="function.ksort.html" class="function">ksort()</a></span> on each array prior to calling
    <span class="function"><strong>preg_replace()</strong></span>.
   </p>
  <p></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.preg-replace-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><a href="pcre.pattern.html" class="link">PCRE Patterns</a></li>
    <li class="member"><span class="function"><a href="function.preg-quote.html" class="function" rel="rdfs-seeAlso">preg_quote()</a> - Quote regular expression characters</span></li>
    <li class="member"><span class="function"><a href="function.preg-filter.html" class="function" rel="rdfs-seeAlso">preg_filter()</a> - Perform a regular expression search and replace</span></li>
    <li class="member"><span class="function"><a href="function.preg-match.html" class="function" rel="rdfs-seeAlso">preg_match()</a> - Perform a regular expression match</span></li>
    <li class="member"><span class="function"><a href="function.preg-replace-callback.html" class="function" rel="rdfs-seeAlso">preg_replace_callback()</a> - Perform a regular expression search and replace using a callback</span></li>
    <li class="member"><span class="function"><a href="function.preg-split.html" class="function" rel="rdfs-seeAlso">preg_split()</a> - Split string by a regular expression</span></li>
    <li class="member"><span class="function"><a href="function.preg-last-error.html" class="function" rel="rdfs-seeAlso">preg_last_error()</a> - Returns the error code of the last PCRE regex execution</span></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="89364">  
  <a class="name">
  <strong class="user"><em>arkani at iol dot pt</em></strong></a><div class="date" title="2009-03-04 11:00"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom89364">
<div class="phpcode"><code><span class="html">
Because i search a lot 4 this:<br><br>The following should be escaped if you are trying to match that character<br><br>\ ^ . $ | ( ) [ ]<br>* + ? { } ,<br><br>Special Character Definitions<br>\ Quote the next metacharacter<br>^ Match the beginning of the line<br>. Match any character (except newline)<br>$ Match the end of the line (or before newline at the end)<br>| Alternation<br>() Grouping<br>[] Character class<br>* Match 0 or more times<br>+ Match 1 or more times<br>? Match 1 or 0 times<br>{n} Match exactly n times<br>{n,} Match at least n times<br>{n,m} Match at least n but not more than m times<br>More Special Character Stuff<br>\t tab (HT, TAB)<br>\n newline (LF, NL)<br>\r return (CR)<br>\f form feed (FF)<br>\a alarm (bell) (BEL)<br>\e escape (think troff) (ESC)<br>\033 octal char (think of a PDP-11)<br>\x1B hex char<br>\c[ control char<br>\l lowercase next char (think vi)<br>\u uppercase next char (think vi)<br>\L lowercase till \E (think vi)<br>\U uppercase till \E (think vi)<br>\E end case modification (think vi)<br>\Q quote (disable) pattern metacharacters till \E<br>Even More Special Characters<br>\w Match a "word" character (alphanumeric plus "_")<br>\W Match a non-word character<br>\s Match a whitespace character<br>\S Match a non-whitespace character<br>\d Match a digit character<br>\D Match a non-digit character<br>\b Match a word boundary<br>\B Match a non-(word boundary)<br>\A Match only at beginning of string<br>\Z Match only at end of string, or before newline at the end<br>\z Match only at end of string<br>\G Match only where previous m//g left off (works only with /g)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96586">  
  <a class="name">
  <strong class="user"><em>hello at weblap dot ro</em></strong></a><div class="date" title="2010-03-06 04:10"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom96586">
<div class="phpcode"><code><span class="html">
Post slug generator, for creating clean urls from titles.
<br>It works with many languages.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">remove_accent</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)
<br>{
<br>&nbsp; </span><span class="default">$a </span><span class="keyword">= array(</span><span class="string">'À'</span><span class="keyword">, </span><span class="string">'Á'</span><span class="keyword">, </span><span class="string">'Â'</span><span class="keyword">, </span><span class="string">'Ã'</span><span class="keyword">, </span><span class="string">'Ä'</span><span class="keyword">, </span><span class="string">'Å'</span><span class="keyword">, </span><span class="string">'Æ'</span><span class="keyword">, </span><span class="string">'Ç'</span><span class="keyword">, </span><span class="string">'È'</span><span class="keyword">, </span><span class="string">'É'</span><span class="keyword">, </span><span class="string">'Ê'</span><span class="keyword">, </span><span class="string">'Ë'</span><span class="keyword">, </span><span class="string">'Ì'</span><span class="keyword">, </span><span class="string">'Í'</span><span class="keyword">, </span><span class="string">'Î'</span><span class="keyword">, </span><span class="string">'Ï'</span><span class="keyword">, </span><span class="string">'Ð'</span><span class="keyword">, </span><span class="string">'Ñ'</span><span class="keyword">, </span><span class="string">'Ò'</span><span class="keyword">, </span><span class="string">'Ó'</span><span class="keyword">, </span><span class="string">'Ô'</span><span class="keyword">, </span><span class="string">'Õ'</span><span class="keyword">, </span><span class="string">'Ö'</span><span class="keyword">, </span><span class="string">'Ø'</span><span class="keyword">, </span><span class="string">'Ù'</span><span class="keyword">, </span><span class="string">'Ú'</span><span class="keyword">, </span><span class="string">'Û'</span><span class="keyword">, </span><span class="string">'Ü'</span><span class="keyword">, </span><span class="string">'Ý'</span><span class="keyword">, </span><span class="string">'ß'</span><span class="keyword">, </span><span class="string">'à'</span><span class="keyword">, </span><span class="string">'á'</span><span class="keyword">, </span><span class="string">'â'</span><span class="keyword">, </span><span class="string">'ã'</span><span class="keyword">, </span><span class="string">'ä'</span><span class="keyword">, </span><span class="string">'å'</span><span class="keyword">, </span><span class="string">'æ'</span><span class="keyword">, </span><span class="string">'ç'</span><span class="keyword">, </span><span class="string">'è'</span><span class="keyword">, </span><span class="string">'é'</span><span class="keyword">, </span><span class="string">'ê'</span><span class="keyword">, </span><span class="string">'ë'</span><span class="keyword">, </span><span class="string">'ì'</span><span class="keyword">, </span><span class="string">'í'</span><span class="keyword">, </span><span class="string">'î'</span><span class="keyword">, </span><span class="string">'ï'</span><span class="keyword">, </span><span class="string">'ñ'</span><span class="keyword">, </span><span class="string">'ò'</span><span class="keyword">, </span><span class="string">'ó'</span><span class="keyword">, </span><span class="string">'ô'</span><span class="keyword">, </span><span class="string">'õ'</span><span class="keyword">, </span><span class="string">'ö'</span><span class="keyword">, </span><span class="string">'ø'</span><span class="keyword">, </span><span class="string">'ù'</span><span class="keyword">, </span><span class="string">'ú'</span><span class="keyword">, </span><span class="string">'û'</span><span class="keyword">, </span><span class="string">'ü'</span><span class="keyword">, </span><span class="string">'ý'</span><span class="keyword">, </span><span class="string">'ÿ'</span><span class="keyword">, </span><span class="string">'Ā'</span><span class="keyword">, </span><span class="string">'ā'</span><span class="keyword">, </span><span class="string">'Ă'</span><span class="keyword">, </span><span class="string">'ă'</span><span class="keyword">, </span><span class="string">'Ą'</span><span class="keyword">, </span><span class="string">'ą'</span><span class="keyword">, </span><span class="string">'Ć'</span><span class="keyword">, </span><span class="string">'ć'</span><span class="keyword">, </span><span class="string">'Ĉ'</span><span class="keyword">, </span><span class="string">'ĉ'</span><span class="keyword">, </span><span class="string">'Ċ'</span><span class="keyword">, </span><span class="string">'ċ'</span><span class="keyword">, </span><span class="string">'Č'</span><span class="keyword">, </span><span class="string">'č'</span><span class="keyword">, </span><span class="string">'Ď'</span><span class="keyword">, </span><span class="string">'ď'</span><span class="keyword">, </span><span class="string">'Đ'</span><span class="keyword">, </span><span class="string">'đ'</span><span class="keyword">, </span><span class="string">'Ē'</span><span class="keyword">, </span><span class="string">'ē'</span><span class="keyword">, </span><span class="string">'Ĕ'</span><span class="keyword">, </span><span class="string">'ĕ'</span><span class="keyword">, </span><span class="string">'Ė'</span><span class="keyword">, </span><span class="string">'ė'</span><span class="keyword">, </span><span class="string">'Ę'</span><span class="keyword">, </span><span class="string">'ę'</span><span class="keyword">, </span><span class="string">'Ě'</span><span class="keyword">, </span><span class="string">'ě'</span><span class="keyword">, </span><span class="string">'Ĝ'</span><span class="keyword">, </span><span class="string">'ĝ'</span><span class="keyword">, </span><span class="string">'Ğ'</span><span class="keyword">, </span><span class="string">'ğ'</span><span class="keyword">, </span><span class="string">'Ġ'</span><span class="keyword">, </span><span class="string">'ġ'</span><span class="keyword">, </span><span class="string">'Ģ'</span><span class="keyword">, </span><span class="string">'ģ'</span><span class="keyword">, </span><span class="string">'Ĥ'</span><span class="keyword">, </span><span class="string">'ĥ'</span><span class="keyword">, </span><span class="string">'Ħ'</span><span class="keyword">, </span><span class="string">'ħ'</span><span class="keyword">, </span><span class="string">'Ĩ'</span><span class="keyword">, </span><span class="string">'ĩ'</span><span class="keyword">, </span><span class="string">'Ī'</span><span class="keyword">, </span><span class="string">'ī'</span><span class="keyword">, </span><span class="string">'Ĭ'</span><span class="keyword">, </span><span class="string">'ĭ'</span><span class="keyword">, </span><span class="string">'Į'</span><span class="keyword">, </span><span class="string">'į'</span><span class="keyword">, </span><span class="string">'İ'</span><span class="keyword">, </span><span class="string">'ı'</span><span class="keyword">, </span><span class="string">'Ĳ'</span><span class="keyword">, </span><span class="string">'ĳ'</span><span class="keyword">, </span><span class="string">'Ĵ'</span><span class="keyword">, </span><span class="string">'ĵ'</span><span class="keyword">, </span><span class="string">'Ķ'</span><span class="keyword">, </span><span class="string">'ķ'</span><span class="keyword">, </span><span class="string">'Ĺ'</span><span class="keyword">, </span><span class="string">'ĺ'</span><span class="keyword">, </span><span class="string">'Ļ'</span><span class="keyword">, </span><span class="string">'ļ'</span><span class="keyword">, </span><span class="string">'Ľ'</span><span class="keyword">, </span><span class="string">'ľ'</span><span class="keyword">, </span><span class="string">'Ŀ'</span><span class="keyword">, </span><span class="string">'ŀ'</span><span class="keyword">, </span><span class="string">'Ł'</span><span class="keyword">, </span><span class="string">'ł'</span><span class="keyword">, </span><span class="string">'Ń'</span><span class="keyword">, </span><span class="string">'ń'</span><span class="keyword">, </span><span class="string">'Ņ'</span><span class="keyword">, </span><span class="string">'ņ'</span><span class="keyword">, </span><span class="string">'Ň'</span><span class="keyword">, </span><span class="string">'ň'</span><span class="keyword">, </span><span class="string">'ŉ'</span><span class="keyword">, </span><span class="string">'Ō'</span><span class="keyword">, </span><span class="string">'ō'</span><span class="keyword">, </span><span class="string">'Ŏ'</span><span class="keyword">, </span><span class="string">'ŏ'</span><span class="keyword">, </span><span class="string">'Ő'</span><span class="keyword">, </span><span class="string">'ő'</span><span class="keyword">, </span><span class="string">'Œ'</span><span class="keyword">, </span><span class="string">'œ'</span><span class="keyword">, </span><span class="string">'Ŕ'</span><span class="keyword">, </span><span class="string">'ŕ'</span><span class="keyword">, </span><span class="string">'Ŗ'</span><span class="keyword">, </span><span class="string">'ŗ'</span><span class="keyword">, </span><span class="string">'Ř'</span><span class="keyword">, </span><span class="string">'ř'</span><span class="keyword">, </span><span class="string">'Ś'</span><span class="keyword">, </span><span class="string">'ś'</span><span class="keyword">, </span><span class="string">'Ŝ'</span><span class="keyword">, </span><span class="string">'ŝ'</span><span class="keyword">, </span><span class="string">'Ş'</span><span class="keyword">, </span><span class="string">'ş'</span><span class="keyword">, </span><span class="string">'Š'</span><span class="keyword">, </span><span class="string">'š'</span><span class="keyword">, </span><span class="string">'Ţ'</span><span class="keyword">, </span><span class="string">'ţ'</span><span class="keyword">, </span><span class="string">'Ť'</span><span class="keyword">, </span><span class="string">'ť'</span><span class="keyword">, </span><span class="string">'Ŧ'</span><span class="keyword">, </span><span class="string">'ŧ'</span><span class="keyword">, </span><span class="string">'Ũ'</span><span class="keyword">, </span><span class="string">'ũ'</span><span class="keyword">, </span><span class="string">'Ū'</span><span class="keyword">, </span><span class="string">'ū'</span><span class="keyword">, </span><span class="string">'Ŭ'</span><span class="keyword">, </span><span class="string">'ŭ'</span><span class="keyword">, </span><span class="string">'Ů'</span><span class="keyword">, </span><span class="string">'ů'</span><span class="keyword">, </span><span class="string">'Ű'</span><span class="keyword">, </span><span class="string">'ű'</span><span class="keyword">, </span><span class="string">'Ų'</span><span class="keyword">, </span><span class="string">'ų'</span><span class="keyword">, </span><span class="string">'Ŵ'</span><span class="keyword">, </span><span class="string">'ŵ'</span><span class="keyword">, </span><span class="string">'Ŷ'</span><span class="keyword">, </span><span class="string">'ŷ'</span><span class="keyword">, </span><span class="string">'Ÿ'</span><span class="keyword">, </span><span class="string">'Ź'</span><span class="keyword">, </span><span class="string">'ź'</span><span class="keyword">, </span><span class="string">'Ż'</span><span class="keyword">, </span><span class="string">'ż'</span><span class="keyword">, </span><span class="string">'Ž'</span><span class="keyword">, </span><span class="string">'ž'</span><span class="keyword">, </span><span class="string">'ſ'</span><span class="keyword">, </span><span class="string">'ƒ'</span><span class="keyword">, </span><span class="string">'Ơ'</span><span class="keyword">, </span><span class="string">'ơ'</span><span class="keyword">, </span><span class="string">'Ư'</span><span class="keyword">, </span><span class="string">'ư'</span><span class="keyword">, </span><span class="string">'Ǎ'</span><span class="keyword">, </span><span class="string">'ǎ'</span><span class="keyword">, </span><span class="string">'Ǐ'</span><span class="keyword">, </span><span class="string">'ǐ'</span><span class="keyword">, </span><span class="string">'Ǒ'</span><span class="keyword">, </span><span class="string">'ǒ'</span><span class="keyword">, </span><span class="string">'Ǔ'</span><span class="keyword">, </span><span class="string">'ǔ'</span><span class="keyword">, </span><span class="string">'Ǖ'</span><span class="keyword">, </span><span class="string">'ǖ'</span><span class="keyword">, </span><span class="string">'Ǘ'</span><span class="keyword">, </span><span class="string">'ǘ'</span><span class="keyword">, </span><span class="string">'Ǚ'</span><span class="keyword">, </span><span class="string">'ǚ'</span><span class="keyword">, </span><span class="string">'Ǜ'</span><span class="keyword">, </span><span class="string">'ǜ'</span><span class="keyword">, </span><span class="string">'Ǻ'</span><span class="keyword">, </span><span class="string">'ǻ'</span><span class="keyword">, </span><span class="string">'Ǽ'</span><span class="keyword">, </span><span class="string">'ǽ'</span><span class="keyword">, </span><span class="string">'Ǿ'</span><span class="keyword">, </span><span class="string">'ǿ'</span><span class="keyword">);
<br>&nbsp; </span><span class="default">$b </span><span class="keyword">= array(</span><span class="string">'A'</span><span class="keyword">, </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">'AE'</span><span class="keyword">, </span><span class="string">'C'</span><span class="keyword">, </span><span class="string">'E'</span><span class="keyword">, </span><span class="string">'E'</span><span class="keyword">, </span><span class="string">'E'</span><span class="keyword">, </span><span class="string">'E'</span><span class="keyword">, </span><span class="string">'I'</span><span class="keyword">, </span><span class="string">'I'</span><span class="keyword">, </span><span class="string">'I'</span><span class="keyword">, </span><span class="string">'I'</span><span class="keyword">, </span><span class="string">'D'</span><span class="keyword">, </span><span class="string">'N'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'Y'</span><span class="keyword">, </span><span class="string">'s'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'ae'</span><span class="keyword">, </span><span class="string">'c'</span><span class="keyword">, </span><span class="string">'e'</span><span class="keyword">, </span><span class="string">'e'</span><span class="keyword">, </span><span class="string">'e'</span><span class="keyword">, </span><span class="string">'e'</span><span class="keyword">, </span><span class="string">'i'</span><span class="keyword">, </span><span class="string">'i'</span><span class="keyword">, </span><span class="string">'i'</span><span class="keyword">, </span><span class="string">'i'</span><span class="keyword">, </span><span class="string">'n'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'y'</span><span class="keyword">, </span><span class="string">'y'</span><span class="keyword">, </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'C'</span><span class="keyword">, </span><span class="string">'c'</span><span class="keyword">, </span><span class="string">'C'</span><span class="keyword">, </span><span class="string">'c'</span><span class="keyword">, </span><span class="string">'C'</span><span class="keyword">, </span><span class="string">'c'</span><span class="keyword">, </span><span class="string">'C'</span><span class="keyword">, </span><span class="string">'c'</span><span class="keyword">, </span><span class="string">'D'</span><span class="keyword">, </span><span class="string">'d'</span><span class="keyword">, </span><span class="string">'D'</span><span class="keyword">, </span><span class="string">'d'</span><span class="keyword">, </span><span class="string">'E'</span><span class="keyword">, </span><span class="string">'e'</span><span class="keyword">, </span><span class="string">'E'</span><span class="keyword">, </span><span class="string">'e'</span><span class="keyword">, </span><span class="string">'E'</span><span class="keyword">, </span><span class="string">'e'</span><span class="keyword">, </span><span class="string">'E'</span><span class="keyword">, </span><span class="string">'e'</span><span class="keyword">, </span><span class="string">'E'</span><span class="keyword">, </span><span class="string">'e'</span><span class="keyword">, </span><span class="string">'G'</span><span class="keyword">, </span><span class="string">'g'</span><span class="keyword">, </span><span class="string">'G'</span><span class="keyword">, </span><span class="string">'g'</span><span class="keyword">, </span><span class="string">'G'</span><span class="keyword">, </span><span class="string">'g'</span><span class="keyword">, </span><span class="string">'G'</span><span class="keyword">, </span><span class="string">'g'</span><span class="keyword">, </span><span class="string">'H'</span><span class="keyword">, </span><span class="string">'h'</span><span class="keyword">, </span><span class="string">'H'</span><span class="keyword">, </span><span class="string">'h'</span><span class="keyword">, </span><span class="string">'I'</span><span class="keyword">, </span><span class="string">'i'</span><span class="keyword">, </span><span class="string">'I'</span><span class="keyword">, </span><span class="string">'i'</span><span class="keyword">, </span><span class="string">'I'</span><span class="keyword">, </span><span class="string">'i'</span><span class="keyword">, </span><span class="string">'I'</span><span class="keyword">, </span><span class="string">'i'</span><span class="keyword">, </span><span class="string">'I'</span><span class="keyword">, </span><span class="string">'i'</span><span class="keyword">, </span><span class="string">'IJ'</span><span class="keyword">, </span><span class="string">'ij'</span><span class="keyword">, </span><span class="string">'J'</span><span class="keyword">, </span><span class="string">'j'</span><span class="keyword">, </span><span class="string">'K'</span><span class="keyword">, </span><span class="string">'k'</span><span class="keyword">, </span><span class="string">'L'</span><span class="keyword">, </span><span class="string">'l'</span><span class="keyword">, </span><span class="string">'L'</span><span class="keyword">, </span><span class="string">'l'</span><span class="keyword">, </span><span class="string">'L'</span><span class="keyword">, </span><span class="string">'l'</span><span class="keyword">, </span><span class="string">'L'</span><span class="keyword">, </span><span class="string">'l'</span><span class="keyword">, </span><span class="string">'l'</span><span class="keyword">, </span><span class="string">'l'</span><span class="keyword">, </span><span class="string">'N'</span><span class="keyword">, </span><span class="string">'n'</span><span class="keyword">, </span><span class="string">'N'</span><span class="keyword">, </span><span class="string">'n'</span><span class="keyword">, </span><span class="string">'N'</span><span class="keyword">, </span><span class="string">'n'</span><span class="keyword">, </span><span class="string">'n'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">, </span><span class="string">'OE'</span><span class="keyword">, </span><span class="string">'oe'</span><span class="keyword">, </span><span class="string">'R'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">, </span><span class="string">'R'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">, </span><span class="string">'R'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">, </span><span class="string">'S'</span><span class="keyword">, </span><span class="string">'s'</span><span class="keyword">, </span><span class="string">'S'</span><span class="keyword">, </span><span class="string">'s'</span><span class="keyword">, </span><span class="string">'S'</span><span class="keyword">, </span><span class="string">'s'</span><span class="keyword">, </span><span class="string">'S'</span><span class="keyword">, </span><span class="string">'s'</span><span class="keyword">, </span><span class="string">'T'</span><span class="keyword">, </span><span class="string">'t'</span><span class="keyword">, </span><span class="string">'T'</span><span class="keyword">, </span><span class="string">'t'</span><span class="keyword">, </span><span class="string">'T'</span><span class="keyword">, </span><span class="string">'t'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'W'</span><span class="keyword">, </span><span class="string">'w'</span><span class="keyword">, </span><span class="string">'Y'</span><span class="keyword">, </span><span class="string">'y'</span><span class="keyword">, </span><span class="string">'Y'</span><span class="keyword">, </span><span class="string">'Z'</span><span class="keyword">, </span><span class="string">'z'</span><span class="keyword">, </span><span class="string">'Z'</span><span class="keyword">, </span><span class="string">'z'</span><span class="keyword">, </span><span class="string">'Z'</span><span class="keyword">, </span><span class="string">'z'</span><span class="keyword">, </span><span class="string">'s'</span><span class="keyword">, </span><span class="string">'f'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'I'</span><span class="keyword">, </span><span class="string">'i'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'U'</span><span class="keyword">, </span><span class="string">'u'</span><span class="keyword">, </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="string">'AE'</span><span class="keyword">, </span><span class="string">'ae'</span><span class="keyword">, </span><span class="string">'O'</span><span class="keyword">, </span><span class="string">'o'</span><span class="keyword">);
<br>&nbsp; return </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);
<br>}
<br>
<br>function </span><span class="default">post_slug</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)
<br>{
<br>&nbsp; return </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">preg_replace</span><span class="keyword">(array(</span><span class="string">'/[^a-zA-Z0-9 -]/'</span><span class="keyword">, </span><span class="string">'/[ -]+/'</span><span class="keyword">, </span><span class="string">'/^-|-$/'</span><span class="keyword">), 
<br>&nbsp; array(</span><span class="string">''</span><span class="keyword">, </span><span class="string">'-'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">), </span><span class="default">remove_accent</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)));
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>Example: post_slug(' -Lo#&amp;@rem&nbsp; IPSUM //dolor-/sit - amet-/-consectetur! 12 -- ')
<br>will output: lorem-ipsum-dolor-sit-amet-consectetur-12</span>
</code></div>
  </div>
 </div>
  <div class="note" id="106981">  
  <a class="name">
  <strong class="user"><em>denis_truffaut a t hotmail d o t com</em></strong></a><div class="date" title="2011-12-23 05:11"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom106981">
<div class="phpcode"><code><span class="html">
If you want to catch characters, as well european, russian, chinese, japanese, korean of whatever, just :<br>- use mb_internal_encoding('UTF-8');<br>- use preg_replace('`...`u', '...', $string) with the u (unicode) modifier<br><br>For further information, the complete list of preg_* modifiers could be found at :<br><a rel="nofollow" target="_blank">http://php.net/manual/en/reference.pcre.pattern.modifiers.php</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="73063">  
  <a class="name">
  <strong class="user"><em>dani dot church at gmail dot youshouldknowthisone</em></strong></a><div class="date" title="2007-02-07 11:09"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom73063">
<div class="phpcode"><code><span class="html">
Note that it is in most cases much more efficient to use preg_replace_callback(), with a named function or an anonymous function created with create_function(), instead of the /e modifier.&nbsp; When preg_replace() is called with the /e modifier, the interpreter must parse the replacement string into PHP code once for every replacement made, while preg_replace_callback() uses a function that only needs to be parsed once.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84703">  
  <a class="name">
  <strong class="user"><em>marcin at pixaltic dot com</em></strong></a><div class="date" title="2008-07-25 03:56"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom84703">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php
<br>&nbsp; &nbsp; </span><span class="comment">//:::replace with anything that you can do with searched string:::
<br>&nbsp; &nbsp; //Marcin Majchrzak
<br>&nbsp; &nbsp; //pixaltic.com
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="string">"2 4 8"</span><span class="keyword">;
<br>&nbsp; &nbsp; echo (</span><span class="default">$c</span><span class="keyword">); </span><span class="comment">//display:2 4 8
<br>
<br>&nbsp; &nbsp; </span><span class="default">$cp </span><span class="keyword">= </span><span class="string">"/(\d)\s(\d)\s(\d)/e"</span><span class="keyword">; </span><span class="comment">//pattern
<br>&nbsp; &nbsp; </span><span class="default">$cr </span><span class="keyword">= </span><span class="string">"'\\3*\\2+\\1='.(('\\3')*('\\2')+('\\1'))"</span><span class="keyword">; </span><span class="comment">//replece
<br>&nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="default">$cp</span><span class="keyword">, </span><span class="default">$cr</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">);
<br>&nbsp; &nbsp; echo (</span><span class="default">$c</span><span class="keyword">); </span><span class="comment">//display:8*4+2=34
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="124934">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2020-04-22 02:02"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom124934">
<div class="phpcode"><code><span class="html">
Warning: craiga's function escape_backreference() is incomplete (doesn't escape '\0' nor '${0}').<br><br>To escape any potential backreferences in a replacement variable, use addcslashes() for backslash and dollar characters:<br><br><span class="default">&lt;?php<br></span><span class="comment">// $replacement may contain sequences like \0, $0 or ${0}<br></span><span class="keyword">echo </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">addcslashes</span><span class="keyword">(</span><span class="default">$replacement</span><span class="keyword">, </span><span class="string">'\\$'</span><span class="keyword">), </span><span class="default">$subject</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112400">  
  <a class="name">
  <strong class="user"><em>spamthishard at wtriple dot com</em></strong></a><div class="date" title="2013-06-12 08:02"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom112400">
<div class="phpcode"><code><span class="html">
If you want to replace only the n-th occurrence of $pattern, you can use this function:<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">preg_replace_nth</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$replacement</span><span class="keyword">, </span><span class="default">$subject</span><span class="keyword">, </span><span class="default">$nth</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">) {<br>&nbsp; &nbsp; return </span><span class="default">preg_replace_callback</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; function(</span><span class="default">$found</span><span class="keyword">) use (&amp;</span><span class="default">$pattern</span><span class="keyword">, &amp;</span><span class="default">$replacement</span><span class="keyword">, &amp;</span><span class="default">$nth</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$nth</span><span class="keyword">--;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$nth</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">) return </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$replacement</span><span class="keyword">, </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$found</span><span class="keyword">) );<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$found</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; }, </span><span class="default">$subject</span><span class="keyword">,</span><span class="default">$nth&nbsp; </span><span class="keyword">);<br>}<br><br>echo </span><span class="default">preg_replace_nth</span><span class="keyword">(</span><span class="string">"/(\w+)\|/"</span><span class="keyword">, </span><span class="string">'${1} is the 4th|'</span><span class="keyword">, </span><span class="string">"|aa|b|cc|dd|e|ff|gg|kkk|"</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>this outputs |aa|b|cc|dd is the 4th|e|ff|gg|kkk| <br>backreferences are accepted in $replacement</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77255">  
  <a class="name">
  <strong class="user"><em>rob at ubrio dot us</em></strong></a><div class="date" title="2007-08-21 01:48"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom77255">
<div class="phpcode"><code><span class="html">
Also worth noting is that you can use array_keys()/array_values() with preg_replace like:
<br>
<br><span class="default">&lt;?php
<br>$subs </span><span class="keyword">= array(
<br>&nbsp; </span><span class="string">'/\[b\](.+)\[\/b\]/Ui' </span><span class="keyword">=&gt; </span><span class="string">'&lt;strong&gt;$1&lt;/strong&gt;'</span><span class="keyword">,
<br>&nbsp; </span><span class="string">'/_(.+)_/Ui' </span><span class="keyword">=&gt; </span><span class="string">'&lt;em&gt;$1&lt;/em&gt;'
<br>&nbsp; </span><span class="keyword">...
<br>&nbsp; ...
<br>);
<br>
<br></span><span class="default">$raw_text </span><span class="keyword">= </span><span class="string">'[b]this is bold[/b] and this is _italic!_'</span><span class="keyword">;
<br>
<br></span><span class="default">$bb_text </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$subs</span><span class="keyword">), </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$subs</span><span class="keyword">), </span><span class="default">$raw_text</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84285">  
  <a class="name">
  <strong class="user"><em>akniep at rayo dot info</em></strong></a><div class="date" title="2008-07-07 03:22"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom84285">
<div class="phpcode"><code><span class="html">
preg_replace (and other preg-functions) return null instead of a string when encountering problems you probably did not think about!<br>-------------------------<br><br>It may not be obvious to everybody that the function returns NULL if an error of any kind occurres. An error I happen to stumple about quite often was the back-tracking-limit:<br><a rel="nofollow" target="_blank">http://de.php.net/manual/de/pcre.configuration.php</a><br>#ini.pcre.backtrack-limit<br><br>When working with HTML-documents and their parsing it happens that you encounter documents that have a length of over 100.000 characters and that may lead to certain regular-expressions to fail due the back-tracking-limit of above.<br><br>A regular-expression that is ungreedy ("U", <a rel="nofollow" target="_blank">http://de.php.net/manual/de/reference.pcre.pattern.modifiers.php</a>) often does the job, but still: sometimes you just need a greedy regular expression working on long strings ...<br><br>Since, an unhandled return-value of NULL usually creates a consecutive error in the application with unwanted and unforeseen consequences, I found the following solution to be quite helpful and at least save the application from crashing:<br><br><span class="default">&lt;?php<br><br>$string_after </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">( </span><span class="string">'/some_regexp/'</span><span class="keyword">, </span><span class="string">"replacement"</span><span class="keyword">, </span><span class="default">$string_before </span><span class="keyword">);<br><br></span><span class="comment">// if some error occurred we go on working with the unchanged original string<br></span><span class="keyword">if (</span><span class="default">PREG_NO_ERROR </span><span class="keyword">!== </span><span class="default">preg_last_error</span><span class="keyword">())<br>{<br>&nbsp; &nbsp; </span><span class="default">$string_after </span><span class="keyword">= </span><span class="default">$string_before</span><span class="keyword">;<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">// put email-sending or a log-message here<br></span><span class="keyword">} </span><span class="comment">//if<br><br>// free memory<br></span><span class="keyword">unset( </span><span class="default">$string_before </span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>You may or should also put a log-message or the sending of an email into the if-condition in order to get informed, once, one of your regular-expressions does not have the effect you desired it to have.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="116986">  
  <a class="name">
  <strong class="user"><em>Garrett Albright</em></strong></a><div class="date" title="2015-03-30 08:14"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom116986">
<div class="phpcode"><code><span class="html">
It may be useful to note that if you pass an associative array as the $replacement parameter, the keys are preserved.<br><br><span class="default">&lt;?php<br>$replaced </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/foo/'</span><span class="keyword">, </span><span class="string">'bar'</span><span class="keyword">, [</span><span class="string">'first' </span><span class="keyword">=&gt; </span><span class="string">'foobar'</span><span class="keyword">, </span><span class="string">'second' </span><span class="keyword">=&gt; </span><span class="string">'barfoo'</span><span class="keyword">]);<br></span><span class="comment">// $replaced is now ['first' =&gt; 'barbar', 'second' =&gt; 'barbar'].<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101938">  
  <a class="name">
  <strong class="user"><em>nospam at probackup dot nl</em></strong></a><div class="date" title="2011-01-19 05:03"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom101938">
<div class="phpcode"><code><span class="html">
Warning: a common made mistake in trying to remove all characters except numbers and letters from a string, is to use code with a regex similar to preg_replace('[^A-Za-z0-9_]', '', ...). The output goes in an unexpected direction in case your input contains two double quotes.<br><br>echo preg_replace('[^A-Za-z0-9_]', '', 'D"usseldorfer H"auptstrasse')<br><br>D"usseldorfer H"auptstrasse<br><br>It is important to not forget a leading an trailing forward slash in the regex: <br><br>echo preg_replace('/[^A-Za-z0-9_]/', '', 'D"usseldorfer H"auptstrasse')<br><br>Dusseldorfer Hauptstrasse<br><br>PS An alternative is to use preg_replace('/\W/', '', $t) for keeping all alpha numeric characters including underscores.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="69478">  
  <a class="name">
  <strong class="user"><em>Alexey Lebedev</em></strong></a><div class="date" title="2006-09-07 02:21"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom69478">
<div class="phpcode"><code><span class="html">
Wasted several hours because of this:
<br>
<br><span class="default">&lt;?php
<br>$str</span><span class="keyword">=</span><span class="string">'It&amp;#039;s a string with HTML entities'</span><span class="keyword">;
<br></span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'~&amp;#(\d+);~e'</span><span class="keyword">, </span><span class="string">'code2utf($1)'</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>This code must convert numeric html entities to utf8. And it does with a little exception. It treats wrong codes starting with &amp;#0
<br>
<br>The reason is that code2utf will be called with leading zero, exactly what the pattern matches - code2utf(039).
<br>And it does matter! PHP treats 039 as octal number.
<br>Try <span class="default">&lt;?php </span><span class="keyword">print(</span><span class="default">011</span><span class="keyword">); </span><span class="default">?&gt;
<br></span>
<br>Solution:
<br><span class="default">&lt;?php preg_replace</span><span class="keyword">(</span><span class="string">'~&amp;#0*(\d+);~e'</span><span class="keyword">, </span><span class="string">'code2utf($1)'</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">); </span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="110511">  
  <a class="name">
  <strong class="user"><em>cincodenada at gmail dot dot dot com</em></strong></a><div class="date" title="2012-10-30 10:43"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom110511">
<div class="phpcode"><code><span class="html">
There seems to be some confusion over how greediness works.&nbsp; For those familiar with Regular Expressions in other languages, particularly Perl: it works like you would expect, and as documented.&nbsp; Greedy by default, un-greedy if you follow a quantifier with a question mark.<br><br>There is a PHP/PCRE-specific U pattern modifier that flips the greediness, so that quantifiers are by default un-greedy, and become greedy if you follow the quantifier with a question mark: <a rel="nofollow" target="_blank">http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php</a><br><br>To make things clear, a series of examples:<br><br><span class="default">&lt;?php<br><br>$preview </span><span class="keyword">= </span><span class="string">"a bunch of stuff &lt;code&gt;this that&lt;/code&gt; and more stuff &lt;code&gt;with a second code block&lt;/code&gt; then extra at the end"</span><span class="keyword">; <br><br></span><span class="default">$preview_default </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/&lt;code&gt;(.*)&lt;\/code&gt;/is'</span><span class="keyword">, </span><span class="string">"&lt;code class=\"prettyprint\"&gt;$1&lt;/code&gt;"</span><span class="keyword">, </span><span class="default">$preview</span><span class="keyword">);<br></span><span class="default">$preview_manually_ungreedy </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/&lt;code&gt;(.*?)&lt;\/code&gt;/is'</span><span class="keyword">, </span><span class="string">"&lt;code class=\"prettyprint\"&gt;$1&lt;/code&gt;"</span><span class="keyword">, </span><span class="default">$preview</span><span class="keyword">);<br><br></span><span class="default">$preview_U_default </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/&lt;code&gt;(.*)&lt;\/code&gt;/isU'</span><span class="keyword">, </span><span class="string">"&lt;code class=\"prettyprint\"&gt;$1&lt;/code&gt;"</span><span class="keyword">, </span><span class="default">$preview</span><span class="keyword">);<br></span><span class="default">$preview_U_manually_greedy </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/&lt;code&gt;(.*?)&lt;\/code&gt;/isU'</span><span class="keyword">, </span><span class="string">"&lt;code class=\"prettyprint\"&gt;$1&lt;/code&gt;"</span><span class="keyword">, </span><span class="default">$preview</span><span class="keyword">);<br><br>echo </span><span class="string">"Default, no ?: </span><span class="default">$preview_default</span><span class="string">\n"</span><span class="keyword">;<br>echo </span><span class="string">"Default, with ?: </span><span class="default">$preview_manually_ungreedy</span><span class="string">\n"</span><span class="keyword">;<br>echo </span><span class="string">"U flag, no ?: </span><span class="default">$preview_U_default</span><span class="string">\n"</span><span class="keyword">;<br>echo </span><span class="string">"U flag, with ?: </span><span class="default">$preview_U_manually_greedy</span><span class="string">\n"</span><span class="keyword">;<br><br></span><span class="default">?&gt;<br></span><br>Results in this:<br><br>Default, no ?: a bunch of stuff &lt;code class="prettyprint"&gt;this that&lt;/code&gt; and more stuff &lt;code&gt;with a second code block&lt;/code&gt; then extra at the end<br>Default, with ?: a bunch of stuff &lt;code class="prettyprint"&gt;this that&lt;/code&gt; and more stuff &lt;code class="prettyprint"&gt;with a second code block&lt;/code&gt; then extra at the end<br>U flag, no ?: a bunch of stuff &lt;code class="prettyprint"&gt;this that&lt;/code&gt; and more stuff &lt;code class="prettyprint"&gt;with a second code block&lt;/code&gt; then extra at the end<br>U flag, with ?: a bunch of stuff &lt;code class="prettyprint"&gt;this that&lt;/code&gt; and more stuff &lt;code&gt;with a second code block&lt;/code&gt; then extra at the end<br><br>As expected: greedy by default, ? inverts it to ungreedy.&nbsp; With the U flag, un-greedy by default, ? makes it greedy.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="117122">  
  <a class="name">
  <strong class="user"><em>logofero at gmail dot com</em></strong></a><div class="date" title="2015-04-17 04:13"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom117122">
<div class="phpcode"><code><span class="html">
Why not offset parameter to replace the string? It would be helpful<br><br>example:<br><br>mixed preg_replace (mixed $pattern, mixed $replacement, mixed $subject [, int $limit = -1 [, int &amp; $count [, int $offset = 0]]]) <br><br>1 $pattern<br>2 $replacement <br>3 $subject<br>4 $limit<br>5 $count <br>6 $offset &lt;- it is planned?</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101236">  
  <a class="name">
  <strong class="user"><em>Terminux (dot) anonymous at gmail</em></strong></a><div class="date" title="2010-12-03 09:58"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom101236">
<div class="phpcode"><code><span class="html">
This function will strip all the HTML-like content in a string.<br>I know you can find a lot of similar content on the web, but this one is simple, fast and robust. Don't simply use the built-in functions like strip_tags(), they dont work so good.<br><br>Careful however, this is not a correct validation of a string ; you should use additional functions like mysql_real_escape_string and filter_var, as well as custom tests before putting a submission into your database.<br><br><span class="default">&lt;?php <br><br>$html </span><span class="keyword">= &lt;&lt;&lt;END<br></span><span class="string">&lt;div id="function.preg-split" class="refentry"&gt; Bonjour1 \t<br>&lt;div class="refnamediv"&gt; Bonjour2 \t<br>&lt;h1 class="refname"&gt;Bonjour3 \t&lt;/h1&gt;<br>&lt;h1 class="""&gt;Bonjour4 \t&lt;/h1&gt;<br>&lt;h1 class="*%1"&gt;Bonjour5 \t&lt;/h1&gt;<br>&lt;body&gt;Bonjour6 \t&lt;//body&gt;&gt;<br>&lt;/ body&gt;Bonjour7 \t&lt;////&nbsp; &nbsp; &nbsp; &nbsp; body&gt;&gt;<br>&lt;<br>a href="image.php" alt="trans" /&nbsp; &nbsp; &nbsp; &nbsp; &gt;<br>some leftover text...<br>&nbsp; &nbsp;&nbsp; &lt; DIV class=noCompliant style = "text-align:left;" &gt;<br>... and some other ...<br>&lt; dIv &gt; &lt; empty&gt;&nbsp; &lt;/ empty&gt;<br>&nbsp; &lt;p&gt; This is yet another text &lt;br&nbsp; &gt;<br>&nbsp; &nbsp;&nbsp; that wasn't &lt;b&gt;compliant&lt;/b&gt; too... &lt;br&nbsp;&nbsp; /&gt;<br>&nbsp; &nbsp;&nbsp; &lt;/p&gt;<br> &lt;div class="noClass" &gt; this one is better but we don't care anyway &lt;/div &gt;&lt;P&gt;<br>&nbsp; &nbsp; &lt;input&nbsp;&nbsp; type= "text"&nbsp; name ='my "name' value&nbsp; = "nothin really." readonly&gt;<br>end of paragraph &lt;/p&gt; &lt;/Div&gt;&nbsp;&nbsp; &lt;/div&gt;&nbsp;&nbsp; some trailing text <br></span><span class="keyword">END;<br><br></span><span class="comment">// This echoes correctly all the text that is not inside HTML tags<br></span><span class="default">$html_reg </span><span class="keyword">= </span><span class="string">'/&lt;+\s*\/*\s*([A-Z][A-Z0-9]*)\b[^&gt;]*\/*\s*&gt;+/i'</span><span class="keyword">;<br>echo </span><span class="default">htmlentities</span><span class="keyword">( </span><span class="default">preg_replace</span><span class="keyword">( </span><span class="default">$html_reg</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$html </span><span class="keyword">) );<br><br></span><span class="comment">// This extracts only a small portion of the text<br></span><span class="keyword">echo </span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">strip_tags</span><span class="keyword">(</span><span class="default">$html</span><span class="keyword">));<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="79678">  
  <a class="name">
  <strong class="user"><em>ulf dot reimers at tesa dot com</em></strong></a><div class="date" title="2007-12-07 10:28"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom79678">
<div class="phpcode"><code><span class="html">
Hi,<br><br>as I wasn't able to find another way to do this, I wrote a function converting any UTF-8 string into a correct NTFS filename (see <a rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Filename</a>).<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">strToNTFSFilename</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)<br>{<br>&nbsp; </span><span class="default">$reserved </span><span class="keyword">= </span><span class="default">preg_quote</span><span class="keyword">(</span><span class="string">'\/:*?"&lt;&gt;'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">);<br>&nbsp; return </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/([\\x00-\\x1f</span><span class="keyword">{</span><span class="default">$forbidden</span><span class="keyword">}</span><span class="string">])/e"</span><span class="keyword">, </span><span class="string">"_"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;<br></span><br>It converts all control characters and filename characters which are reserved by Windows ('\/:*?"&lt;&gt;') into an underscore.<br>This way you can safely create an NTFS filename out of any UTF-8 string.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87300">  
  <a class="name">
  <strong class="user"><em>mdrisser at gmail dot com</em></strong></a><div class="date" title="2008-11-28 10:13"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom87300">
<div class="phpcode"><code><span class="html">
An alternative to the method suggested by sheri is to remember that the regex modifier '$' only looks at the end of the STRING, the example given is a single string consisting of multiple lines.<br><br>Try:<br><span class="default">&lt;?php<br></span><span class="comment">// Following is 1 string containing 3 lines<br></span><span class="default">$s </span><span class="keyword">= </span><span class="string">"Testing, testing.\r\n"<br>&nbsp;&nbsp; </span><span class="keyword">. </span><span class="string">"Another testing line.\r\n"<br>&nbsp;&nbsp; </span><span class="keyword">. </span><span class="string">"Testing almost done."</span><span class="keyword">;<br><br>echo </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\.\\r\\n/m'</span><span class="keyword">, </span><span class="string">'@\r\n'</span><span class="keyword">, </span><span class="default">$s</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>This results in the string:<br>Testing, testing@\r\nAnother testing line@\r\nTesting almost done.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107112">  
  <a class="name">
  <strong class="user"><em>hvishnu999 at gmail dot com</em></strong></a><div class="date" title="2012-01-08 06:25"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom107112">
<div class="phpcode"><code><span class="html">
To covert a string to SEO friendly, do this:
<br>
<br><span class="default">&lt;?php
<br>$realname </span><span class="keyword">= </span><span class="string">"This is the string to be made SEO friendly!"
<br>
<br></span><span class="default">$seoname </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\%/'</span><span class="keyword">,</span><span class="string">' percentage'</span><span class="keyword">,</span><span class="default">$realname</span><span class="keyword">);
<br></span><span class="default">$seoname </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\@/'</span><span class="keyword">,</span><span class="string">' at '</span><span class="keyword">,</span><span class="default">$seoname</span><span class="keyword">);
<br></span><span class="default">$seoname </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\&amp;/'</span><span class="keyword">,</span><span class="string">' and '</span><span class="keyword">,</span><span class="default">$seoname</span><span class="keyword">);
<br></span><span class="default">$seoname </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\s[\s]+/'</span><span class="keyword">,</span><span class="string">'-'</span><span class="keyword">,</span><span class="default">$seoname</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// Strip off multiple spaces
<br></span><span class="default">$seoname </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/[\s\W]+/'</span><span class="keyword">,</span><span class="string">'-'</span><span class="keyword">,</span><span class="default">$seoname</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// Strip off spaces and non-alpha-numeric
<br></span><span class="default">$seoname </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/^[\-]+/'</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$seoname</span><span class="keyword">); </span><span class="comment">// Strip off the starting hyphens
<br></span><span class="default">$seoname </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/[\-]+$/'</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$seoname</span><span class="keyword">); </span><span class="comment">// // Strip off the ending hyphens
<br></span><span class="default">$seoname </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$seoname</span><span class="keyword">);
<br>
<br>echo </span><span class="default">$seoname</span><span class="keyword">;
<br></span><span class="default">?&gt;
<br></span>
<br>This will print: this-is-the-string-to-be-made-seo-friendly</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122778">  
  <a class="name">
  <strong class="user"><em>bublifuk at mailinator dot com</em></strong></a><div class="date" title="2018-05-30 03:36"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122778">
<div class="phpcode"><code><span class="html">
A delimiter can be any ASCII non-alphanumeric, non-backslash, non-whitespace character:&nbsp; !"#$%&amp;'*+,./:;=?@^_`|~-&nbsp; and&nbsp; ({[&lt;&gt;]})</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84385">  
  <a class="name">
  <strong class="user"><em>David</em></strong></a><div class="date" title="2008-07-11 04:59"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom84385">
<div class="phpcode"><code><span class="html">
Take care when you try to strip whitespaces out of an UTF-8 text. Using something like:<br><br><span class="default">&lt;?php<br>$text </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">( </span><span class="string">"{\s+}"</span><span class="keyword">, </span><span class="string">' '</span><span class="keyword">, </span><span class="default">$text </span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>brokes in my case the letter à which is hex c3a0. But a0 is a whitespace. So use <br><br><span class="default">&lt;?php<br>$text </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">( </span><span class="string">"{[ \t]+}"</span><span class="keyword">, </span><span class="string">' '</span><span class="keyword">, </span><span class="default">$text </span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>to strip all spaces and tabs, or better, use a multibyte function like mb_ereg_replace.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103985">  
  <a class="name">
  <strong class="user"><em>craiga at craiga dot id dot au</em></strong></a><div class="date" title="2011-05-15 07:02"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom103985">
<div class="phpcode"><code><span class="html">
If there's a chance your replacement text contains any strings such as "$0.95", you'll need to escape those $n backreferences:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">escape_backreference</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; return </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\$(\d)/'</span><span class="keyword">, </span><span class="string">'\\\$$1'</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77317">  
  <a class="name">
  <strong class="user"><em>sternkinder at gmail dot com</em></strong></a><div class="date" title="2007-08-24 03:10"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom77317">
<div class="phpcode"><code><span class="html">
From what I can see, the problem is, that if you go straight and substitute all 'A's wit 'T's you can't tell for sure which 'T's to substitute with 'A's afterwards. This can be for instance solved by simply replacing all 'A's by another character (for instance '_' or whatever you like), then replacing all 'T's by 'A's, and then replacing all '_'s (or whatever character you chose) by 'A's:
<br>
<br><span class="default">&lt;?php
<br>$dna </span><span class="keyword">= </span><span class="string">"AGTCTGCCCTAG"</span><span class="keyword">;
<br>echo </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">"A"</span><span class="keyword">,</span><span class="string">"G"</span><span class="keyword">,</span><span class="string">"C"</span><span class="keyword">,</span><span class="string">"T"</span><span class="keyword">,</span><span class="string">"_"</span><span class="keyword">,</span><span class="string">"-"</span><span class="keyword">), array(</span><span class="string">"_"</span><span class="keyword">,</span><span class="string">"-"</span><span class="keyword">,</span><span class="string">"G"</span><span class="keyword">,</span><span class="string">"A"</span><span class="keyword">,</span><span class="string">"T"</span><span class="keyword">,</span><span class="string">"C"</span><span class="keyword">), </span><span class="default">$dna</span><span class="keyword">); </span><span class="comment">//output will be TCAGACGGGATC
<br></span><span class="default">?&gt;
<br></span>
<br>Although I don't know how transliteration in perl works (though I remember that is kind of similar to the UNIX command "tr") I would suggest following function for "switching" single chars:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">switch_chars</span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">,</span><span class="default">$switch_table</span><span class="keyword">,</span><span class="default">$unused_char</span><span class="keyword">=</span><span class="string">"_"</span><span class="keyword">) {
<br>&nbsp; &nbsp; foreach ( </span><span class="default">$switch_table </span><span class="keyword">as </span><span class="default">$_1 </span><span class="keyword">=&gt; </span><span class="default">$_2 </span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$subject </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$_1</span><span class="keyword">,</span><span class="default">$unused_char</span><span class="keyword">,</span><span class="default">$subject</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$subject </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$_2</span><span class="keyword">,</span><span class="default">$_1</span><span class="keyword">,</span><span class="default">$subject</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$subject </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$unused_char</span><span class="keyword">,</span><span class="default">$_2</span><span class="keyword">,</span><span class="default">$subject</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; return </span><span class="default">$subject</span><span class="keyword">;
<br>}
<br>
<br>echo </span><span class="default">switch_chars</span><span class="keyword">(</span><span class="string">"AGTCTGCCCTAG"</span><span class="keyword">, array(</span><span class="string">"A"</span><span class="keyword">=&gt;</span><span class="string">"T"</span><span class="keyword">,</span><span class="string">"G"</span><span class="keyword">=&gt;</span><span class="string">"C"</span><span class="keyword">)); </span><span class="comment">//output will be TCAGACGGGATC
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="106263">  
  <a class="name">
  <strong class="user"><em>akarmenia at gmail dot com</em></strong></a><div class="date" title="2011-10-22 11:47"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom106263">
<div class="phpcode"><code><span class="html">
[Editor's note: in this case it would be wise to rely on the preg_quote() function instead which was added for this specific purpose]
<br>
<br>If your replacement string has a dollar sign or a backslash. it may turn into a backreference accidentally! This will fix it.
<br>
<br>I want to replace 'text' with '$12345' but this becomes a backreference to $12 (which doesn't exist) and then it prints the remaining '34'. The function down below will return a string that escapes the backreferences.
<br>
<br>OUTPUT:
<br>string(8) "some 345"
<br>string(11) "some \12345"
<br>string(8) "some 345"
<br>string(11) "some $12345"
<br>
<br><span class="default">&lt;?php
<br>
<br>$a </span><span class="keyword">= </span><span class="string">'some text'</span><span class="keyword">;
<br>
<br></span><span class="comment">// Either of these will backreference and fail
<br></span><span class="default">$b1 </span><span class="keyword">= </span><span class="string">'\12345'</span><span class="keyword">; </span><span class="comment">// Should be '\\12345' to avoid backreference
<br></span><span class="default">$b2 </span><span class="keyword">= </span><span class="string">'$12345'</span><span class="keyword">; </span><span class="comment">// Should be '\$12345' to avoid backreference
<br>
<br></span><span class="default">$d </span><span class="keyword">= array(</span><span class="default">$b1</span><span class="keyword">, </span><span class="default">$b2</span><span class="keyword">);
<br>
<br>foreach (</span><span class="default">$d </span><span class="keyword">as </span><span class="default">$b</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$result1 </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'#(text)#'</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">, </span><span class="default">$a</span><span class="keyword">); </span><span class="comment">// Fails
<br>&nbsp; &nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$result1</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$result2 </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'#(text)#'</span><span class="keyword">, </span><span class="default">preg_escape_back</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">), </span><span class="default">$a</span><span class="keyword">); </span><span class="comment">// Succeeds
<br>&nbsp; &nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$result2</span><span class="keyword">);
<br>}
<br>
<br></span><span class="comment">// Escape backreferences from string for use with regex
<br></span><span class="keyword">function </span><span class="default">preg_escape_back</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="comment">// Replace $ with \$ and \ with \\
<br>&nbsp; &nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'#(?&lt;!\\\\)(\\$|\\\\)#'</span><span class="keyword">, </span><span class="string">'\\\\$1'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);
<br>&nbsp; &nbsp; return </span><span class="default">$string</span><span class="keyword">;
<br>}
<br>
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78597">  
  <a class="name">
  <strong class="user"><em>mike dot hayward at mikeyskona dot co dot uk</em></strong></a><div class="date" title="2007-10-18 08:49"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom78597">
<div class="phpcode"><code><span class="html">
Hi.
<br>Not sure if this will be a great help to anyone out there, but thought i'd post just in case.
<br>I was having an Issue with a project that relied on $_SERVER['REQUEST_URI']. Obviously this wasn't working on IIS.
<br>(i am using mod_rewrite in apache to call up pages from a database and IIS doesn't set REQUEST_URI). So i knocked up this simple little preg_replace to use the query string set by IIS when redirecting to a PHP error page.
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">//My little IIS hack :)
<br></span><span class="keyword">if(!isset(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REQUEST_URI'</span><span class="keyword">])){ 
<br>&nbsp; </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REQUEST_URI'</span><span class="keyword">] = </span><span class="default">preg_replace</span><span class="keyword">( </span><span class="string">'/404;([a-zA-Z]+:\/\/)(.*?)\//i'</span><span class="keyword">, </span><span class="string">"/" </span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'QUERY_STRING'</span><span class="keyword">] );
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>Hope this helps someone else out there trying to do the same thing :)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104482">  
  <a class="name">
  <strong class="user"><em>anyvie at devlibre dot fr</em></strong></a><div class="date" title="2011-06-17 02:11"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom104482">
<div class="phpcode"><code><span class="html">
A variable can handle a huge quantity of data but preg_replace can't.<br><br>Example :<br><span class="default">&lt;?php<br>$url </span><span class="keyword">= </span><span class="string">"ANY URL WITH LOTS OF DATA"</span><span class="keyword">;<br><br></span><span class="comment">// We get all the data into $data<br></span><span class="default">$data </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br><br></span><span class="comment">// We just want to keep the content of &lt;head&gt;<br></span><span class="default">$head </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"#(.*)&lt;head&gt;(.*?)&lt;/head&gt;(.*)#is"</span><span class="keyword">, </span><span class="string">'$2'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>$head can have the desired content, or be empty, depends on the length of $data.<br><br>For this application, just add :<br>$data = substr($data, 0, 4096);<br>before using preg_replace, and it will work fine.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="105122">  
  <a class="name">
  <strong class="user"><em>timitheenchanter</em></strong></a><div class="date" title="2011-07-28 01:34"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom105122">
<div class="phpcode"><code><span class="html">
If you have issues where preg_replace returns an empty string, please take a look at these two ini parameters:<br><br>pcre.backtrack_limit<br>pcre.recursion_limit<br><br>The default is set to 100K.&nbsp; If your buffer is larger than this, look to increase these two values.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82574">  
  <a class="name">
  <strong class="user"><em>Michael W</em></strong></a><div class="date" title="2008-04-16 03:35"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom82574">
<div class="phpcode"><code><span class="html">
For filename tidying I prefer to only ALLOW certain characters rather than converting particular ones that we want to exclude. To this end I use ...<br><br><span class="default">&lt;?php<br>&nbsp; $allowed </span><span class="keyword">= </span><span class="string">"/[^a-z0-9\\040\\.\\-\\_\\\\]/i"</span><span class="keyword">;<br>&nbsp; </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="default">$allowed</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">));<br></span><span class="default">?&gt;<br></span><br>Allows letters a-z, digits, space (\\040), hyphen (\\-), underscore (\\_) and backslash (\\\\), everything else is removed from the string.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="116884">  
  <a class="name">
  <strong class="user"><em>Nibbels</em></strong></a><div class="date" title="2015-03-15 02:46"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom116884">
<div class="phpcode"><code><span class="html">
I have been filtering every userinput with preg_replace since 6 Years now and nothing happened. I am running PHP 5.6.6 and because of historical reasons I still do not use mysqli.<br>Now i noticed that this filter [^0-9a-zA-Z_ -|:\.] won't filter anything from a Sleeping-Hack-String like `%' AnD sLeep(3) ANd '1%`:<br><br>preg_replace ( '/[^0-9a-zA-Z_ -|:\.]/', '', "%' AnD sLeep(3) ANd '1%" );<br><br>The reason is, that the fourth Minus has to be escaped!<br>Fix: [^0-9a-zA-Z_ \-|:\.]<br><br>I tell you because I did not know this and I am pretty sure btw. maybe in older versions of PHP some did not have to escape this minus. Those hacks did not work in the old days, because formerly I have been testing against this.<br><br>Greetings</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102589">  
  <a class="name">
  <strong class="user"><em>me at perochak dot com</em></strong></a><div class="date" title="2011-02-22 09:57"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom102589">
<div class="phpcode"><code><span class="html">
If you would like to remove a tag along with the text inside it then use the following code.
<br>
<br><span class="default">&lt;?php
<br>preg_replace</span><span class="keyword">(</span><span class="string">'/(&lt;tag&gt;.+?)+(&lt;\/tag&gt;)/i'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>example
<br><span class="default">&lt;?php $string</span><span class="keyword">=</span><span class="string">'&lt;span class="normalprice"&gt;55 PKR&lt;/span&gt;'</span><span class="keyword">; </span><span class="default">?&gt;
<br></span>
<br><span class="default">&lt;?php
<br>$string </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/(&lt;span class="normalprice"&gt;.+?)+(&lt;\/span&gt;)/i'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>This will results a null or empty string.
<br>
<br><span class="default">&lt;?php
<br>$string</span><span class="keyword">=</span><span class="string">'My String &lt;span class="normalprice"&gt;55 PKR&lt;/span&gt;'</span><span class="keyword">;
<br>
<br></span><span class="default">$string </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/(&lt;span class="normalprice"&gt;.+?)+(&lt;\/span&gt;)/i'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>This will results a " My String"</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111695">  
  <a class="name">
  <strong class="user"><em>nik at rolls dot cc</em></strong></a><div class="date" title="2013-03-17 10:14"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom111695">
<div class="phpcode"><code><span class="html">
To split Pascal/CamelCase into Title Case (for example, converting descriptive class names for use in human-readable frontends), you can use the below function:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">expandCamelCase</span><span class="keyword">(</span><span class="default">$source</span><span class="keyword">) {<br>&nbsp; return </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/(?&lt;!^)([A-Z][a-z]|(?&lt;=[a-z])[^a-z]|(?&lt;=[A-Z])[0-9_])/'</span><span class="keyword">, </span><span class="string">' $1'</span><span class="keyword">, </span><span class="default">$source</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;<br></span><br>Before:<br>&nbsp; ExpandCamelCaseAPIDescriptorPHP5_3_4Version3_21Beta<br>After:<br>&nbsp; Expand Camel Case API Descriptor PHP 5_3_4 Version 3_21 Beta</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83974">  
  <a class="name">
  <strong class="user"><em>da_pimp2004_966 at hotmail dot com</em></strong></a><div class="date" title="2008-06-20 11:09"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom83974">
<div class="phpcode"><code><span class="html">
A simple BB like thing..
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">AddBB</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$search </span><span class="keyword">= array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/\[b\](.*?)\[\/b\]/is'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/\[i\](.*?)\[\/i\]/is'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/\[u\](.*?)\[\/u\]/is'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/\[img\](.*?)\[\/img\]/is'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/\[url\](.*?)\[\/url\]/is'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/\[url\=(.*?)\](.*?)\[\/url\]/is'
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$replace </span><span class="keyword">= array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;strong&gt;$1&lt;/strong&gt;'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;em&gt;$1&lt;/em&gt;'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;u&gt;$1&lt;/u&gt;'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;img src="$1" /&gt;'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;a href="$1"&gt;$1&lt;/a&gt;'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;a href="$1"&gt;$2&lt;/a&gt;'
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$var </span><span class="keyword">= </span><span class="default">preg_replace </span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">, </span><span class="default">$replace</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$var</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85416">  
  <a class="name">
  <strong class="user"><em>dyer85 at gmail dot com</em></strong></a><div class="date" title="2008-08-28 07:41"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom85416">
<div class="phpcode"><code><span class="html">
There seems to be some unexpected behavior when using the /m modifier when the line terminators are win32 or mac format.<br><br>If you have a string like below, and try to replace dots, the regex won't replace correctly:<br><br><span class="default">&lt;?php<br>$s </span><span class="keyword">= </span><span class="string">"Testing, testing.\r\n"<br>&nbsp;&nbsp; </span><span class="keyword">. </span><span class="string">"Another testing line.\r\n"<br>&nbsp;&nbsp; </span><span class="keyword">. </span><span class="string">"Testing almost done."</span><span class="keyword">;<br><br>echo </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\.$/m'</span><span class="keyword">, </span><span class="string">'.@'</span><span class="keyword">, </span><span class="default">$s</span><span class="keyword">); </span><span class="comment">// only last . replaced<br></span><span class="default">?&gt;<br></span><br>The /m modifier doesn't seem to work properly when CRLFs or CRs are used. Make sure to convert line endings to LFs (*nix format) in your input string.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="81486">  
  <a class="name">
  <strong class="user"><em>php-comments-REMOVE dot ME at dotancohen dot com</em></strong></a><div class="date" title="2008-02-29 12:02"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom81486">
<div class="phpcode"><code><span class="html">
Below is a function for converting Hebrew final characters to their<br>normal equivelants should they appear in the middle of a word.<br>The /b argument does not treat Hebrew letters as part of a word,<br>so I had to work around that limitation.<br><br><span class="default">&lt;?php<br><br>$text</span><span class="keyword">=</span><span class="string">"עברית מבולגנת"</span><span class="keyword">;<br><br>function </span><span class="default">hebrewNotWordEndSwitch </span><span class="keyword">(</span><span class="default">$from</span><span class="keyword">, </span><span class="default">$to</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">) {<br>&nbsp;&nbsp; </span><span class="default">$text</span><span class="keyword">=<br>&nbsp; &nbsp; </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$from</span><span class="keyword">.</span><span class="string">'([א-ת])/u'</span><span class="keyword">,</span><span class="string">'$2'</span><span class="keyword">.</span><span class="default">$to</span><span class="keyword">.</span><span class="string">'$1'</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">);<br>&nbsp;&nbsp; return </span><span class="default">$text</span><span class="keyword">;<br>}<br><br>do {<br>&nbsp;&nbsp; </span><span class="default">$text_before</span><span class="keyword">=</span><span class="default">$text</span><span class="keyword">;<br>&nbsp;&nbsp; </span><span class="default">$text</span><span class="keyword">=</span><span class="default">hebrewNotWordEndSwitch</span><span class="keyword">(</span><span class="string">"ך"</span><span class="keyword">,</span><span class="string">"כ"</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">);<br>&nbsp;&nbsp; </span><span class="default">$text</span><span class="keyword">=</span><span class="default">hebrewNotWordEndSwitch</span><span class="keyword">(</span><span class="string">"ם"</span><span class="keyword">,</span><span class="string">"מ"</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">);<br>&nbsp;&nbsp; </span><span class="default">$text</span><span class="keyword">=</span><span class="default">hebrewNotWordEndSwitch</span><span class="keyword">(</span><span class="string">"ן"</span><span class="keyword">,</span><span class="string">"נ"</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">);<br>&nbsp;&nbsp; </span><span class="default">$text</span><span class="keyword">=</span><span class="default">hebrewNotWordEndSwitch</span><span class="keyword">(</span><span class="string">"ף"</span><span class="keyword">,</span><span class="string">"פ"</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">);<br>&nbsp;&nbsp; </span><span class="default">$text</span><span class="keyword">=</span><span class="default">hebrewNotWordEndSwitch</span><span class="keyword">(</span><span class="string">"ץ"</span><span class="keyword">,</span><span class="string">"צ"</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">);<br>}&nbsp;&nbsp; while ( </span><span class="default">$text_before</span><span class="keyword">!=</span><span class="default">$text </span><span class="keyword">);<br><br>print </span><span class="default">$text</span><span class="keyword">; </span><span class="comment">// עברית מסודרת!<br><br></span><span class="default">?&gt;<br></span><br>The do-while is necessary for multiple instances of letters, such<br>as "אנני" which would start off as "אןןי". Note that there's still the<br>problem of acronyms with gershiim but that's not a difficult one<br>to solve. The code is in use at <a rel="nofollow" target="_blank">http://gibberish.co.il</a> which you can<br>use to translate wrongly-encoded Hebrew, transliterize, and some<br>other Hebrew-related functions.<br><br>To ensure that there will be no regular characters at the end of a<br>word, just convert all regular characters to their final forms, then<br>run this function. Enjoy!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="124771">  
  <a class="name">
  <strong class="user"><em>Ducktales</em></strong></a><div class="date" title="2020-02-27 05:27"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom124771">
<div class="phpcode"><code><span class="html">
To replace double whitespace by a single space character in a sentence you need to use the \h modifier. It stands for horizontal whitespace. The more common \s modifier includes vertical whitespace such as line breaks, which is not good for saving paragraphs.<br><br>Additionally, since most of todays code works with unicode strings you need to add the /u unicode modifier. I tried to replace four sequential normal spaces by one hyphen character resulting in '- - ' instead of '-'. I don't know why it works this way.<br><br><span class="default">&lt;?php<br></span><span class="comment">// Replace one or more horizontal white spaces<br>// of any kind by one normal space character<br></span><span class="default">$str </span><span class="keyword">= </span><span class="default">preg_replace </span><span class="keyword">(</span><span class="string">'/\h+/u'</span><span class="keyword">, </span><span class="string">' '</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="125026">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2020-05-19 06:28"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom125026">
<div class="phpcode"><code><span class="html">
Note that the replacement string using the ${n} notation for a group identifier (rather than the $n notation) must be in a SINGLE quoted string: <br><br> $replacement = '${1}1,$3'; // Correct - Single Quoted<br> $replacement = "${1}1,$3"; // Incorrect - Double Quoted<br> $replacement = "$1 one , $3"; // Correct - Double Quoted but with $n notation.<br><br>This might sneak up on you, because it is not an error to use "${1}".&nbsp; The double quotes allow a string that contains variable interpolation, and the braces make the variable a PHP "Variable-Variable". In the above example the undefined ${1} will evaluate to NULL rather than the replaced string. Valid PHP, but not what you wanted.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="124391">  
  <a class="name">
  <strong class="user"><em>mail at johanvandemerwe dot nl</em></strong></a><div class="date" title="2019-11-13 12:41"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom124391">
<div class="phpcode"><code><span class="html">
Sample for replacing bracketed short-codes<br><br>The used short-codes are purely used for educational purposes for they could be shorter as in 'italic' to 'i' or 'bold' to 'b'.<br><br>Sample text<br>----<br>This sample shows how to have [italic]italic[/italic], [bold]bold[/bold] and [underline]underlined[/underline] and [strikethrough]striked[/striketrhough] text. <br><br>with this function:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">textDecoration</span><span class="keyword">(</span><span class="default">$html</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$patterns </span><span class="keyword">= [<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/\[(italic)\].*?\[\/\1\] ?/'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/\[(bold)\].*?\[\/\1\] ?/'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/\[(underline)\].*?\[\/\1\] ?/'<br>&nbsp; &nbsp; </span><span class="keyword">];<br><br>&nbsp; &nbsp; </span><span class="default">$replacements </span><span class="keyword">= [<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;i&gt;$1&lt;/i&gt;'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;strong&gt;$1&lt;/strong&gt;'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;u&gt;$1&lt;/u&gt;'<br>&nbsp; &nbsp; </span><span class="keyword">];<br><br>&nbsp; &nbsp; return </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="default">$patterns</span><span class="keyword">, </span><span class="default">$replacements</span><span class="keyword">, </span><span class="default">$html</span><span class="keyword">);<br>}<br><br></span><span class="default">$html </span><span class="keyword">= </span><span class="default">textDecoration</span><span class="keyword">(</span><span class="default">$html</span><span class="keyword">);<br><br>echo </span><span class="default">$html</span><span class="keyword">; </span><span class="comment">// or return<br></span><span class="default">?&gt;<br></span><br>results in:<br>----<br>This sample shows how to have &lt;i&gt;italic&lt;/i&gt;, &lt;b&gt;bold&lt;/b&gt; and &lt;u&gt;underlined&lt;/u&gt; and [strikethrough]striked[/striketrhough] text.<br><br>Notice!<br>There is no [strikethrough]striked[/striketrhough] fallback in the patterns and replacements array</span>
</code></div>
  </div>
 </div>
  <div class="note" id="123144">  
  <a class="name">
  <strong class="user"><em>willbrownsberger at gmail dot com</em></strong></a><div class="date" title="2018-09-20 06:27"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom123144">
<div class="phpcode"><code><span class="html">
Worth knowing:&nbsp; When arrays of patterns and replacements are provided, they are executed in the order they appear in the array -- so later array elements can act on the results of earlier array elements.<br><br>For example:<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">echo </span><span class="default">preg_replace</span><span class="keyword">(<br>&nbsp; &nbsp; array( </span><span class="string">'#cat#'</span><span class="keyword">, </span><span class="string">'#dog#'</span><span class="keyword">, </span><span class="string">'#eel#'</span><span class="keyword">, </span><span class="string">'#snowman#' </span><span class="keyword">),<br>&nbsp; &nbsp; array(&nbsp; </span><span class="string">'dog1'</span><span class="keyword">, </span><span class="string">'eel2'</span><span class="keyword">, </span><span class="string">'snowman3'</span><span class="keyword">, </span><span class="string">'monster4' </span><span class="keyword">),<br>&nbsp; &nbsp; </span><span class="string">'the good cat and the bad dog wandered on the beach'<br><br></span><span class="keyword">);<br><br></span><span class="comment">/* result: the good monster4321 and the bad monster432 wandered on the beach<br>*/</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="123044">  
  <a class="name">
  <strong class="user"><em>chrisbloom7 at gmail dot com</em></strong></a><div class="date" title="2018-08-16 08:01"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom123044">
<div class="phpcode"><code><span class="html">
Note that when given array arguments the replacement happens in sequence:<br><br><span class="default">&lt;?php<br>$p </span><span class="keyword">= array(</span><span class="string">'/a/'</span><span class="keyword">, </span><span class="string">'/b/'</span><span class="keyword">, </span><span class="string">'/c/'</span><span class="keyword">);<br></span><span class="default">$r </span><span class="keyword">= array(</span><span class="string">'b'</span><span class="keyword">, </span><span class="string">'c'</span><span class="keyword">, </span><span class="string">'d'</span><span class="keyword">);<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="default">$p</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">));<br></span><span class="comment">// =&gt; d<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122374">  
  <a class="name">
  <strong class="user"><em>creating SEO friendly Strings</em></strong></a><div class="date" title="2018-02-09 01:47"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122374">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php<br><br></span><span class="comment">/**<br>&nbsp; * prepares a string optimized for SEO<br>&nbsp; * @see <a rel="nofollow" target="_blank">https://blog.ueffing.net/post/2016/03/14/string-seo-optimieren-creating-seo-friendly-url/</a><br>&nbsp; * @param String $string <br>&nbsp; * @return String $string SEO optimized String<br>&nbsp; */<br></span><span class="keyword">function </span><span class="default">seofy </span><span class="keyword">(</span><span class="default">$sString </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$sString </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/[^\\pL\d_]+/u'</span><span class="keyword">, </span><span class="string">'-'</span><span class="keyword">, </span><span class="default">$sString</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$sString </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$sString</span><span class="keyword">, </span><span class="string">"-"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$sString </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'utf-8'</span><span class="keyword">, </span><span class="string">"us-ascii//TRANSLIT"</span><span class="keyword">, </span><span class="default">$sString</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$sString </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$sString</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$sString </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/[^-a-z0-9_]+/'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$sString</span><span class="keyword">);<br><br>&nbsp; &nbsp; return </span><span class="default">$sString</span><span class="keyword">;<br>}<br><br></span><span class="comment">// Example<br></span><span class="default">seofy</span><span class="keyword">(</span><span class="string">'Straßenfest in München'</span><span class="keyword">); </span><span class="comment">// =&gt; strassenfest-in-muenchen<br></span><span class="default">seofy</span><span class="keyword">(</span><span class="string">'José Ignacio López de Arriortúa'</span><span class="keyword">); </span><span class="comment">// =&gt; jose-ignacio-lopez-de-arriortua<br><br></span><span class="default">?&gt;<br></span><br>The function seofy () creates a SEO friendly version from a string. Umlauts and other letters not contained in the ASCII character set are either reduced to the basic form equivalent (e. g.: é becomes e and ú wid u) or completely converted (e. g. ß becomes ss and ü becomes ue).<br><br>On the one hand this succeeds because the php function preg_replace performs the replacement by means of unicode - Unicode Regular Expressions - and on the other hand because an approximate translation is attempted by means of the php function iconv with the TRANSLIT option.<br><br>Quote php. net about iconv and TRANSLIT:<br>"If you append the character string //TRANSLIT to out_charset, transliteration is activated. This means that a character that cannot be displayed in the target character set can be approximated with one or more similar-looking characters.[…]"<br><br>Source:<br><a rel="nofollow" target="_blank">https://blog.ueffing.net/post/2016/03/14/string-seo-optimieren-creating-seo-friendly-url/</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="121749">  
  <a class="name">
  <strong class="user"><em>natan dot jesussouza at gmail dot com</em></strong></a><div class="date" title="2017-10-11 09:22"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom121749">
<div class="phpcode"><code><span class="html">
$firstname = htmlspecialchars($_POST['campo']);<br>$firstname = preg_replace("/[^a-zA-Z0-9]/", "", $firstname, -1, $count_fn);<br><br>// $count_fn conta quantos caracteres foram mudados.<br>// $firstname variavel que captura o input</span>
</code></div>
  </div>
 </div>
  <div class="note" id="118285">  
  <a class="name">
  <strong class="user"><em>helia at gmail dot com</em></strong></a><div class="date" title="2015-11-08 11:36"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom118285">
<div class="phpcode"><code><span class="html">
$pattern='/(09(1|2|3)\d{8})/';<br>$string ="n:09138660959 nu: 09371313317 nu:09211313317 n: 09393026988nu:09193472840nnu:09211313317nu:09211313317nu:09121772890";<br>$replacements='($1 code $2)';<br>echo&nbsp; preg_replace($pattern, $replacements, $string);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="116631">  
  <a class="name">
  <strong class="user"><em>Jeroen</em></strong></a><div class="date" title="2015-02-01 01:25"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom116631">
<div class="phpcode"><code><span class="html">
Hello there, <br>I would like to share a regex (PHP) sniplet of code <br>I wrote (2012) for myself it is also being used in the <br>Yerico sriptmerge plugin for joomla marked as simple code.. <br>To&nbsp; compress javascript code and remove all comments from it. <br>It also works with mootools It is fast... <br>(in compairison to other PHP solutions) and does not damage the <br>Javascript it self and it resolves lots of comment removal isseus.<br><br>//START Remove comments.<br><br>&nbsp;&nbsp; $buffer = str_replace('/// ', '///', $buffer);&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp;&nbsp; $buffer = str_replace(',//', ', //', $buffer);<br>&nbsp;&nbsp; $buffer = str_replace('{//', '{ //', $buffer);<br>&nbsp;&nbsp; $buffer = str_replace('}//', '} //', $buffer);<br>&nbsp;&nbsp; $buffer = str_replace('*//*', '*/&nbsp; /*', $buffer);<br>&nbsp;&nbsp; $buffer = str_replace('/**/', '/*&nbsp; */', $buffer);<br>&nbsp;&nbsp; $buffer = str_replace('*///', '*/ //', $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace("/\/\/.*\n\/\/.*\n/", "", $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace("/\s\/\/\".*/", "", $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace("/\/\/\n/", "\n", $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace("/\/\/\s.*.\n/", "\n&nbsp; \n", $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace('/\/\/w[^w].*/', '', $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace('/\/\/s[^s].*/', '', $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace('/\/\/\*\*\*.*/', '', $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace('/\/\/\*\s\*\s\*.*/', '', $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace('/[^\*]\/\/[*].*/', '', $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace('/([;])\/\/.*/', '$1', $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace('/((\r)|(\n)|(\R)|([^0]1)|([^\"]\s*\-))(\/\/)(.*)/', '$1', $buffer);<br>&nbsp;&nbsp; $buffer = preg_replace("/([^\*])[\/]+\/\*.*[^a-zA-Z0-9\s\-=+\|!@#$%^&amp;()`~\[\]{};:\'\",&lt;.&gt;?]/", "$1", $buffer);<br>&nbsp; $buffer = preg_replace("/\/\*/", "\n/*dddpp", $buffer);<br>&nbsp; $buffer = preg_replace('/((\{\s*|:\s*)[\"\']\s*)(([^\{\};\"\']*)dddpp)/','$1$4', $buffer);<br>&nbsp; $buffer = preg_replace("/\*\//", "xxxpp*/\n", $buffer);<br>&nbsp; $buffer = preg_replace('/((\{\s*|:\s*|\[\s*)[\"\']\s*)(([^\};\"\']*)xxxpp)/','$1$4', $buffer);<br>&nbsp; $buffer = preg_replace('/([\"\'])\s*\/\*/', '$1/*', $buffer);<br>&nbsp; $buffer = preg_replace('/(\n)[^\'"]?\/\*dddpp.*?xxxpp\*\//s', '', $buffer);<br>&nbsp; $buffer = preg_replace('/\n\/\*dddpp([^\s]*)/', '$1', $buffer);<br>&nbsp; $buffer = preg_replace('/xxxpp\*\/\n([^\s]*)/', '*/$1', $buffer);<br>&nbsp; $buffer = preg_replace('/xxxpp\*\/\n([\"])/', '$1', $buffer);<br>&nbsp; $buffer = preg_replace('/(\*)\n*\s*(\/\*)\s*/', '$1$2$3', $buffer);<br>&nbsp; $buffer = preg_replace('/(\*\/)\s*(\")/', '$1$2', $buffer);<br>&nbsp; $buffer = preg_replace('/\/\*dddpp(\s*)/', '/*', $buffer);<br>&nbsp; $buffer = preg_replace('/\n\s*\n/', "\n", $buffer);<br>&nbsp; $buffer = preg_replace("/([^\'\"]\s*)&lt;!--.*--&gt;(?!(&lt;\/div&gt;)).*/","$1", $buffer);<br>&nbsp; $buffer = preg_replace('/([^\n\w\-=+\|!@#$%^&amp;*()`~\[\]{};:\'",&lt;.&gt;\/?\\\\])(\/\/)(.*)/', '$1', $buffer);<br><br>//END Remove comments.&nbsp; &nbsp; <br><br>//START Remove all whitespaces<br><br>&nbsp; $buffer = preg_replace('/\s+/', ' ', $buffer);<br>&nbsp; $buffer = preg_replace('/\s*(?:(?=[=\-\+\|%&amp;\*\)\[\]\{\};:\,\.\&lt;\&gt;\!\@\#\^`~]))/', '', $buffer);<br>&nbsp; $buffer = preg_replace('/(?:(?&lt;=[=\-\+\|%&amp;\*\)\[\]\{\};:\,\.\&lt;\&gt;\?\!\@\#\^`~]))\s*/', '', $buffer);<br>&nbsp; $buffer = preg_replace('/([^a-zA-Z0-9\s\-=+\|!@#$%^&amp;*()`~\[\]<br>{};:\'",&lt;.&gt;\/?])\s+([^a-zA-Z0-9\s\-=+\|!@#$%^&amp;*()`~\[\]<br>{};:\'",&lt;.&gt;\/?])/', '$1$2', $buffer);<br><br>//END Remove all whitespaces<br><br>I am off coarse not a programmer just wanted to <br>make the plugin work like i wanted it to.... <br>(NOTE: <br>For the webmaster sorry I posted this in the wrong topic before...)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112203">  
  <a class="name">
  <strong class="user"><em>Dustin</em></strong></a><div class="date" title="2013-05-16 11:53"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom112203">
<div class="phpcode"><code><span class="html">
Matching substrings where the match can exist at the end of the string was non-intuitive to me.<br><br>I found this because:<br>strtotime() interprets 'mon' as 'Monday', but Postgres uses interval types that return short names by default, e.g. interval '1 month' returns as '1 mon'.<br><br>I used something like this:<br><br>$str = "mon month monday Mon Monday Month MONTH MON";<br>$strMonth = preg_replace('~(mon)([^\w]|$)~i', '$1th$2', $str);<br>echo "$str\n$strMonth\n";<br><br>//to output:<br>mon month monday Mon Monday Month MONTH MON<br>month month monday Month Monday Month MONTH MONth</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104965">  
  <a class="name">
  <strong class="user"><em>sreekanth at outsource-online dot net</em></strong></a><div class="date" title="2011-07-19 01:29"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom104965">
<div class="phpcode"><code><span class="html">
if your intention to code and decode mod_rewrite urls and handle it with php and mysql ,this should work<br><br>to convert to url<br>$url = preg_replace('/[^A-Za-z0-9_-]+/', '-', $string);<br><br>And to check in mysql with the url value,use the same expression discounting '-'.<br>first replace the url value&nbsp; with php using preg_replace&nbsp; and use with mysql REGEXP<br><br>$sql = "select * from table where fieldname_to_check REGEXP '".preg_replace("/-+/",'[^A-Za-z0-9_]+',$url)."'"</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104318">  
  <a class="name">
  <strong class="user"><em>someuser at dot dot com</em></strong></a><div class="date" title="2011-06-08 04:10"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom104318">
<div class="phpcode"><code><span class="html">
Replacement of line numbers, with replacement limit per line.<br><br>Solution that worked for me.<br>I have a file with tasks listed each starting from number, and only starting number should be removed because forth going text has piles of numbers to be omitted.<br><br>56 Patient A of 46 years suffering ... ...<br>57 Newborn of 26 weeks was ...<br>58 Jane, having age 18 years recollects onsets of ...<br>...<br>587 Patient of 70 years ...<br><br>etc.<br><br><span class="default">&lt;?php<br></span><span class="comment">// Array obtained from file&nbsp; &nbsp; <br></span><span class="default">$array </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br><br></span><span class="comment">// Decompile array with foreach loop<br></span><span class="keyword">foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="comment">//&nbsp; &nbsp; Take away numbers 100-999<br>&nbsp; &nbsp; //&nbsp; &nbsp; Starting from biggest <br>&nbsp; &nbsp; //<br>&nbsp; &nbsp; //&nbsp; &nbsp; %&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Delimiter<br>&nbsp; &nbsp; //&nbsp; &nbsp; ^&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Make match from beginning of line<br>&nbsp; &nbsp; //&nbsp; &nbsp; [0-9]&nbsp; &nbsp; &nbsp; &nbsp; Range of numbers<br>&nbsp; &nbsp; //&nbsp; &nbsp; {3}&nbsp; &nbsp; &nbsp; &nbsp; Multiplication of digit range (For tree digit numbers)<br>&nbsp; &nbsp; //<br>&nbsp; &nbsp; </span><span class="keyword">if(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'%^[0-9]{3}%'</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">)) <br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Re-assing to value its modified copy<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'%^[0-9]{3}%'</span><span class="keyword">, </span><span class="string">'-HERE WAS XXX NUMBER-'</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">// Take away numbers 10-99<br>&nbsp; &nbsp; </span><span class="keyword">elseif(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'%^[0-9]{2}%'</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'%^[0-9]{2}%'</span><span class="keyword">, </span><span class="string">'-HERE WAS XX NUMBER-'</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">// Take away numbers 0-9<br>&nbsp; &nbsp; </span><span class="keyword">elseif(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'%^[0-9]%'</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'%^[0-9]%'</span><span class="keyword">, </span><span class="string">'-HERE WAS X NUMBER-'</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">// Build array back<br>&nbsp; &nbsp; </span><span class="default">$arr</span><span class="keyword">[] = array(</span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87058">  
  <a class="name">
  <strong class="user"><em>7r6ivyeo at mail dot com</em></strong></a><div class="date" title="2008-11-17 09:25"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom87058">
<div class="phpcode"><code><span class="html">
String to filename:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">string_to_filename</span><span class="keyword">(</span><span class="default">$word</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/^\W+|\W+$/'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$word</span><span class="keyword">); </span><span class="comment">// remove all non-alphanumeric chars at begin &amp; end of string<br>&nbsp; &nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\s+/'</span><span class="keyword">, </span><span class="string">'_'</span><span class="keyword">, </span><span class="default">$tmp</span><span class="keyword">); </span><span class="comment">// compress internal whitespace and replace with _<br>&nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\W-/'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$tmp</span><span class="keyword">)); </span><span class="comment">// remove all non-alphanumeric chars except _ and -<br></span><span class="keyword">}<br></span><span class="default">?&gt;<br></span><br>Returns a usable &amp; readable filename.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="74037">  
  <a class="name">
  <strong class="user"><em>ismith at nojunk dot motorola dot com</em></strong></a><div class="date" title="2007-03-21 09:47"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom74037">
<div class="phpcode"><code><span class="html">
Be aware that when using the "/u" modifier, if your input text contains any bad UTF-8 code sequences, then preg_replace will return an empty string, regardless of whether there were any matches.<br><br>This is due to the PCRE library returning an error code if the string contains bad UTF-8.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="39713">  
  <a class="name">
  <strong class="user"><em>steven -a-t- acko dot net</em></strong></a><div class="date" title="2004-02-08 09:45"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom39713">
<div class="phpcode"><code><span class="html">
People using the /e modifier with preg_replace should be aware of the following weird behaviour. It is not a bug per se, but can cause bugs if you don't know it's there.<br><br>The example in the docs for /e suffers from this mistake in fact.<br><br>With /e, the replacement string is a PHP expression. So when you use a backreference in the replacement expression, you need to put the backreference inside quotes, or otherwise it would be interpreted as PHP code. Like the example from the manual for preg_replace:<br><br>preg_replace("/(&lt;\/?)(\w+)([^&gt;]*&gt;)/e",<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "'\\1'.strtoupper('\\2').'\\3'",<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $html_body);<br><br>To make this easier, the data in a backreference with /e is run through addslashes() before being inserted in your replacement expression. So if you have the string<br><br> He said: "You're here"<br><br>It would become:<br><br> He said: \"You\'re here\"<br><br>...and be inserted into the expression.<br>However, if you put this inside a set of single quotes, PHP will not strip away all the slashes correctly! Try this:<br><br> print ' He said: \"You\'re here\" ';<br> Output: He said: \"You're here\"<br><br>This is because the sequence \" inside single quotes is not recognized as anything special, and it is output literally.<br><br>Using double-quotes to surround the string/backreference will not help either, because inside double-quotes, the sequence \' is not recognized and also output literally. And in fact, if you have any dollar signs in your data, they would be interpreted as PHP variables. So double-quotes are not an option.<br><br>The 'solution' is to manually fix it in your expression. It is easiest to use a separate processing function, and do the replacing there (i.e. use "my_processing_function('\\1')" or something similar as replacement expression, and do the fixing in that function).<br><br>If you surrounded your backreference by single-quotes, the double-quotes are corrupt:<br>$text = str_replace('\"', '"', $text);<br><br>People using preg_replace with /e should at least be aware of this.<br><br>I'm not sure how it would be best fixed in preg_replace. Because double-quotes are a really bad idea anyway (due to the variable expansion), I would suggest that preg_replace's auto-escaping is modified to suit the placement of backreferences inside single-quotes (which seemed to be the intention from the start, but was incorrectly applied).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87102">  
  <a class="name">
  <strong class="user"><em>jette at nerdgirl dot dk</em></strong></a><div class="date" title="2008-11-19 04:47"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom87102">
<div class="phpcode"><code><span class="html">
I use this to prevent users from overdoing repeated text. The following function only allows 3 identical characters at a time and also takes care of repetitions with whitespace added.<br><br>This means that 'haaaaaaleluuuujaaaaa' becomes 'haaaleluuujaaa' and 'I am c o o o o o o l' becomes 'I am c o o o l'<br><br><span class="default">&lt;?php<br></span><span class="comment">//Example of user input<br></span><span class="default">$str </span><span class="keyword">= </span><span class="string">"aaaaaaaaaaabbccccccccaaaaad d d d&nbsp;&nbsp; d&nbsp; &nbsp; &nbsp; d d ddde''''''''''''"</span><span class="keyword">;<br><br>function </span><span class="default">stripRepeat</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br>&nbsp; </span><span class="comment">//Do not allow repeated whitespace<br>&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/(\s){2,}/"</span><span class="keyword">,</span><span class="string">'$1'</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);<br>&nbsp; </span><span class="comment">//Result: aaaaaaaaaaabbccccccccaaaaad d d d d d d ddde''''''''''''<br><br>&nbsp; //Do not allow more than 3 identical characters separated by any whitespace <br>&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'{( ?.)\1{4,}}'</span><span class="keyword">,</span><span class="string">'$1$1$1'</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);<br>&nbsp; </span><span class="comment">//Final result: aaabbcccaaad d d ddde'''<br><br>&nbsp; </span><span class="keyword">return </span><span class="default">$str</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;<br></span><br>To prevent any repetitions of characters, you only need this:<br><br><span class="default">&lt;?php<br>$str </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'{(.)\1+}'</span><span class="keyword">,</span><span class="string">'$1'</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);<br></span><span class="comment">//Result: abcad d d d d d d de'<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122458">  
  <a class="name">
  <strong class="user"><em>alves dot david at outlook dot com</em></strong></a><div class="date" title="2018-02-28 12:40"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122458">
<div class="phpcode"><code><span class="html">
// Function to format Brazilian taxvat using preg_replace<br>// Função para formatar o CPF ou CPF utilizando preg_replace<br>if (!function_exists('cpf_cnpj')) {<br>&nbsp; &nbsp; function cpf_cnpj($cpf_cnpj)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; if (!in_array(strlen($cpf_cnpj), [11, 14])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $cpf_cnpj;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br><br>&nbsp; &nbsp; &nbsp; &nbsp; if (strlen($cpf_cnpj) == 11) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return preg_replace("/(\d{3})(\d{3})(\d{3})(\d{2})/", "$1.$2.$3-$4", $cpf_cnpj);<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return preg_replace("/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/", "$1.$2.$3/$4-$5", $cpf_cnpj);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>}<br><br>echo cpf_cnpj(12345678901), ' - ', cpf_cnpj(12345678000190);<br><br>// 123.456.789-01 - 12.345.678/0001-90</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.preg-replace.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 09:37:52 GMT -->

</body></html>